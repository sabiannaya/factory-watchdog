import{d as G,r as u,e as N,J as l,c as d,k as v,u as _,l as U,m as M,a as r,q as B,H as f,I as S,o as p,F as b,h as k,t as w,L as q}from"./app-ue20rSb4.js";import{_ as I}from"./AppLayout.vue_vue_type_script_setup_true_lang-C_szTgFs.js";import{_ as j}from"./DataTable.vue_vue_type_script_setup_true_lang-UsrF_l4e.js";import{F as A}from"./file-down-B6gKHvru.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C7b_Quob.js";import"./index-Cl--hQqE.js";import"./VisuallyHidden-DjuZqZTT.js";import"./useForwardExpose-BCEiolqJ.js";import"./useForwardPropsEmits-BgPdB8_u.js";import"./index-C4J_hXM0.js";import"./createLucideIcon-COama0qN.js";import"./Input.vue_vue_type_script_setup_true_lang-DnYWP9Is.js";import"./Spinner.vue_vue_type_script_setup_true_lang-CDXeXNMx.js";import"./search-CIEtGgaw.js";const H={class:"p-4 space-y-4"},z={class:"flex items-center justify-between"},J={class:"flex items-center gap-3 mb-3 flex-wrap"},O={class:"flex items-center gap-2"},R=["disabled"],K=["disabled"],Q=["value"],W={class:"flex items-center gap-2"},X=["disabled"],Y=["disabled"],Z=["value"],ee=["disabled"],te={class:"mt-4 flex items-center justify-end gap-2"},ae=["disabled"],oe=["disabled"],be=G({__name:"GroupLogs",props:{logs:{},meta:{}},setup(F){const L=[{title:"Logs",href:"/logs"},{title:"Group Logs",href:"/logs/group"}],t=F,s=u(!1),n=u(t.meta?.date_from?.split(" ")[0]??""),m=u(t.meta?.date_from?parseInt(t.meta.date_from.split(" ")[1]?.split(":")[0]||"0"):0),i=u(t.meta?.date_to?.split(" ")[0]??""),c=u(t.meta?.date_to?parseInt(t.meta.date_to.split(" ")[1]?.split(":")[0]||"23"):23),V=N(()=>t.logs?.data??[]),x=Array.from({length:24},(a,e)=>({value:e,label:`${e.toString().padStart(2,"0")}:00`})),$=a=>{const e=t.meta?.per_page??20,o=t.meta?.sort??"recorded_hour",g=t.meta?.direction??"desc";l.get(window.location.pathname,{q:a,per_page:e,sort:o,direction:g,date_from:t.meta?.date_from??null,date_to:t.meta?.date_to??null},{preserveState:!0,replace:!0})},P=({sort:a,direction:e})=>{const o=t.meta?.per_page??20,g=t.meta?.q??"";a&&l.get(window.location.pathname,{sort:a,direction:e??"desc",per_page:o,q:g,date_from:t.meta?.date_from??null,date_to:t.meta?.date_to??null},{preserveState:!0,replace:!0})},y=(a,e)=>a?`${a} ${e.toString().padStart(2,"0")}:00:00`:null,h=(a,e)=>a?`${a} ${e.toString().padStart(2,"0")}:59:59`:null,T=()=>{const a=t.meta?.per_page??20,e=t.meta?.sort??"recorded_hour",o=t.meta?.direction??"desc";l.get(window.location.pathname,{date_from:y(n.value||null,m.value),date_to:h(i.value||null,c.value),q:t.meta?.q??"",sort:e,direction:o,per_page:a},{preserveState:!0,replace:!0})},C=()=>{const a=t.logs?.next_page;a&&l.visit(a,{preserveState:!0,replace:!0})},D=()=>{const a=t.logs?.prev_page;a&&l.visit(a,{preserveState:!0,replace:!0})},E=()=>{const a=new URLSearchParams;n.value&&a.append("date_from",y(n.value,m.value)||""),i.value&&a.append("date_to",h(i.value,c.value)||""),t.meta?.q&&a.append("q",t.meta.q),window.location.href=`/logs/group/export?${a.toString()}`};return l.on("start",()=>s.value=!0),l.on("finish",()=>s.value=!1),(a,e)=>(p(),d(b,null,[v(_(U),{title:"Group Logs"}),v(I,{breadcrumbs:L},{default:M(()=>[r("div",H,[r("div",z,[e[5]||(e[5]=r("div",null,[r("h2",{class:"text-2xl font-semibold"},"Group Logs (hourly)"),r("p",{class:"text-sm text-muted-foreground"},"Sums per machine group per hour")],-1)),r("button",{onClick:E,class:"btn-secondary flex items-center gap-2"},[v(_(A),{class:"size-4"}),e[4]||(e[4]=B(" Export to Excel ",-1))])]),r("div",J,[r("div",O,[e[6]||(e[6]=r("label",{class:"text-sm font-medium"},"From",-1)),f(r("input",{type:"date",class:"input","onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),disabled:s.value},null,8,R),[[S,n.value]]),f(r("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>m.value=o),class:"input",disabled:s.value},[(p(!0),d(b,null,k(_(x),o=>(p(),d("option",{key:o.value,value:o.value},w(o.label),9,Q))),128))],8,K),[[q,m.value,void 0,{number:!0}]])]),r("div",W,[e[7]||(e[7]=r("label",{class:"text-sm font-medium"},"To",-1)),f(r("input",{type:"date",class:"input","onUpdate:modelValue":e[2]||(e[2]=o=>i.value=o),disabled:s.value},null,8,X),[[S,i.value]]),f(r("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>c.value=o),class:"input",disabled:s.value},[(p(!0),d(b,null,k(_(x),o=>(p(),d("option",{key:o.value,value:o.value},w(o.label),9,Z))),128))],8,Y),[[q,c.value,void 0,{number:!0}]])]),r("button",{class:"btn",onClick:T,disabled:s.value},"Apply",8,ee)]),v(j,{serverMode:"",data:V.value,columns:[{key:"recorded_hour",label:"Hour",type:"string",sortable:!0,findable:!1},{key:"production_name",label:"Production",type:"string",sortable:!0,findable:!0},{key:"machine_group_name",label:"Machine Group",type:"string",sortable:!0,findable:!0},{key:"total_target",label:"Target",type:"number",sortable:!0,findable:!1},{key:"total_output",label:"Output",type:"number",sortable:!0,findable:!1},{key:"variance",label:"Variance",type:"number",sortable:!1,findable:!1}],"per-page":20,"initial-sort":t.meta?.sort??"recorded_hour","initial-direction":t.meta?.direction??"desc",loading:s.value,onServerSearch:$,onServerSort:P},null,8,["data","initial-sort","initial-direction","loading"]),r("div",te,[r("button",{class:"btn",disabled:!t.logs?.prev_page||s.value,onClick:D},"Previous",8,ae),r("button",{class:"btn",disabled:!t.logs?.next_page||s.value,onClick:C},"Next",8,oe)])])]),_:1})],64))}});export{be as default};
