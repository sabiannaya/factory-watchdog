import{d as H,v as I,g as w,f as U,x as J,c as n,m as l,u as s,p as K,w as i,a as t,q as d,y as Q,b as c,n as f,o as a,t as m,e as _,F as k,i as V,z as P,A,B as R}from"./app-BRuhaguS.js";import{S as X,a as Y,b as Z,c as ee,d as B,U as se,W as F,_ as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-BSta2Xg1.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-Bolxw2JV.js";import{_ as g}from"./Label.vue_vue_type_script_setup_true_lang-CGBAfwum.js";import{_ as oe,a as re,b as le,c as ae,d as ne,e as de,f as ie}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BijpPN58.js";import{_ as ue}from"./ToastNotifications.vue_vue_type_script_setup_true_lang-DCB_gM99.js";import{u as me}from"./useToast-Cyrz-AlH.js";import{U as ce}from"./user-plus-CDN_3BmN.js";import{E as W}from"./eye-off-CtRFKzTR.js";import{E as D}from"./eye-DwXBrb9R.js";import{C as pe}from"./chevron-down-Bi0ueEnd.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DrUmFdxY.js";import"./Presence-CRPloLVK.js";import"./createLucideIcon-Bc86gjbu.js";import"./useForwardPropsEmits-CxMGla6T.js";import"./x-Dz_x2_zF.js";import"./VisuallyHidden-gDrgz296.js";import"./index-C4J_hXM0.js";const fe={class:"p-4"},_e={class:"mb-6"},ge={class:"text-2xl font-semibold flex items-center gap-2"},ye={class:"rounded-lg border p-4 space-y-4"},be={class:"space-y-2"},xe={key:0,class:"text-sm text-red-500"},ve={class:"space-y-2"},we={key:0,class:"text-sm text-red-500"},ke={class:"rounded-lg border p-4 space-y-4"},he={class:"space-y-2"},Ce={class:"relative"},$e={key:0,class:"text-sm text-red-500"},Se={class:"space-y-2"},Ue={class:"relative"},Ve={class:"rounded-lg border p-4 space-y-4"},Ee={class:"font-medium text-lg flex items-center gap-2"},Ne={class:"space-y-2"},ze={class:"truncate"},Pe=["onClick"],Ae={key:0,class:"text-sm text-red-500"},Re={key:1,class:"mt-2 p-3 rounded-md bg-muted/50 text-sm"},Be={key:0,class:"text-purple-600 dark:text-purple-400"},Fe={key:1,class:"text-blue-600 dark:text-blue-400"},We={key:0,class:"rounded-lg border p-4 space-y-4"},De={class:"font-medium text-lg flex items-center gap-2"},je={key:0,class:"text-sm text-muted-foreground italic"},Ge={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-2"},Te=["checked","onChange"],Le={class:"text-sm"},Me={key:2,class:"text-sm text-red-500"},Oe={key:1,class:"rounded-lg border p-4 space-y-4"},qe={class:"font-medium text-lg flex items-center gap-2"},He={class:"flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50"},Ie={key:2,class:"rounded-lg border p-4 space-y-4"},Je={class:"font-medium text-lg flex items-center gap-2"},Ke={class:"flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50"},Qe={class:"flex items-center justify-end gap-3"},Xe=["disabled"],Ye={class:"mt-4 border-t pt-3"},Ze={class:"rounded-lg bg-muted/50 p-3 text-sm"},es={class:"mt-2"},ss={key:0,class:"mt-1"},ts={class:"list-disc list-inside"},os={key:1,class:"text-sm"},rs={class:"flex justify-end gap-2 mt-4"},hs=H({__name:"Create",props:{roles:{},productions:{}},setup(p){const j=[{title:"Admin",href:"/admin/users"},{title:"Users",href:"/admin/users"},{title:"Create",href:"/admin/users/create"}],C=p,o=I({name:"",email:"",password:"",password_confirmation:"",role_id:"",production_ids:[],can_access_glue_spreaders:!1,can_access_warehouse:!1}),y=w(!1),b=w(!1),x=U(()=>o.role_id?C.roles.find(u=>u.role_id===Number(o.role_id)):null),E=U(()=>{if(!o.role_id)return"Select a role";const u=C.roles.find(e=>e.role_id===Number(o.role_id));return u?u.name:"Select a role"}),N=u=>{o.role_id=u},$=U(()=>x.value?.slug==="staff");J(()=>o.role_id,u=>{C.roles.find(r=>r.role_id===Number(u))?.slug==="super"&&(o.production_ids=[])});const{success:G,error:T}=me(),v=w(!1),S=w(!1),L=()=>{v.value=!0},M=()=>{S.value=!0,o.post("/admin/users",{preserveScroll:!0,onSuccess:()=>{G("User created","New user has been created"),R.get("/admin/users")},onError:()=>{T("Failed to create","There was an error creating the user")},onFinish:()=>{S.value=!1,v.value=!1}})},O=u=>{const e=o.production_ids.indexOf(u);e===-1?o.production_ids.push(u):o.production_ids.splice(e,1)},z=u=>o.production_ids.includes(u);return(u,e)=>(a(),n(k,null,[l(s(K),{title:"Create User"}),l(te,{breadcrumbs:j},{default:i(()=>[t("div",fe,[t("div",_e,[t("h2",ge,[l(s(ce),{class:"size-6"}),e[11]||(e[11]=d(" Create New User ",-1))]),e[12]||(e[12]=t("p",{class:"text-sm text-muted-foreground"},"Add a new user to the system",-1))]),t("form",{onSubmit:Q(L,["prevent"]),class:"space-y-6"},[t("div",ye,[e[15]||(e[15]=t("h3",{class:"font-medium text-lg"},"Basic Information",-1)),t("div",be,[l(s(g),{for:"name"},{default:i(()=>[...e[13]||(e[13]=[d("Name",-1)])]),_:1}),l(s(h),{id:"name",modelValue:s(o).name,"onUpdate:modelValue":e[0]||(e[0]=r=>s(o).name=r),type:"text",placeholder:"Enter full name",class:f({"border-red-500":s(o).errors.name})},null,8,["modelValue","class"]),s(o).errors.name?(a(),n("p",xe,m(s(o).errors.name),1)):c("",!0)]),t("div",ve,[l(s(g),{for:"email"},{default:i(()=>[...e[14]||(e[14]=[d("Email",-1)])]),_:1}),l(s(h),{id:"email",modelValue:s(o).email,"onUpdate:modelValue":e[1]||(e[1]=r=>s(o).email=r),type:"email",placeholder:"Enter email address",class:f({"border-red-500":s(o).errors.email})},null,8,["modelValue","class"]),s(o).errors.email?(a(),n("p",we,m(s(o).errors.email),1)):c("",!0)])]),t("div",ke,[e[18]||(e[18]=t("h3",{class:"font-medium text-lg"},"Password",-1)),t("div",he,[l(s(g),{for:"password"},{default:i(()=>[...e[16]||(e[16]=[d("Password",-1)])]),_:1}),t("div",Ce,[l(s(h),{id:"password",modelValue:s(o).password,"onUpdate:modelValue":e[2]||(e[2]=r=>s(o).password=r),type:y.value?"text":"password",placeholder:"Enter password",class:f(["pr-10",{"border-red-500":s(o).errors.password}])},null,8,["modelValue","type","class"]),t("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:e[3]||(e[3]=r=>y.value=!y.value)},[y.value?(a(),_(s(W),{key:0,class:"size-4"})):(a(),_(s(D),{key:1,class:"size-4"}))])]),s(o).errors.password?(a(),n("p",$e,m(s(o).errors.password),1)):c("",!0)]),t("div",Se,[l(s(g),{for:"password_confirmation"},{default:i(()=>[...e[17]||(e[17]=[d("Confirm Password",-1)])]),_:1}),t("div",Ue,[l(s(h),{id:"password_confirmation",modelValue:s(o).password_confirmation,"onUpdate:modelValue":e[4]||(e[4]=r=>s(o).password_confirmation=r),type:b.value?"text":"password",placeholder:"Confirm password",class:"pr-10"},null,8,["modelValue","type"]),t("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:e[5]||(e[5]=r=>b.value=!b.value)},[b.value?(a(),_(s(W),{key:0,class:"size-4"})):(a(),_(s(D),{key:1,class:"size-4"}))])])])]),t("div",Ve,[t("h3",Ee,[l(s(X),{class:"size-5"}),e[19]||(e[19]=d(" Role & Permissions ",-1))]),t("div",Ne,[l(s(g),{for:"role"},{default:i(()=>[...e[20]||(e[20]=[d("Role",-1)])]),_:1}),l(s(Y),null,{default:i(()=>[l(s(Z),{"as-child":!0},{default:i(()=>[t("button",{type:"button",class:f(["input w-full flex items-center justify-between",{"border-red-500":s(o).errors.role_id}])},[t("span",ze,m(E.value),1),l(s(pe),{class:"ml-2 size-4"})],2)]),_:1}),l(s(ee),{class:"w-[var(--reka-dropdown-menu-trigger-width)] max-w-none"},{default:i(()=>[l(s(B),{"as-child":!0},{default:i(()=>[t("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:e[6]||(e[6]=r=>N(""))},"Select a role")]),_:1}),(a(!0),n(k,null,V(p.roles,r=>(a(),_(s(B),{key:r.role_id,"as-child":!0},{default:i(()=>[t("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:q=>N(r.role_id)},m(r.name),9,Pe)]),_:2},1024))),128))]),_:1})]),_:1}),s(o).errors.role_id?(a(),n("p",Ae,m(s(o).errors.role_id),1)):c("",!0),x.value?(a(),n("div",Re,[x.value.slug==="super"?(a(),n("p",Be,[...e[21]||(e[21]=[t("strong",null,"Super:",-1),d(" Full access to all features, including user management and deletion of resources. ",-1)])])):x.value.slug==="staff"?(a(),n("p",Fe,[...e[22]||(e[22]=[t("strong",null,"Staff:",-1),d(" Can only access assigned productions. Can create, read, and update data but cannot delete. ",-1)])])):c("",!0)])):c("",!0)])]),$.value?(a(),n("div",We,[t("h3",De,[l(s(se),{class:"size-5"}),e[23]||(e[23]=d(" Production Assignments ",-1))]),e[24]||(e[24]=t("p",{class:"text-sm text-muted-foreground"}," Select which productions this user can access. Staff can only see and manage data for their assigned productions. ",-1)),p.productions.length===0?(a(),n("div",je," No active productions available. ")):(a(),n("div",Ge,[(a(!0),n(k,null,V(p.productions,r=>(a(),n("label",{key:r.production_id,class:f(["flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50",{"bg-primary/10 border-primary":z(r.production_id)}])},[t("input",{type:"checkbox",checked:z(r.production_id),onChange:q=>O(r.production_id),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,40,Te),t("span",Le,m(r.production_name),1)],2))),128))])),s(o).errors.production_ids?(a(),n("p",Me,m(s(o).errors.production_ids),1)):c("",!0)])):c("",!0),$.value?(a(),n("div",Oe,[t("h3",qe,[l(s(F),{class:"size-5"}),e[25]||(e[25]=d(" Glue Spreader Access ",-1))]),e[27]||(e[27]=t("p",{class:"text-sm text-muted-foreground"}," Enable this to allow the staff to see and manage the Glue Spreader menu as a whole. ",-1)),t("label",He,[P(t("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=r=>s(o).can_access_glue_spreaders=r),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[A,s(o).can_access_glue_spreaders]]),e[26]||(e[26]=t("span",{class:"text-sm"},"Can access Glue Spreader menu",-1))])])):c("",!0),$.value?(a(),n("div",Ie,[t("h3",Je,[l(s(F),{class:"size-5"}),e[28]||(e[28]=d(" Warehouse Access ",-1))]),e[30]||(e[30]=t("p",{class:"text-sm text-muted-foreground"}," Enable this to allow the staff to see and manage the Warehouse menu as a whole. ",-1)),t("label",Ke,[P(t("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=r=>s(o).can_access_warehouse=r),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[A,s(o).can_access_warehouse]]),e[29]||(e[29]=t("span",{class:"text-sm"},"Can access Warehouse menu",-1))])])):c("",!0),t("div",Qe,[t("button",{type:"button",class:"btn-secondary rounded-md px-4 py-2 transition-all duration-150 hover:opacity-90",onClick:e[9]||(e[9]=r=>s(R).get("/admin/users"))}," Cancel "),t("button",{type:"submit",class:"btn rounded-md px-4 py-2 transition-all duration-150 hover:opacity-90 disabled:opacity-50",disabled:s(o).processing},m(s(o).processing?"Creating...":"Create User"),9,Xe)])],32),l(oe,{open:v.value,"onUpdate:open":e[10]||(e[10]=r=>v.value=r)},{default:i(()=>[l(re,null,{default:i(()=>[l(le,null,{default:i(()=>[l(ae,null,{default:i(()=>[...e[31]||(e[31]=[d("Confirm Create User",-1)])]),_:1}),l(ne,null,{default:i(()=>[...e[32]||(e[32]=[d(" Are you sure you want to create this user? ",-1)])]),_:1}),t("div",Ye,[e[37]||(e[37]=t("h3",{class:"text-sm font-medium mb-2"},"Preview",-1)),t("div",Ze,[t("div",null,[e[33]||(e[33]=t("strong",null,"Name:",-1)),d(" "+m(s(o).name||"-"),1)]),t("div",null,[e[34]||(e[34]=t("strong",null,"Email:",-1)),d(" "+m(s(o).email||"-"),1)]),t("div",null,[e[35]||(e[35]=t("strong",null,"Role:",-1)),d(" "+m(E.value),1)]),t("div",es,[e[36]||(e[36]=t("strong",null,"Productions:",-1)),s(o).production_ids&&s(o).production_ids.length?(a(),n("div",ss,[t("ul",ts,[(a(!0),n(k,null,V(p.productions.filter(r=>s(o).production_ids.includes(r.production_id)),r=>(a(),n("li",{key:r.production_id},m(r.production_name),1))),128))])])):(a(),n("div",os,"None"))])])])]),_:1}),t("div",rs,[l(de,null,{default:i(()=>[...e[38]||(e[38]=[d("Cancel",-1)])]),_:1}),l(ie,{onClick:M,disabled:S.value,class:"hover:cursor-pointer btn"},{default:i(()=>[...e[39]||(e[39]=[d("Create User",-1)])]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"]),l(ue)])]),_:1})],64))}});export{hs as default};
