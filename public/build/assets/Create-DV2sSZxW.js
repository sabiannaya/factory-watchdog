import{d as J,f as w,v as K,g as k,x as Q,c as i,m as d,u as e,p as X,w as c,a as s,q as u,t as a,y as Y,b as _,n as f,o as n,e as g,F as C,i as U,z as B,A as F,B as R}from"./app-i1_2c9TI.js";import{S as Z,U as I,W as D,_ as ee}from"./AppLayout.vue_vue_type_script_setup_true_lang-UWREGGXY.js";import{u as se,_ as te,a as oe,b as re,d as j}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B0bB4Y56.js";import{_ as $}from"./Input.vue_vue_type_script_setup_true_lang-mGQONf2a.js";import{_ as h}from"./Label.vue_vue_type_script_setup_true_lang-BIJFKMbz.js";import{_ as ae,a as le,b as de,c as ne,d as ie,e as ue,f as ce}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-B5Z9-k2f.js";import{_ as me}from"./ToastNotifications.vue_vue_type_script_setup_true_lang-mcyszUyt.js";import{u as _e}from"./useToast-C_zToptU.js";import{U as pe}from"./user-plus-Bq_T1ISt.js";import{E as L}from"./eye-off-CJS5_HbE.js";import{E as M}from"./eye-zQDYR7PF.js";import{C as fe}from"./chevron-down-C8FjIUWp.js";import"./VisuallyHidden-CgfYLdxu.js";import"./index-C4J_hXM0.js";import"./x-T-BkQ4N0.js";const ge={class:"p-4"},he={class:"mb-6"},be={class:"text-2xl font-semibold flex items-center gap-2"},xe={class:"text-sm text-muted-foreground"},ve={class:"rounded-lg border p-4 space-y-4"},ye={class:"font-medium text-lg"},we={class:"space-y-2"},ke={key:0,class:"text-sm text-red-500"},Ce={class:"space-y-2"},$e={key:0,class:"text-sm text-red-500"},Ve={class:"rounded-lg border p-4 space-y-4"},ze={class:"font-medium text-lg"},Se={class:"space-y-2"},Ue={class:"relative"},Ne={key:0,class:"text-sm text-red-500"},Ee={class:"space-y-2"},Pe={class:"relative"},Be={class:"rounded-lg border p-4 space-y-4"},Fe={class:"font-medium text-lg flex items-center gap-2"},Re={class:"space-y-2"},De={class:"truncate"},je=["onClick"],Le={key:0,class:"text-sm text-red-500"},Me={key:1,class:"mt-2 p-3 rounded-md bg-muted/50 text-sm"},Oe={key:0,class:"text-purple-600 dark:text-purple-400"},Te={key:1,class:"text-blue-600 dark:text-blue-400"},We={key:0,class:"rounded-lg border p-4 space-y-4"},qe={class:"font-medium text-lg flex items-center gap-2"},Ae={class:"text-sm text-muted-foreground"},Ge={key:0,class:"text-sm text-muted-foreground italic"},He={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-2"},Je=["checked","onChange"],Ke={class:"text-sm"},Qe={key:2,class:"text-sm text-red-500"},Xe={key:1,class:"rounded-lg border p-4 space-y-4"},Ye={class:"font-medium text-lg flex items-center gap-2"},Ze={class:"text-sm text-muted-foreground"},Ie={class:"flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50"},es={class:"text-sm"},ss={key:2,class:"rounded-lg border p-4 space-y-4"},ts={class:"font-medium text-lg flex items-center gap-2"},os={class:"text-sm text-muted-foreground"},rs={class:"flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50"},as={class:"text-sm"},ls={class:"flex items-center justify-end gap-3"},ds=["disabled"],ns={class:"mt-4 border-t pt-3"},is={class:"rounded-lg bg-muted/50 p-3 text-sm"},us={class:"mt-2"},cs={key:0,class:"mt-1"},ms={class:"list-disc list-inside"},_s={key:1,class:"text-sm"},ps={class:"flex justify-end gap-2 mt-4"},Ns=J({__name:"Create",props:{roles:{},productions:{}},setup(p){const{t:r}=se(),O=w(()=>[{title:r("users.admin"),href:"/admin/users"},{title:r("users.users"),href:"/admin/users"},{title:r("users.create"),href:"/admin/users/create"}]),V=p,t=K({name:"",email:"",password:"",password_confirmation:"",role_id:"",production_ids:[],can_access_glue_spreaders:!1,can_access_warehouse:!1}),b=k(!1),x=k(!1),v=w(()=>t.role_id?V.roles.find(m=>m.role_id===Number(t.role_id)):null),N=w(()=>{if(!t.role_id)return r("users.select_role");const m=V.roles.find(o=>o.role_id===Number(t.role_id));return m?m.name:r("users.select_role")}),E=m=>{t.role_id=m},z=w(()=>v.value?.slug==="staff");Q(()=>t.role_id,m=>{V.roles.find(l=>l.role_id===Number(m))?.slug==="super"&&(t.production_ids=[])});const{success:T,error:W}=_e(),y=k(!1),S=k(!1),q=()=>{y.value=!0},A=()=>{S.value=!0,t.post("/admin/users",{preserveScroll:!0,onSuccess:()=>{T(r("users.user_created"),r("users.user_created_description")),R.get("/admin/users")},onError:()=>{W(r("users.create_failed"),r("users.create_failed_description"))},onFinish:()=>{S.value=!1,y.value=!1}})},G=m=>{const o=t.production_ids.indexOf(m);o===-1?t.production_ids.push(m):t.production_ids.splice(o,1)},P=m=>t.production_ids.includes(m);return(m,o)=>(n(),i(C,null,[d(e(X),{title:e(r)("users.create_title")},null,8,["title"]),d(ee,{breadcrumbs:O.value},{default:c(()=>[s("div",ge,[s("div",he,[s("h2",be,[d(e(pe),{class:"size-6"}),u(" "+a(e(r)("users.create_title")),1)]),s("p",xe,a(e(r)("users.create_description")),1)]),s("form",{onSubmit:Y(q,["prevent"]),class:"space-y-6"},[s("div",ve,[s("h3",ye,a(e(r)("users.basic_information")),1),s("div",we,[d(e(h),{for:"name"},{default:c(()=>[u(a(e(r)("users.name")),1)]),_:1}),d(e($),{id:"name",modelValue:e(t).name,"onUpdate:modelValue":o[0]||(o[0]=l=>e(t).name=l),type:"text",placeholder:e(r)("users.name_placeholder"),class:f({"border-red-500":e(t).errors.name})},null,8,["modelValue","placeholder","class"]),e(t).errors.name?(n(),i("p",ke,a(e(t).errors.name),1)):_("",!0)]),s("div",Ce,[d(e(h),{for:"email"},{default:c(()=>[u(a(e(r)("users.email")),1)]),_:1}),d(e($),{id:"email",modelValue:e(t).email,"onUpdate:modelValue":o[1]||(o[1]=l=>e(t).email=l),type:"email",placeholder:e(r)("users.email_placeholder"),class:f({"border-red-500":e(t).errors.email})},null,8,["modelValue","placeholder","class"]),e(t).errors.email?(n(),i("p",$e,a(e(t).errors.email),1)):_("",!0)])]),s("div",Ve,[s("h3",ze,a(e(r)("users.password_section")),1),s("div",Se,[d(e(h),{for:"password"},{default:c(()=>[u(a(e(r)("users.password_section")),1)]),_:1}),s("div",Ue,[d(e($),{id:"password",modelValue:e(t).password,"onUpdate:modelValue":o[2]||(o[2]=l=>e(t).password=l),type:b.value?"text":"password",placeholder:e(r)("users.password_placeholder"),class:f(["pr-10",{"border-red-500":e(t).errors.password}])},null,8,["modelValue","type","placeholder","class"]),s("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:o[3]||(o[3]=l=>b.value=!b.value)},[b.value?(n(),g(e(L),{key:0,class:"size-4"})):(n(),g(e(M),{key:1,class:"size-4"}))])]),e(t).errors.password?(n(),i("p",Ne,a(e(t).errors.password),1)):_("",!0)]),s("div",Ee,[d(e(h),{for:"password_confirmation"},{default:c(()=>[u(a(e(r)("users.confirm_new_password")),1)]),_:1}),s("div",Pe,[d(e($),{id:"password_confirmation",modelValue:e(t).password_confirmation,"onUpdate:modelValue":o[4]||(o[4]=l=>e(t).password_confirmation=l),type:x.value?"text":"password",placeholder:e(r)("users.confirm_password_placeholder"),class:"pr-10"},null,8,["modelValue","type","placeholder"]),s("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:o[5]||(o[5]=l=>x.value=!x.value)},[x.value?(n(),g(e(L),{key:0,class:"size-4"})):(n(),g(e(M),{key:1,class:"size-4"}))])])])]),s("div",Be,[s("h3",Fe,[d(e(Z),{class:"size-5"}),u(" "+a(e(r)("users.role_permissions")),1)]),s("div",Re,[d(e(h),{for:"role"},{default:c(()=>[u(a(e(r)("users.role")),1)]),_:1}),d(e(te),null,{default:c(()=>[d(e(oe),{"as-child":!0},{default:c(()=>[s("button",{type:"button",class:f(["input w-full flex items-center justify-between",{"border-red-500":e(t).errors.role_id}])},[s("span",De,a(N.value),1),d(e(fe),{class:"ml-2 size-4"})],2)]),_:1}),d(e(re),{class:"w-[var(--reka-dropdown-menu-trigger-width)] max-w-none"},{default:c(()=>[d(e(j),{"as-child":!0},{default:c(()=>[s("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:o[6]||(o[6]=l=>E(""))},a(e(r)("users.select_role")),1)]),_:1}),(n(!0),i(C,null,U(p.roles,l=>(n(),g(e(j),{key:l.role_id,"as-child":!0},{default:c(()=>[s("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:H=>E(l.role_id)},a(l.name),9,je)]),_:2},1024))),128))]),_:1})]),_:1}),e(t).errors.role_id?(n(),i("p",Le,a(e(t).errors.role_id),1)):_("",!0),v.value?(n(),i("div",Me,[v.value.slug==="super"?(n(),i("p",Oe,[...o[11]||(o[11]=[s("strong",null,"Super:",-1),u(" Full access to all features, including user management and deletion of resources. ",-1)])])):v.value.slug==="staff"?(n(),i("p",Te,[...o[12]||(o[12]=[s("strong",null,"Staff:",-1),u(" Can only access assigned productions. Can create, read, and update data but cannot delete. ",-1)])])):_("",!0)])):_("",!0)])]),z.value?(n(),i("div",We,[s("h3",qe,[d(e(I),{class:"size-5"}),u(" "+a(e(r)("users.production_assignments")),1)]),s("p",Ae,a(e(r)("users.select_productions")),1),p.productions.length===0?(n(),i("div",Ge," No active productions available. ")):(n(),i("div",He,[(n(!0),i(C,null,U(p.productions,l=>(n(),i("label",{key:l.production_id,class:f(["flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50",{"bg-primary/10 border-primary":P(l.production_id)}])},[s("input",{type:"checkbox",checked:P(l.production_id),onChange:H=>G(l.production_id),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,40,Je),s("span",Ke,a(l.production_name),1)],2))),128))])),e(t).errors.production_ids?(n(),i("p",Qe,a(e(t).errors.production_ids),1)):_("",!0)])):_("",!0),z.value?(n(),i("div",Xe,[s("h3",Ye,[d(e(D),{class:"size-5"}),u(" "+a(e(r)("users.glue_access")),1)]),s("p",Ze,a(e(r)("users.glue_access_description")),1),s("label",Ie,[B(s("input",{type:"checkbox","onUpdate:modelValue":o[7]||(o[7]=l=>e(t).can_access_glue_spreaders=l),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[F,e(t).can_access_glue_spreaders]]),s("span",es,a(e(r)("users.glue_access")),1)])])):_("",!0),z.value?(n(),i("div",ss,[s("h3",ts,[d(e(D),{class:"size-5"}),u(" "+a(e(r)("users.warehouse_access")),1)]),s("p",os,a(e(r)("users.warehouse_access_description")),1),s("label",rs,[B(s("input",{type:"checkbox","onUpdate:modelValue":o[8]||(o[8]=l=>e(t).can_access_warehouse=l),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[F,e(t).can_access_warehouse]]),s("span",as,a(e(r)("users.warehouse_access")),1)])])):_("",!0),s("div",ls,[s("button",{type:"button",class:"btn-secondary rounded-md px-4 py-2 transition-all duration-150 hover:opacity-90",onClick:o[9]||(o[9]=l=>e(R).get("/admin/users"))},a(e(r)("users.cancel")),1),s("button",{type:"submit",class:"btn rounded-md px-4 py-2 transition-all duration-150 hover:opacity-90 disabled:opacity-50",disabled:e(t).processing},a(e(t).processing?e(r)("users.creating"):e(r)("users.confirm_create")),9,ds)])],32),d(ae,{open:y.value,"onUpdate:open":o[10]||(o[10]=l=>y.value=l)},{default:c(()=>[d(le,null,{default:c(()=>[d(de,null,{default:c(()=>[d(ne,null,{default:c(()=>[u(a(e(r)("users.confirm_create_title")),1)]),_:1}),d(ie,null,{default:c(()=>[u(a(e(r)("users.confirm_create_description")),1)]),_:1}),s("div",ns,[o[17]||(o[17]=s("h3",{class:"text-sm font-medium mb-2"},"Preview",-1)),s("div",is,[s("div",null,[o[13]||(o[13]=s("strong",null,"Name:",-1)),u(" "+a(e(t).name||"-"),1)]),s("div",null,[o[14]||(o[14]=s("strong",null,"Email:",-1)),u(" "+a(e(t).email||"-"),1)]),s("div",null,[o[15]||(o[15]=s("strong",null,"Role:",-1)),u(" "+a(N.value),1)]),s("div",us,[o[16]||(o[16]=s("strong",null,"Productions:",-1)),e(t).production_ids&&e(t).production_ids.length?(n(),i("div",cs,[s("ul",ms,[(n(!0),i(C,null,U(p.productions.filter(l=>e(t).production_ids.includes(l.production_id)),l=>(n(),i("li",{key:l.production_id},a(l.production_name),1))),128))])])):(n(),i("div",_s,"None"))])])])]),_:1}),s("div",ps,[d(ue,null,{default:c(()=>[u(a(e(r)("users.cancel")),1)]),_:1}),d(ce,{onClick:A,disabled:S.value,class:"hover:cursor-pointer btn"},{default:c(()=>[u(a(e(r)("users.confirm_create")),1)]),_:1},8,["disabled"])])]),_:1})]),_:1},8,["open"]),d(me)])]),_:1},8,["breadcrumbs"])],64))}});export{Ns as default};
