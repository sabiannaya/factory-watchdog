import{d as _,c as u,a as t,z as D,b as m,q as v,L as U,t as i,M as S,o as d,f as p,F as $,i as C,N as V,g as G,x as j,n as b,e as A,r as B,u as T,m as q,A as M}from"./app-BRuhaguS.js";import{C as P}from"./chevron-down-Bi0ueEnd.js";import{C as E}from"./AppLayout.vue_vue_type_script_setup_true_lang-BSta2Xg1.js";import{S as O}from"./search-DqEYQ3zn.js";const z={class:"rounded-lg border border-sidebar-border/70 bg-card dark:bg-card p-6"},F={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},I={class:"flex flex-col gap-2"},L={key:0,class:"text-xs text-destructive dark:text-destructive"},K={class:"flex flex-col gap-2"},Q={key:0,class:"text-xs text-destructive dark:text-destructive"},Rt=_({__name:"ProductionFormFields",props:{form:{}},setup(r){return(k,n)=>(d(),u("div",z,[n[5]||(n[5]=t("h2",{class:"text-lg font-semibold mb-5"},"Production Details",-1)),t("div",F,[t("div",I,[n[2]||(n[2]=t("label",{class:"text-sm font-medium"},[v("Production Name "),t("span",{class:"text-red-500"},"*")],-1)),D(t("input",{"onUpdate:modelValue":n[0]||(n[0]=c=>r.form.production_name=c),type:"text",class:"input",required:""},null,512),[[U,r.form.production_name]]),r.form.errors.production_name?(d(),u("div",L,i(r.form.errors.production_name),1)):m("",!0)]),t("div",K,[n[4]||(n[4]=t("label",{class:"text-sm font-medium"},[v("Status "),t("span",{class:"text-red-500"},"*")],-1)),D(t("select",{"onUpdate:modelValue":n[1]||(n[1]=c=>r.form.status=c),class:"appearance-none rounded-md border bg-popover dark:bg-popover text-popover-foreground dark:text-popover-foreground px-3 py-2 pr-10 text-sm shadow-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[...n[3]||(n[3]=[t("option",{value:"active"},"Active",-1),t("option",{value:"inactive"},"Inactive",-1)])],512),[[S,r.form.status]]),r.form.errors.status?(d(),u("div",Q,i(r.form.errors.status),1)):m("",!0)])])]))}}),R={class:"space-y-4"},H={key:0,class:"mb-4 pb-4 border-b border-sidebar-border/70 dark:border-sidebar-border/70"},J=["value"],W={class:"space-y-3"},X={class:"text-sm font-medium capitalize"},Y=["value","onInput"],Z={key:0,class:"space-y-3"},tt={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},et={class:"text-sm font-medium capitalize"},at=["value","onInput"],rt={key:1,class:"flex flex-col gap-2"},st=["value"],N=_({__name:"TargetInputs",props:{inputConfig:{},targets:{},targetDate:{},showDate:{type:Boolean,default:!1}},emits:["update:targets"],setup(r,{emit:k}){const n=r,c=k,g=p(()=>{let l=n.inputConfig?.fields??[];return l.length||(l=["qty_normal","qty_reject"]),l.includes("qty")&&(l=l.filter(o=>o!=="qty"),l.includes("qty_normal")||l.push("qty_normal"),l.includes("qty_reject")||l.push("qty_reject")),l.filter(o=>o!=="keterangan")}),h=p(()=>{const l={...n.targets};return l.qty!==void 0&&(l.qty_normal===void 0&&(l.qty_normal=l.qty),delete l.qty),l}),f=p(()=>n.inputConfig?.grade_types||[]);function y(l,o){const e={...h.value};o==null?delete e[l]:e[l]=o,c("update:targets",e)}function w(l,o){const e=`grade_${l}`,a={...n.targets};o==null?delete a[e]:a[e]=o,c("update:targets",a)}return(l,o)=>(d(),u("div",R,[r.showDate&&r.targetDate?(d(),u("div",H,[o[1]||(o[1]=t("label",{class:"text-sm font-medium block mb-2"},"Target Date",-1)),t("input",{type:"date",value:r.targetDate,class:"input max-w-xs",disabled:""},null,8,J),o[2]||(o[2]=t("p",{class:"text-xs text-muted-foreground dark:text-muted-foreground mt-2"}," Set targets for each input field for this date ",-1))])):m("",!0),t("div",W,[(d(!0),u($,null,C(g.value,e=>D((d(),u("div",{key:e,class:"flex flex-col gap-2"},[t("label",X,i(e.replace(/_/g," ")),1),t("input",{type:"number",min:"0",value:h.value[e]??null,onInput:a=>y(e,a.target.value?Number(a.target.value):null),class:"input",placeholder:"Enter value"},null,40,Y)])),[[V,e!=="grades"&&e!=="grade"]])),128)),r.inputConfig?.fields?.includes("grades")&&f.value.length>0?(d(),u("div",Z,[o[3]||(o[3]=t("label",{class:"text-sm font-medium block"},"Grades",-1)),t("div",tt,[(d(!0),u($,null,C(f.value,e=>(d(),u("div",{key:e,class:"flex flex-col gap-2"},[t("label",et,i(e),1),t("input",{type:"number",min:"0",value:r.targets[`grade_${e}`]??null,onInput:a=>w(e,a.target.value?Number(a.target.value):null),class:"input",placeholder:"Enter value"},null,40,at)]))),128))])])):m("",!0),r.inputConfig?.fields?.includes("grade")&&!r.inputConfig?.fields?.includes("grades")?(d(),u("div",rt,[o[4]||(o[4]=t("label",{class:"text-sm font-medium"},"Grade",-1)),t("input",{type:"number",min:"0",value:r.targets.grade??null,onInput:o[0]||(o[0]=e=>y("grade",e.target.value?Number(e.target.value):null)),class:"input",placeholder:"Enter value"},null,40,st)])):m("",!0)])]))}}),ot={class:"p-4"},dt={class:"flex items-start justify-between gap-4"},nt=["disabled"],ut={class:"flex-1 min-w-0"},lt={class:"flex items-center gap-2 mb-1 flex-wrap"},it={key:0,class:"flex gap-1"},ct={class:"flex items-center gap-2 cursor-pointer flex-shrink-0"},gt=["checked"],mt={key:0,class:"mt-4 pt-4 border-t border-sidebar-border/70 dark:border-sidebar-border/70"},ft={class:"space-y-4"},xt={class:"flex flex-col gap-2"},ht=["value"],pt={key:0,class:"space-y-1"},bt={class:"space-y-2 pb-4 border-b border-sidebar-border/70 dark:border-sidebar-border/70"},vt={key:0,class:"space-y-1"},kt={key:0,class:"space-y-2"},yt={class:"flex items-center gap-2 mb-2"},$t={class:"text-xs px-2 py-0.5 rounded-full bg-emerald-600/20 text-emerald-700 dark:text-emerald-400"},Ct={key:0,class:"space-y-1"},wt={key:1,class:"mt-3 pt-3 border-t border-sidebar-border/70 dark:border-sidebar-border/70 flex gap-4 text-sm text-muted-foreground dark:text-muted-foreground"},Dt={class:"text-foreground dark:text-foreground"},_t={key:0},Gt={class:"text-foreground dark:text-foreground"},Tt=_({__name:"MachineGroupItem",props:{machineGroup:{},attached:{type:Boolean},machineCount:{},targets:{},defaultTargets:{},targetDate:{},errors:{}},emits:["update:attached","update:machineCount","update:targets","update:defaultTargets"],setup(r,{emit:k}){const n=r,c=k,g=G(!1),h={value:!1};j(()=>n.attached,(o,e)=>{if(!h.value){h.value=!0;return}o&&!g.value&&(g.value=!0)});const f=p(()=>Object.values(n.targets).some(o=>o!=null)),y=p(()=>n.targetDate&&f.value?"bg-emerald-600/20 text-emerald-700 dark:text-emerald-400":!n.targetDate&&f.value?"bg-sky-600/20 text-sky-700 dark:text-sky-400":"bg-gray-600/20 text-gray-700 dark:text-gray-400"),w=p(()=>n.targetDate&&f.value?"Per-date":!n.targetDate&&f.value?"Default":"No target");function l(){g.value=!g.value}return(o,e)=>(d(),u("div",{class:b(["rounded-lg border transition-all",r.attached?"border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/40 dark:bg-muted/40 border-ring/30 dark:border-ring/30":"border-sidebar-border/30 dark:border-sidebar-border/30 bg-muted/5 dark:bg-muted/5 opacity-60"])},[t("div",ot,[t("div",dt,[t("button",{type:"button",onClick:e[0]||(e[0]=a=>r.attached?l():null),disabled:!r.attached,class:b(["flex items-start gap-3 flex-1 text-left transition-colors",r.attached?"group cursor-pointer hover:text-foreground dark:hover:text-foreground":"cursor-not-allowed opacity-60"])},[(d(),A(B(g.value?T(P):T(E)),{class:b(["h-5 w-5 mt-0.5 transition-colors",r.attached?"text-muted-foreground dark:text-muted-foreground group-hover:text-foreground dark:group-hover:text-foreground":"text-muted-foreground/50 dark:text-muted-foreground/50"])},null,8,["class"])),t("div",ut,[t("div",lt,[t("h3",{class:b(["font-semibold text-base",r.attached?"text-foreground dark:text-foreground":"text-muted-foreground dark:text-muted-foreground"])},i(r.machineGroup.name),3),r.attached?(d(),u("div",it,[t("span",{class:b(["text-xs px-2 py-0.5 rounded-full whitespace-nowrap",y.value])},i(w.value),3)])):m("",!0)]),t("p",{class:b(["text-sm line-clamp-1",r.attached?"text-muted-foreground dark:text-muted-foreground":"text-muted-foreground/60 dark:text-muted-foreground/60"])},i(r.machineGroup.description||"No description"),3)])],10,nt),t("label",ct,[t("input",{type:"checkbox",checked:r.attached,onChange:e[1]||(e[1]=a=>c("update:attached",a.target.checked)),class:"w-4 h-4 rounded border-input dark:border-input"},null,40,gt),t("span",{class:b(["text-sm font-medium transition-colors",r.attached?"text-foreground dark:text-foreground":"text-muted-foreground dark:text-muted-foreground"])},i(r.attached?"Attached":"Attach"),3)])]),r.attached&&g.value?(d(),u("div",mt,[t("div",ft,[t("div",xt,[e[5]||(e[5]=t("label",{class:"text-sm font-medium"},[v("Machine Count "),t("span",{class:"text-red-500"},"*")],-1)),t("input",{type:"number",min:"1",value:r.machineCount,onInput:e[2]||(e[2]=a=>c("update:machineCount",Number(a.target.value))),class:"input"},null,40,ht),r.errors?.machine_count?(d(),u("div",pt,[(d(!0),u($,null,C(r.errors.machine_count,(a,s)=>(d(),u("div",{key:s,class:"text-xs text-destructive dark:text-destructive"},i(a),1))),128))])):m("",!0)]),t("div",bt,[e[6]||(e[6]=t("div",{class:"flex items-center gap-2 mb-2"},[t("h4",{class:"text-sm font-semibold"},"Production Defaults"),t("span",{class:"text-xs px-2 py-0.5 rounded-full bg-sky-600/20 text-sky-700 dark:text-sky-400"}," Per machine group ")],-1)),e[7]||(e[7]=t("p",{class:"text-xs text-muted-foreground dark:text-muted-foreground mb-3"}," Set default target values for this machine group (used unless overridden daily) ",-1)),q(N,{"input-config":r.machineGroup.input_config,targets:r.defaultTargets,"show-date":!1,"onUpdate:targets":e[3]||(e[3]=a=>c("update:defaultTargets",a))},null,8,["input-config","targets"]),r.errors?.default_targets?(d(),u("div",vt,[(d(!0),u($,null,C(r.errors.default_targets,(a,s)=>(d(),u("div",{key:s,class:"text-xs text-destructive dark:text-destructive"},i(a),1))),128))])):m("",!0)]),r.targetDate?(d(),u("div",kt,[t("div",yt,[e[8]||(e[8]=t("h4",{class:"text-sm font-semibold"},"Per-Date Targets",-1)),t("span",$t," Override for "+i(r.targetDate),1)]),e[9]||(e[9]=t("p",{class:"text-xs text-muted-foreground dark:text-muted-foreground mb-3"}," Override defaults for this specific date ",-1)),q(N,{"input-config":r.machineGroup.input_config,targets:r.targets,"target-date":r.targetDate,"show-date":!1,"onUpdate:targets":e[4]||(e[4]=a=>c("update:targets",a))},null,8,["input-config","targets","target-date"]),r.errors?.targets?(d(),u("div",Ct,[(d(!0),u($,null,C(r.errors.targets,(a,s)=>(d(),u("div",{key:s,class:"text-xs text-destructive dark:text-destructive"},i(a),1))),128))])):m("",!0)])):m("",!0)])])):m("",!0),r.attached&&!g.value?(d(),u("div",wt,[t("span",null,[t("strong",Dt,i(r.machineCount),1),e[10]||(e[10]=v(" machines",-1))]),f.value?(d(),u("span",_t,[t("strong",Gt,i(Object.values(r.targets).filter(a=>a!==null).length),1),e[11]||(e[11]=v(" targets set ",-1))])):m("",!0)])):m("",!0)])],2))}}),qt={class:"rounded-lg border border-sidebar-border/70 bg-card p-6 dark:border-sidebar-border/70 dark:bg-card"},Nt={class:"mb-2 flex items-start justify-between"},Ut={class:"mt-1 text-sm text-muted-foreground dark:text-muted-foreground"},At={class:"font-medium"},St={key:0,class:"mb-6 border-b border-sidebar-border/70 pb-6 dark:border-sidebar-border/70"},Vt=["value"],jt={class:"mb-6 space-y-3"},Bt={class:"relative"},Mt={class:"flex items-center gap-4"},Pt={class:"flex cursor-pointer items-center gap-2"},Et={class:"text-xs text-muted-foreground dark:text-muted-foreground"},Ot={class:"max-h-[600px] space-y-3 overflow-y-auto pr-2"},zt={key:0,class:"py-12 text-center text-muted-foreground dark:text-muted-foreground"},Ft={class:"text-sm"},Ht=_({__name:"MachineGroupSelector",props:{machineGroups:{},attachedGroups:{},targetDate:{},errors:{}},emits:["update:attachedGroups","update:targetDate"],setup(r,{emit:k}){const n=r,c=k,g=G(""),h=G(!1),f=p(()=>{let e=n.machineGroups.map(a=>{const s=n.attachedGroups[a.machine_group_id];return{...a,attached:!!s,machineCount:s?.machine_count??1,targets:s?.targets??{},defaultTargets:s?.default_targets??{}}});if(g.value){const a=g.value.toLowerCase();e=e.filter(s=>s.name?.toLowerCase().includes(a)||s.description?.toLowerCase().includes(a))}return h.value&&(e=e.filter(a=>a.attached)),e.sort((a,s)=>a.attached&&!s.attached?-1:!a.attached&&s.attached?1:(a.name||"").localeCompare(s.name||""))}),y=p(()=>Object.keys(n.attachedGroups).length);function w(){const e={};n.machineGroups.forEach(a=>{e[a.machine_group_id]={machine_group_id:a.machine_group_id,machine_count:1,targets:{},default_targets:{}}}),c("update:attachedGroups",e)}function l(){c("update:attachedGroups",{})}function o(e,a){const s={};for(const x in n.attachedGroups)s[Number(x)]={...n.attachedGroups[Number(x)]};if("attached"in a){a.attached===!1?delete s[e]:a.attached===!0&&!s[e]&&(s[e]={machine_group_id:e,machine_count:1,targets:{},default_targets:{}}),c("update:attachedGroups",s);return}s[e]&&(a.machine_count!==void 0&&(s[e].machine_count=a.machine_count),a.targets!==void 0&&(s[e].targets={...a.targets}),a.default_targets!==void 0&&(s[e].default_targets={...a.default_targets}),c("update:attachedGroups",s))}return(e,a)=>(d(),u("div",qt,[t("div",Nt,[t("div",null,[a[3]||(a[3]=t("h2",{class:"text-lg font-semibold"},"Machine Groups",-1)),t("p",Ut,[t("span",At,i(y.value),1),v(" of "+i(r.machineGroups.length)+" groups attached ",1)])]),t("div",{class:"flex items-center gap-2"},[t("button",{type:"button",class:"btn btn-sm",onClick:w,title:"Attach all machine groups"}," Attach All "),t("button",{type:"button",class:"btn btn-sm btn-ghost",onClick:l,title:"Detach all machine groups"}," Detach All ")])]),r.targetDate!==void 0?(d(),u("div",St,[a[4]||(a[4]=t("label",{class:"mb-3 block text-sm font-medium"},[v(" Target Date "),t("span",{class:"text-muted-foreground dark:text-muted-foreground"},"(optional)")],-1)),t("input",{type:"date",value:r.targetDate||"",onInput:a[0]||(a[0]=s=>e.$emit("update:targetDate",s.target.value||null)),class:"input max-w-xs"},null,40,Vt),a[5]||(a[5]=t("p",{class:"mt-2 text-xs text-muted-foreground dark:text-muted-foreground"}," Set a date to create per-date targets for attached groups ",-1))])):m("",!0),t("div",jt,[t("div",Bt,[q(T(O),{class:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground dark:text-muted-foreground"}),D(t("input",{"onUpdate:modelValue":a[1]||(a[1]=s=>g.value=s),type:"text",placeholder:"Search machine groups...",class:"input pl-10"},null,512),[[U,g.value]])]),t("div",Mt,[t("label",Pt,[D(t("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=s=>h.value=s),class:"h-4 w-4 rounded border-input dark:border-input"},null,512),[[M,h.value]]),a[6]||(a[6]=t("span",{class:"text-sm"},"Show attached only",-1))]),t("span",Et,i(f.value.length)+" groups shown ",1)])]),t("div",Ot,[f.value.length===0?(d(),u("div",zt,[t("p",Ft,i(g.value?"No groups match your search":"No machine groups available"),1)])):m("",!0),(d(!0),u($,null,C(f.value,s=>(d(),A(Tt,{key:s.machine_group_id,"machine-group":s,attached:s.attached,"machine-count":s.machineCount,targets:s.targets,"default-targets":s.defaultTargets,"target-date":r.targetDate,errors:r.errors?.[s.machine_group_id],"onUpdate:attached":x=>o(s.machine_group_id,{attached:x}),"onUpdate:machineCount":x=>o(s.machine_group_id,{machine_count:x}),"onUpdate:targets":x=>o(s.machine_group_id,{targets:x}),"onUpdate:defaultTargets":x=>o(s.machine_group_id,{default_targets:x})},null,8,["machine-group","attached","machine-count","targets","default-targets","target-date","errors","onUpdate:attached","onUpdate:machineCount","onUpdate:targets","onUpdate:defaultTargets"]))),128))])]))}});export{Rt as _,Ht as a};
