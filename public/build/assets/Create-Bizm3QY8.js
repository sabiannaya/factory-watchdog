import{d as x,v as y,g as m,x as j,c as k,m as u,u as i,p as D,w as E,a as r,y as O,t as T,B as f,F as z,o as B}from"./app-D4NX6RtZ.js";import{_ as G}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNNNqqjX.js";import{_ as P,a as S}from"./MachineGroupSelector.vue_vue_type_script_setup_true_lang-CL8ikNk5.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BzC2dvNG.js";import"./Presence-CsGVf8pY.js";import"./createLucideIcon-A0T1vukc.js";import"./useForwardPropsEmits-BmzqlngZ.js";import"./x-XD7JAbQb.js";import"./VisuallyHidden-BeURpiPp.js";import"./index-C4J_hXM0.js";import"./chevron-down-D-IdcPDr.js";import"./search-DA59VARU.js";const U={class:"p-4 space-y-4"},$={class:"flex items-center gap-3 pt-4"},q=["disabled"],X=x({__name:"Create",props:{machine_groups:{}},setup(g){const h=[{title:"Data Management",href:"/data-management/production"},{title:"Production",href:"/data-management/production"},{title:"Create",href:window.location.pathname}],_=g,n=y({production_name:"",status:"active",target_date:null,machine_groups:{}}),s=m(null),o=m({}),l=m({});function d(e){const t={};return e&&Object.entries(e).forEach(([a,c])=>{if(a==="qty"){t.qty_normal=c;return}t[a]=c}),t}j([s,o],()=>{n.target_date=s.value,n.machine_groups=o.value},{deep:!0});function v(e){o.value=e}function b(e){s.value=e}function C(){l.value={};let e=!0;return Object.values(o.value).forEach(t=>{const a={};if((!t.machine_count||t.machine_count<1)&&(a.machine_count=["Machine count must be at least 1"],e=!1),s.value){const c=d(t.targets);Object.values(c).some(p=>p!=null)||(a.targets=["At least one target is required when target date is set"],e=!1)}Object.keys(a).length>0&&(l.value[t.machine_group_id]=a)}),e}function w(){if(!C())return;const e={};Object.entries(o.value).forEach(([t,a])=>{e[Number(t)]={...a,targets:d(a.targets),default_targets:d(a.default_targets)}}),n.machine_groups=e,n.post("/data-management/production",{preserveState:!1,onSuccess:()=>{f.get("/data-management/production")}})}return(e,t)=>(B(),k(z,null,[u(i(D),{title:"Create Production"}),u(G,{breadcrumbs:h},{default:E(()=>[r("div",U,[t[1]||(t[1]=r("div",null,[r("h1",{class:"text-3xl font-bold"},"Create Production"),r("p",{class:"text-muted-foreground dark:text-muted-foreground"}," Create a new production and attach machine groups with targets ")],-1)),r("form",{onSubmit:O(w,["prevent"]),class:"space-y-6"},[u(P,{form:i(n)},null,8,["form"]),u(S,{"machine-groups":_.machine_groups||[],"attached-groups":o.value,"target-date":s.value,errors:l.value,"onUpdate:attachedGroups":v,"onUpdate:targetDate":b},null,8,["machine-groups","attached-groups","target-date","errors"]),r("div",$,[r("button",{type:"submit",class:"hover:cursor-pointer btn",disabled:i(n).processing},T(i(n).processing?"Creating...":"Create Production"),9,q),r("button",{type:"button",class:"btn btn-ghost",onClick:t[0]||(t[0]=a=>i(f).get("/data-management/production"))}," Cancel ")])],32)])]),_:1})],64))}});export{X as default};
