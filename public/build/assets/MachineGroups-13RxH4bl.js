import{d as w,r as p,e as M,J as n,c as T,k as d,u as P,l as C,m as F,a as r,H as c,I as m,F as G,o as V}from"./app-ByVm3FOg.js";import{_ as q}from"./AppLayout.vue_vue_type_script_setup_true_lang-CA8oNPt4.js";import{_ as A}from"./DataTable.vue_vue_type_script_setup_true_lang-Bgb--yl3.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C8rHliBE.js";import"./index-CbbRSED3.js";import"./VisuallyHidden-CuZB7xnA.js";import"./useForwardExpose-B_jyS2_j.js";import"./useForwardPropsEmits-DpcW7WWk.js";import"./index-C4J_hXM0.js";import"./createLucideIcon-B5wOFtcm.js";import"./Input.vue_vue_type_script_setup_true_lang-CPkvjD3L.js";import"./Spinner.vue_vue_type_script_setup_true_lang-D3P61CV7.js";import"./search-DCPcnRYA.js";const D={class:"p-4 space-y-4"},N={class:"flex items-center gap-3 mb-3"},$=["disabled"],B=["disabled"],E=["disabled"],U={class:"mt-4 flex items-center justify-end gap-2"},j=["disabled"],H=["disabled"],te=w({__name:"MachineGroups",props:{aggregates:{},meta:{}},setup(g){const b=[{title:"Summary",href:"/summary/machine-groups"},{title:"Machine Group Summary",href:"/summary/machine-groups"}],t=g,o=p(!1),l=p(t.meta?.date_from??""),i=p(t.meta?.date_to??""),f=M(()=>t.aggregates?.data??[]),_=e=>{const a=t.meta?.per_page??20,s=t.meta?.sort??"total_output",u=t.meta?.direction??"desc";n.get(window.location.pathname,{q:e,per_page:a,sort:s,direction:u},{preserveState:!0,replace:!0})},v=({sort:e,direction:a})=>{const s=t.meta?.per_page??20,u=t.meta?.q??"";e&&n.get(window.location.pathname,{sort:e,direction:a??"desc",per_page:s,q:u},{preserveState:!0,replace:!0})},y=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 00:00:00`:null,h=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 23:59:59`:null,x=()=>{const e=t.meta?.per_page??20,a=t.meta?.sort??"total_output",s=t.meta?.direction??"desc";n.get(window.location.pathname,{date_from:y(l.value||null),date_to:h(i.value||null),q:t.meta?.q??"",sort:a,direction:s,per_page:e},{preserveState:!0,replace:!0})},S=()=>{const e=t.aggregates?.next_page;e&&n.visit(e,{preserveState:!0,replace:!0})},k=()=>{const e=t.aggregates?.prev_page;e&&n.visit(e,{preserveState:!0,replace:!0})};return n.on("start",()=>o.value=!0),n.on("finish",()=>o.value=!1),(e,a)=>(V(),T(G,null,[d(P(C),{title:"Machine Group Aggregates"}),d(q,{breadcrumbs:b},{default:F(()=>[r("div",D,[a[4]||(a[4]=r("h2",{class:"text-2xl font-semibold"},"Machine Group Aggregates",-1)),a[5]||(a[5]=r("p",{class:"text-sm text-muted-foreground"},"Aggregated output/target per machine group (sums across machines)",-1)),r("div",N,[a[2]||(a[2]=r("label",{class:"text-sm"},"From",-1)),c(r("input",{type:"date",class:"input","onUpdate:modelValue":a[0]||(a[0]=s=>l.value=s),disabled:o.value},null,8,$),[[m,l.value]]),a[3]||(a[3]=r("label",{class:"text-sm"},"To",-1)),c(r("input",{type:"date",class:"input","onUpdate:modelValue":a[1]||(a[1]=s=>i.value=s),disabled:o.value},null,8,B),[[m,i.value]]),r("button",{class:"btn",onClick:x,disabled:o.value},"Apply",8,E)]),d(A,{serverMode:"",data:f.value,columns:[{key:"machine_group_name",label:"Machine Group",type:"string",sortable:!0,findable:!0},{key:"production_name",label:"Production",type:"string",sortable:!0,findable:!0},{key:"machine_count",label:"Machines",type:"number",sortable:!0,findable:!1},{key:"total_target",label:"Target",type:"number",sortable:!0,findable:!1},{key:"total_output",label:"Output",type:"number",sortable:!0,findable:!1},{key:"variance",label:"Variance",type:"number",sortable:!1,findable:!1}],"per-page":20,"initial-sort":t.meta?.sort??"total_output","initial-direction":t.meta?.direction??"desc",loading:o.value,onServerSearch:_,onServerSort:v},null,8,["data","initial-sort","initial-direction","loading"]),r("div",U,[r("button",{class:"btn",disabled:!t.aggregates?.prev_page||o.value,onClick:k},"Previous",8,j),r("button",{class:"btn",disabled:!t.aggregates?.next_page||o.value,onClick:S},"Next",8,H)])])]),_:1})],64))}});export{te as default};
