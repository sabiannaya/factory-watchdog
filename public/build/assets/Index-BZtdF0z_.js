import{d as j,f as z,g as f,l as E,k as F,O as M,x as N,B,e as G,w as m,m as l,a as t,u as e,p as O,c as u,b as P,t as o,j as S,o as i,F as y,i as C,z as W,a1 as q,L as U,s as H,q as A}from"./app-i1_2c9TI.js";import{a as J,_ as K}from"./AppLayout.vue_vue_type_script_setup_true_lang-UWREGGXY.js";import{_ as Q,P as X}from"./IconActionButton.vue_vue_type_script_setup_true_lang-Cu3IcDcB.js";import{u as Y,_ as Z,a as ee,b as te,d as L}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B0bB4Y56.js";import{C as ae}from"./chevron-down-C8FjIUWp.js";import"./VisuallyHidden-CgfYLdxu.js";import"./index-C4J_hXM0.js";import"./x-T-BkQ4N0.js";const oe={class:"p-4 space-y-4"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},ne={class:"block text-sm font-medium mb-2"},se={class:"truncate"},de=["onClick"],ie={class:"block text-sm font-medium mb-2"},le={class:"relative"},ue={key:0,class:"text-center py-12 rounded-lg border border-dashed border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/20 dark:bg-muted/20"},ce={class:"text-muted-foreground dark:text-muted-foreground"},me={key:1,class:"space-y-6"},_e={class:"flex justify-between items-start mb-6"},ge={class:"text-xl font-bold"},pe={class:"text-sm text-muted-foreground dark:text-muted-foreground mt-1"},fe={class:"space-y-4"},be={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},he={class:"text-sm font-medium mb-1 capitalize"},ke={class:"text-lg font-semibold"},ve={class:"text-xs text-muted-foreground dark:text-muted-foreground mt-1"},xe={key:0,class:"text-xs text-muted-foreground dark:text-muted-foreground mt-2 italic"},we={class:"pt-3 border-t border-sidebar-border/40"},ye={key:2,class:"text-center py-12 rounded-lg border border-dashed border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/20 dark:bg-muted/20"},Ce={class:"text-muted-foreground dark:text-muted-foreground"},Ie=j({__name:"Index",props:{productions:{},machineGroups:{},selectedProductionId:{},selectedDate:{}},setup(_){const{t:r}=Y(),V=z(()=>[{title:r("data_management.data_management"),href:"/data-management/production"},{title:r("data_management.targets"),href:"/data-management/targets"}]),p=_,c=f(p.selectedProductionId),b=f(null),$=f(0),h=()=>{$.value=b.value?b.value.offsetWidth:0};E(()=>{F(h),window.addEventListener("resize",h)}),M(()=>{window.removeEventListener("resize",h)});const g=f(p.selectedDate),k=f(null),I=()=>{k.value?.focus(),k.value?.click()},R=z(()=>{if(!c.value)return r("data_management.choose_production");const d=p.productions.find(n=>n.production_id===c.value);return d?d.production_name:r("data_management.choose_production")}),D=d=>{c.value=d};N([c,g],([d,n])=>{d&&B.get("/data-management/targets",{production_id:d,date:n},{preserveState:!0,replace:!0})},{immediate:!1});const v=(d,n,a)=>{const s=p.machineGroups?.find(w=>w.production_machine_group_id===d);if(!s)return null;const x=s.daily_values.find(w=>w.field_name===n);return x?a==="target"?x.target_value:x.keterangan:a==="target"?s.default_targets[n]??null:null},T=(d,n)=>p.machineGroups?.find(s=>s.production_machine_group_id===d)?.default_targets[n]??null;return(d,n)=>(i(),G(K,{breadcrumbs:V.value},{default:m(()=>[l(e(O),{title:e(r)("data_management.targets")},null,8,["title"]),t("div",oe,[t("div",re,[t("div",null,[t("label",ne,o(e(r)("data_management.select_production")),1),l(e(Z),{class:"relative w-full"},{default:m(()=>[l(e(ee),{"as-child":!0,style:S({"--reka-dropdown-menu-trigger-width":e($)+"px"})},{default:m(()=>[t("button",{ref_key:"triggerRef",ref:b,type:"button",class:"input w-full flex items-center justify-between"},[t("span",se,o(R.value),1),l(e(ae),{class:"ml-2 size-4"})],512)]),_:1},8,["style"]),l(e(te),{align:"start",sideOffset:4,class:"w-(--reka-dropdown-menu-trigger-width) min-w-[12rem]"},{default:m(()=>[l(e(L),{"as-child":!0},{default:m(()=>[t("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:n[0]||(n[0]=a=>D(null))},o(e(r)("data_management.choose_production")),1)]),_:1}),(i(!0),u(y,null,C(_.productions,a=>(i(),G(e(L),{key:a.production_id,"as-child":!0},{default:m(()=>[t("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:s=>D(a.production_id)},o(a.production_name),9,de)]),_:2},1024))),128))]),_:1})]),_:1})]),t("div",null,[t("label",ie,o(e(r)("data_management.select_date")),1),t("div",le,[W(t("input",{"onUpdate:modelValue":n[1]||(n[1]=a=>q(g)?g.value=a:null),type:"date",class:"input w-full pr-10",ref_key:"dateInputRef",ref:k},null,512),[[U,e(g)]]),t("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",onClick:I,"aria-label":"Open calendar"},[l(e(J),{class:"h-4 w-4"})])])])]),e(c)?_.machineGroups&&_.machineGroups.length>0?(i(),u("div",me,[(i(!0),u(y,null,C(_.machineGroups,a=>(i(),u("div",{key:a.production_machine_group_id,class:"rounded-lg border border-sidebar-border/70 dark:border-sidebar-border/70 bg-card dark:bg-card p-6"},[t("div",_e,[t("div",null,[t("h2",ge,o(a.name),1),t("p",pe,o(a.machine_count)+" "+o(e(r)("data_management.machines")),1)]),l(Q,{icon:e(X),label:"Edit",color:"amber",onClick:()=>e(B).get(`/data-management/targets/${a.production_machine_group_id}/edit`,{date:e(g)})},null,8,["icon","onClick"])]),t("div",fe,[t("div",be,[(i(!0),u(y,null,C(a.fields.filter(s=>s!=="qty"),s=>(i(),u("div",{key:`${a.production_machine_group_id}-target-${s}`,class:"rounded-lg bg-muted/40 dark:bg-muted/40 p-3"},[t("p",he,o(s.replace(/_/g," ")),1),t("p",ke,o(v(a.production_machine_group_id,s,"target")??e(r)("data_management.not_set")),1),t("p",ve,o(e(r)("data_management.default"))+": "+o(T(a.production_machine_group_id,s)??e(r)("data_management.no_default")),1),v(a.production_machine_group_id,s,"keterangan")?(i(),u("p",xe,o(v(a.production_machine_group_id,s,"keterangan")),1)):P("",!0)]))),128))]),t("div",we,[l(e(H),{href:`/input/create?date=${e(g)}&production_id=${e(c)}`,class:"text-sm text-primary hover:underline inline-flex items-center gap-1"},{default:m(()=>[n[2]||(n[2]=t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1)),A(" "+o(e(r)("data_management.record_hourly_output")),1)]),_:1},8,["href"])])])]))),128))])):e(c)&&_.machineGroups?(i(),u("div",ye,[t("p",Ce,o(e(r)("data_management.no_machine_groups_found")),1)])):P("",!0):(i(),u("div",ue,[t("p",ce,o(e(r)("data_management.please_select_production_to_view")),1)]))])]),_:1},8,["breadcrumbs"]))}});export{Ie as default};
