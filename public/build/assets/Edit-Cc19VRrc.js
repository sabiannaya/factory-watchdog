import{d as q,v as D,g as $,f as w,x as G,c as d,m as l,u as s,p as M,w as m,a as o,q as i,y as I,b as u,n as _,o as a,t as p,e as y,F as C,i as E,z as U,A as z,B as O}from"./app-D4NX6RtZ.js";import{S as H,a as T,b as J,c as K,d as N,U as Q,W as j,_ as X}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNNNqqjX.js";import{_ as h}from"./Input.vue_vue_type_script_setup_true_lang-BWEJuRad.js";import{_ as g}from"./Label.vue_vue_type_script_setup_true_lang-DmTMQZ4A.js";import{c as Y}from"./createLucideIcon-A0T1vukc.js";import{E as P}from"./eye-off-CWyqu_bJ.js";import{E as B}from"./eye-YncoTxWj.js";import{C as Z}from"./chevron-down-D-IdcPDr.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BzC2dvNG.js";import"./Presence-CsGVf8pY.js";import"./useForwardPropsEmits-BmzqlngZ.js";import"./x-XD7JAbQb.js";import"./VisuallyHidden-BeURpiPp.js";import"./index-C4J_hXM0.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=Y("UserCogIcon",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),se={class:"p-4"},te={class:"mb-6"},oe={class:"text-2xl font-semibold flex items-center gap-2"},re={class:"rounded-lg border p-4 space-y-4"},ae={class:"space-y-2"},le={key:0,class:"text-sm text-red-500"},de={class:"space-y-2"},ne={key:0,class:"text-sm text-red-500"},ie={class:"rounded-lg border p-4 space-y-4"},ue={class:"space-y-2"},ce={class:"relative"},me={key:0,class:"text-sm text-red-500"},pe={class:"space-y-2"},fe={class:"relative"},_e={class:"rounded-lg border p-4 space-y-4"},ye={class:"font-medium text-lg flex items-center gap-2"},ge={class:"space-y-2"},xe={class:"truncate"},be=["onClick"],ve={key:0,class:"text-sm text-red-500"},he={key:1,class:"mt-2 p-3 rounded-md bg-muted/50 text-sm"},ke={key:0,class:"text-purple-600 dark:text-purple-400"},we={key:1,class:"text-blue-600 dark:text-blue-400"},Ce={key:0,class:"rounded-lg border p-4 space-y-4"},Se={class:"font-medium text-lg flex items-center gap-2"},Ve={key:0,class:"text-sm text-muted-foreground italic"},$e={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-2"},Ee=["checked","onChange"],Ue={class:"text-sm"},ze={key:2,class:"text-sm text-red-500"},Ne={key:1,class:"rounded-lg border p-4 space-y-4"},je={class:"font-medium text-lg flex items-center gap-2"},Pe={class:"flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50"},Be={key:0,class:"text-sm text-red-500"},Re={key:2,class:"rounded-lg border p-4 space-y-4"},Ae={class:"font-medium text-lg flex items-center gap-2"},We={class:"flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50"},Fe={key:0,class:"text-sm text-red-500"},Le={class:"flex items-center justify-end gap-3"},qe=["disabled"],ss=q({__name:"Edit",props:{user:{},roles:{},productions:{},glueSpreaders:{}},setup(f){const c=f,R=[{title:"Admin",href:"/admin/users"},{title:"Users",href:"/admin/users"},{title:"Edit",href:`/admin/users/${c.user.id}/edit`}],t=D({name:c.user.name,email:c.user.email,password:"",password_confirmation:"",role_id:c.user.role_id??"",production_ids:c.user.production_ids??[],can_access_glue_spreaders:c.user.can_access_glue_spreaders??!1,can_access_warehouse:c.user.can_access_warehouse??!1}),x=$(!1),b=$(!1),v=w(()=>t.role_id?c.roles.find(n=>n.role_id===Number(t.role_id)):null),A=w(()=>{if(!t.role_id)return"Select a role";const n=c.roles.find(e=>e.role_id===Number(t.role_id));return n?n.name:"Select a role"}),S=n=>{t.role_id=n},k=w(()=>v.value?.slug==="staff");G(()=>t.role_id,n=>{c.roles.find(r=>r.role_id===Number(n))?.slug==="super"&&(t.production_ids=[])});const W=()=>{t.put(`/admin/users/${c.user.id}`,{preserveScroll:!0})},F=n=>{const e=t.production_ids.indexOf(n);e===-1?t.production_ids.push(n):t.production_ids.splice(e,1)},V=n=>t.production_ids.includes(n);return(n,e)=>(a(),d(C,null,[l(s(M),{title:`Edit User - ${f.user.name}`},null,8,["title"]),l(X,{breadcrumbs:R},{default:m(()=>[o("div",se,[o("div",te,[o("h2",oe,[l(s(ee),{class:"size-6"}),e[10]||(e[10]=i(" Edit User ",-1))]),e[11]||(e[11]=o("p",{class:"text-sm text-muted-foreground"},"Update user information and permissions",-1))]),o("form",{onSubmit:I(W,["prevent"]),class:"space-y-6"},[o("div",re,[e[14]||(e[14]=o("h3",{class:"font-medium text-lg"},"Basic Information",-1)),o("div",ae,[l(s(g),{for:"name"},{default:m(()=>[...e[12]||(e[12]=[i("Name",-1)])]),_:1}),l(s(h),{id:"name",modelValue:s(t).name,"onUpdate:modelValue":e[0]||(e[0]=r=>s(t).name=r),type:"text",placeholder:"Enter full name",class:_({"border-red-500":s(t).errors.name})},null,8,["modelValue","class"]),s(t).errors.name?(a(),d("p",le,p(s(t).errors.name),1)):u("",!0)]),o("div",de,[l(s(g),{for:"email"},{default:m(()=>[...e[13]||(e[13]=[i("Email",-1)])]),_:1}),l(s(h),{id:"email",modelValue:s(t).email,"onUpdate:modelValue":e[1]||(e[1]=r=>s(t).email=r),type:"email",placeholder:"Enter email address",class:_({"border-red-500":s(t).errors.email})},null,8,["modelValue","class"]),s(t).errors.email?(a(),d("p",ne,p(s(t).errors.email),1)):u("",!0)])]),o("div",ie,[e[17]||(e[17]=o("h3",{class:"font-medium text-lg"},"Password",-1)),e[18]||(e[18]=o("p",{class:"text-sm text-muted-foreground"},"Leave blank to keep current password",-1)),o("div",ue,[l(s(g),{for:"password"},{default:m(()=>[...e[15]||(e[15]=[i("New Password",-1)])]),_:1}),o("div",ce,[l(s(h),{id:"password",modelValue:s(t).password,"onUpdate:modelValue":e[2]||(e[2]=r=>s(t).password=r),type:x.value?"text":"password",placeholder:"Enter new password (optional)",class:_(["pr-10",{"border-red-500":s(t).errors.password}])},null,8,["modelValue","type","class"]),o("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:e[3]||(e[3]=r=>x.value=!x.value)},[x.value?(a(),y(s(P),{key:0,class:"size-4"})):(a(),y(s(B),{key:1,class:"size-4"}))])]),s(t).errors.password?(a(),d("p",me,p(s(t).errors.password),1)):u("",!0)]),o("div",pe,[l(s(g),{for:"password_confirmation"},{default:m(()=>[...e[16]||(e[16]=[i("Confirm New Password",-1)])]),_:1}),o("div",fe,[l(s(h),{id:"password_confirmation",modelValue:s(t).password_confirmation,"onUpdate:modelValue":e[4]||(e[4]=r=>s(t).password_confirmation=r),type:b.value?"text":"password",placeholder:"Confirm new password",class:"pr-10"},null,8,["modelValue","type"]),o("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",onClick:e[5]||(e[5]=r=>b.value=!b.value)},[b.value?(a(),y(s(P),{key:0,class:"size-4"})):(a(),y(s(B),{key:1,class:"size-4"}))])])])]),o("div",_e,[o("h3",ye,[l(s(H),{class:"size-5"}),e[19]||(e[19]=i(" Role & Permissions ",-1))]),o("div",ge,[l(s(g),{for:"role"},{default:m(()=>[...e[20]||(e[20]=[i("Role",-1)])]),_:1}),l(s(T),null,{default:m(()=>[l(s(J),{"as-child":!0},{default:m(()=>[o("button",{type:"button",class:_(["input w-full flex items-center justify-between",{"border-red-500":s(t).errors.role_id}])},[o("span",xe,p(A.value),1),l(s(Z),{class:"ml-2 size-4"})],2)]),_:1}),l(s(K),{class:"min-w-[12rem]"},{default:m(()=>[l(s(N),{"as-child":!0},{default:m(()=>[o("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:e[6]||(e[6]=r=>S(""))},"Select a role")]),_:1}),(a(!0),d(C,null,E(f.roles,r=>(a(),y(s(N),{key:r.role_id,"as-child":!0},{default:m(()=>[o("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:L=>S(r.role_id)},p(r.name),9,be)]),_:2},1024))),128))]),_:1})]),_:1}),s(t).errors.role_id?(a(),d("p",ve,p(s(t).errors.role_id),1)):u("",!0),v.value?(a(),d("div",he,[v.value.slug==="super"?(a(),d("p",ke,[...e[21]||(e[21]=[o("strong",null,"Super:",-1),i(" Full access to all features, including user management and deletion of resources. ",-1)])])):v.value.slug==="staff"?(a(),d("p",we,[...e[22]||(e[22]=[o("strong",null,"Staff:",-1),i(" Can only access assigned productions. Can create, read, and update data but cannot delete. ",-1)])])):u("",!0)])):u("",!0)])]),k.value?(a(),d("div",Ce,[o("h3",Se,[l(s(Q),{class:"size-5"}),e[23]||(e[23]=i(" Production Assignments ",-1))]),e[24]||(e[24]=o("p",{class:"text-sm text-muted-foreground"}," Select which productions this user can access. Staff can only see and manage data for their assigned productions. ",-1)),f.productions.length===0?(a(),d("div",Ve," No active productions available. ")):(a(),d("div",$e,[(a(!0),d(C,null,E(f.productions,r=>(a(),d("label",{key:r.production_id,class:_(["flex items-center gap-3 p-3 rounded-md border transition-colors hover:bg-muted/50",{"bg-primary/10 border-primary":V(r.production_id)}])},[o("input",{type:"checkbox",checked:V(r.production_id),onChange:L=>F(r.production_id),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,40,Ee),o("span",Ue,p(r.production_name),1)],2))),128))])),s(t).errors.production_ids?(a(),d("p",ze,p(s(t).errors.production_ids),1)):u("",!0)])):u("",!0),k.value?(a(),d("div",Ne,[o("h3",je,[l(s(j),{class:"size-5"}),e[25]||(e[25]=i(" Glue Spreader Access ",-1))]),e[27]||(e[27]=o("p",{class:"text-sm text-muted-foreground"}," Enable this to allow the staff to see and manage the Glue Spreader menu as a whole. ",-1)),o("label",Pe,[U(o("input",{type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=r=>s(t).can_access_glue_spreaders=r),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[z,s(t).can_access_glue_spreaders]]),e[26]||(e[26]=o("span",{class:"text-sm"},"Can access Glue Spreader menu",-1))]),s(t).errors.can_access_glue_spreaders?(a(),d("p",Be,p(s(t).errors.can_access_glue_spreaders),1)):u("",!0)])):u("",!0),k.value?(a(),d("div",Re,[o("h3",Ae,[l(s(j),{class:"size-5"}),e[28]||(e[28]=i(" Warehouse Access ",-1))]),e[30]||(e[30]=o("p",{class:"text-sm text-muted-foreground"}," Enable this to allow the staff to see and manage the Warehouse menu as a whole. ",-1)),o("label",We,[U(o("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=r=>s(t).can_access_warehouse=r),class:"rounded border-gray-300 text-primary focus:ring-primary"},null,512),[[z,s(t).can_access_warehouse]]),e[29]||(e[29]=o("span",{class:"text-sm"},"Can access Warehouse menu",-1))]),s(t).errors.can_access_warehouse?(a(),d("p",Fe,p(s(t).errors.can_access_warehouse),1)):u("",!0)])):u("",!0),o("div",Le,[o("button",{type:"button",class:"btn-secondary rounded-md px-4 py-2 transition-all duration-150 hover:opacity-90",onClick:e[9]||(e[9]=r=>s(O).get("/admin/users"))}," Cancel "),o("button",{type:"submit",class:"btn rounded-md px-4 py-2 transition-all duration-150 hover:opacity-90 disabled:opacity-50",disabled:s(t).processing},p(s(t).processing?"Saving...":"Save Changes"),9,qe)])],32)])]),_:1})],64))}});export{ss as default};
