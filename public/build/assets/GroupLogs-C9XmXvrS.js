import{d as O,f as y,g as b,B as _,c as m,m as i,u as t,p as Q,w as c,a as o,t as r,q as $,z as q,L as C,o as p,F as k,i as L,e as F}from"./app-i1_2c9TI.js";import{_ as W}from"./AppLayout.vue_vue_type_script_setup_true_lang-UWREGGXY.js";import{_ as X}from"./DataTable.vue_vue_type_script_setup_true_lang-D5Bbd2Ot.js";import{u as Y,_ as j,a as N,b as D,d as T}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B0bB4Y56.js";import{F as Z}from"./file-down-bpwgZGX2.js";import{C as z}from"./chevron-down-C8FjIUWp.js";import"./VisuallyHidden-CgfYLdxu.js";import"./index-C4J_hXM0.js";import"./x-T-BkQ4N0.js";import"./Input.vue_vue_type_script_setup_true_lang-mGQONf2a.js";import"./Spinner.vue_vue_type_script_setup_true_lang-Ca7klY01.js";import"./search-BWjjXBCD.js";const ee={class:"p-4 space-y-4"},te={class:"flex items-center justify-between"},ae={class:"text-2xl font-semibold"},oe={class:"text-sm text-muted-foreground"},se={class:"flex items-center gap-3 mb-3 flex-wrap"},le={class:"flex items-center gap-2"},re={class:"text-sm font-medium"},ne=["disabled"],ie=["disabled"],ue=["onClick"],ce={class:"flex items-center gap-2"},de={class:"text-sm font-medium"},pe=["disabled"],_e=["disabled"],me=["onClick"],fe=["disabled"],ge={key:0,class:"flex flex-col"},be={class:"font-medium"},ve={class:"text-xs text-red-500"},he={key:1,class:"flex flex-col"},xe={class:"font-medium"},ye={class:"text-xs text-muted-foreground"},ke={class:"mt-4 flex items-center justify-end gap-2"},Se=["disabled"],we=["disabled"],Ve=O({__name:"GroupLogs",props:{logs:{},meta:{}},setup(B){const{t:l}=Y(),P=y(()=>[{title:l("logs.title"),href:"/logs"},{title:l("logs.group_logs"),href:"/logs/group"}]),a=B,u=b(!1),f=b(a.meta?.date_from?.split(" ")[0]??""),v=b(a.meta?.date_from?parseInt(a.meta.date_from.split(" ")[1]?.split(":")[0]||"0"):0),g=b(a.meta?.date_to?.split(" ")[0]??""),h=b(a.meta?.date_to?parseInt(a.meta.date_to.split(" ")[1]?.split(":")[0]||"23"):23),V=y(()=>a.logs?.data??[]),x=Array.from({length:24},(e,n)=>({value:n,label:`${n.toString().padStart(2,"0")}:00`})),E=y(()=>x.find(e=>e.value===v.value)?.label??"00:00"),U=y(()=>x.find(e=>e.value===h.value)?.label??"23:00"),H=e=>{v.value=e},I=e=>{h.value=e},M=e=>{const n=a.meta?.per_page??20,s=a.meta?.sort??"recorded_hour",d=a.meta?.direction??"desc";_.get(window.location.pathname,{q:e,per_page:n,sort:s,direction:d,date_from:a.meta?.date_from??null,date_to:a.meta?.date_to??null},{preserveState:!0,replace:!0})},A=({sort:e,direction:n})=>{const s=a.meta?.per_page??20,d=a.meta?.q??"";e&&_.get(window.location.pathname,{sort:e,direction:n??"desc",per_page:s,q:d,date_from:a.meta?.date_from??null,date_to:a.meta?.date_to??null},{preserveState:!0,replace:!0})},S=(e,n)=>e?`${e} ${n.toString().padStart(2,"0")}:00:00`:null,w=(e,n)=>e?`${e} ${n.toString().padStart(2,"0")}:59:59`:null,G=()=>{const e=a.meta?.per_page??20,n=a.meta?.sort??"recorded_hour",s=a.meta?.direction??"desc";_.get(window.location.pathname,{date_from:S(f.value||null,v.value),date_to:w(g.value||null,h.value),q:a.meta?.q??"",sort:n,direction:s,per_page:e},{preserveState:!0,replace:!0})},R=()=>{const e=a.logs?.next_page;e&&_.visit(e,{preserveState:!0,replace:!0})},J=()=>{const e=a.logs?.prev_page;e&&_.visit(e,{preserveState:!0,replace:!0})},K=()=>{const e=new URLSearchParams;f.value&&e.append("date_from",S(f.value,v.value)||""),g.value&&e.append("date_to",w(g.value,h.value)||""),a.meta?.q&&e.append("q",a.meta.q),window.location.href=`/logs/group/export?${e.toString()}`};return _.on("start",()=>u.value=!0),_.on("finish",()=>u.value=!1),(e,n)=>(p(),m(k,null,[i(t(Q),{title:t(l)("logs.group_logs")},null,8,["title"]),i(W,{breadcrumbs:P.value},{default:c(()=>[o("div",ee,[o("div",te,[o("div",null,[o("h2",ae,r(t(l)("logs.group_logs_title")),1),o("p",oe,r(t(l)("logs.group_logs_description")),1)]),o("button",{onClick:K,class:"btn-secondary flex items-center gap-2"},[i(t(Z),{class:"size-4"}),$(" "+r(t(l)("app.export")),1)])]),o("div",se,[o("div",le,[o("label",re,r(t(l)("app.from")),1),q(o("input",{type:"date",class:"input","onUpdate:modelValue":n[0]||(n[0]=s=>f.value=s),disabled:u.value},null,8,ne),[[C,f.value]]),i(t(j),null,{default:c(()=>[i(t(N),{"as-child":!0},{default:c(()=>[o("button",{type:"button",class:"input flex items-center justify-between",disabled:u.value},[o("span",null,r(E.value),1),i(t(z),{class:"ml-2 size-4"})],8,ie)]),_:1}),i(t(D),{class:"min-w-[8rem]"},{default:c(()=>[(p(!0),m(k,null,L(t(x),s=>(p(),F(t(T),{"as-child":!0,key:s.value},{default:c(()=>[o("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:d=>H(s.value)},r(s.label),9,ue)]),_:2},1024))),128))]),_:1})]),_:1})]),o("div",ce,[o("label",de,r(t(l)("app.to")),1),q(o("input",{type:"date",class:"input","onUpdate:modelValue":n[1]||(n[1]=s=>g.value=s),disabled:u.value},null,8,pe),[[C,g.value]]),i(t(j),null,{default:c(()=>[i(t(N),{"as-child":!0},{default:c(()=>[o("button",{type:"button",class:"input flex items-center justify-between",disabled:u.value},[o("span",null,r(U.value),1),i(t(z),{class:"ml-2 size-4"})],8,_e)]),_:1}),i(t(D),{class:"min-w-[8rem]"},{default:c(()=>[(p(!0),m(k,null,L(t(x),s=>(p(),F(t(T),{"as-child":!0,key:s.value},{default:c(()=>[o("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:d=>I(s.value)},r(s.label),9,me)]),_:2},1024))),128))]),_:1})]),_:1})]),o("button",{class:"hover:cursor-pointer btn",onClick:G,disabled:u.value},r(t(l)("app.apply")),9,fe)]),i(X,{serverMode:"",data:V.value,columns:[{key:"recorded_hour",label:t(l)("app.hour"),type:"string",sortable:!0,findable:!1},{key:"production_name",label:t(l)("logs.production"),type:"string",sortable:!0,findable:!0},{key:"machine_group_name",label:t(l)("logs.machine_group"),type:"string",sortable:!0,findable:!0},{key:"total_target",label:t(l)("logs.target_normal"),type:"number",sortable:!0,findable:!1},{key:"total_output",label:t(l)("logs.output_normal"),type:"number",sortable:!0,findable:!1},{key:"variance",label:t(l)("logs.variance"),type:"number",sortable:!1,findable:!1}],"per-page":20,"initial-sort":a.meta?.sort??"recorded_hour","initial-direction":a.meta?.direction??"desc",loading:u.value,onServerSearch:M,onServerSort:A},{cell:c(({row:s,column:d})=>[d.key==="total_output"?(p(),m("div",ge,[o("span",be,r(Number(s.total_output_qty_normal??0).toLocaleString()),1),o("span",ve,r(t(l)("logs.reject"))+": "+r(Number(s.total_output_qty_reject??0).toLocaleString()),1)])):d.key==="total_target"?(p(),m("div",he,[o("span",xe,r(Number(s.total_target_qty_normal??0).toLocaleString()),1),o("span",ye,r(t(l)("logs.reject"))+": "+r(Number(s.total_target_qty_reject??0).toLocaleString()),1)])):(p(),m(k,{key:2},[$(r(s[d.key]),1)],64))]),_:1},8,["data","columns","initial-sort","initial-direction","loading"]),o("div",ke,[o("button",{class:"hover:cursor-pointer btn",disabled:!a.logs?.prev_page||u.value,onClick:J},r(t(l)("app.previous")),9,Se),o("button",{class:"hover:cursor-pointer btn",disabled:!a.logs?.next_page||u.value,onClick:R},r(t(l)("app.next")),9,we)])])]),_:1},8,["breadcrumbs"])],64))}});export{Ve as default};
