import{U as M,S as A,_ as G}from"./AppLayout.vue_vue_type_script_setup_true_lang-UWREGGXY.js";import{d as H,f as x,g,x as J,l as K,B as u,c as d,m as r,u as e,p as O,w as f,a as s,q as b,t as o,o as n,F as v,i as T,e as y,b as k,n as Q}from"./app-i1_2c9TI.js";import{u as W,_ as X,a as Y,b as Z,d as V}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B0bB4Y56.js";import{_ as w,P as ee}from"./IconActionButton.vue_vue_type_script_setup_true_lang-Cu3IcDcB.js";import{_ as se}from"./Input.vue_vue_type_script_setup_true_lang-mGQONf2a.js";import{_ as te}from"./Spinner.vue_vue_type_script_setup_true_lang-Ca7klY01.js";import{_ as oe}from"./ToastNotifications.vue_vue_type_script_setup_true_lang-mcyszUyt.js";import{u as le}from"./useToast-C_zToptU.js";import{U as ae}from"./user-plus-Bq_T1ISt.js";import{C as re}from"./chevron-down-C8FjIUWp.js";import{E as ne}from"./eye-zQDYR7PF.js";import{T as ie}from"./trash-2-D_kG-H42.js";import"./VisuallyHidden-CgfYLdxu.js";import"./index-C4J_hXM0.js";import"./x-T-BkQ4N0.js";const ue={class:"p-4"},de={class:"flex items-center justify-between"},ce={class:"text-2xl font-semibold flex items-center gap-2"},me={class:"text-sm text-muted-foreground"},_e={class:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},pe={class:"block text-sm font-medium mb-2"},fe={type:"button",class:"input w-full flex items-center justify-between"},xe={class:"truncate"},he=["onClick"],ge={class:"block text-sm font-medium mb-2"},be={class:"relative"},ve={class:"mt-4"},ye={class:"overflow-x-auto rounded-lg border"},ke={class:"w-full table-auto border-collapse"},we={class:"bg-muted/50"},Ce={class:"text-left"},$e={class:"px-4 py-3 text-sm font-medium"},Se={class:"px-4 py-3 text-sm font-medium"},Te={class:"px-4 py-3 text-sm font-medium"},Ve={class:"px-4 py-3 text-sm font-medium"},qe={class:"px-4 py-3 text-sm font-medium"},ze={class:"px-4 py-3 text-sm font-medium"},Be={class:"px-4 py-3 text-sm font-medium"},De={class:"px-4 py-3 text-sm font-medium"},Pe={class:"px-4 py-3 text-sm text-muted-foreground"},Ne={class:"px-4 py-3 text-sm"},Re={class:"px-4 py-3 text-sm"},Ue={key:0,class:"text-muted-foreground italic"},Ee={key:1},je={class:"px-4 py-3 text-sm"},Le={key:0,class:"text-muted-foreground italic"},Fe={key:1,class:"text-muted-foreground italic"},Ie={class:"px-4 py-3 text-sm text-muted-foreground"},Me={class:"px-4 py-3 text-sm"},Ae={class:"flex items-center gap-3"},Ge={key:0},He={colspan:"7",class:"px-4 py-8 text-center text-sm text-muted-foreground"},Je={class:"mt-4 flex items-center justify-end gap-2"},Ke=["disabled"],Oe=["disabled"],cs=H({__name:"Index",props:{users:{},roles:{},meta:{}},setup(q){const{t}=W(),z=x(()=>[{title:t("users.admin"),href:"/admin/users"},{title:t("users.users"),href:"/admin/users"}]),p=g(!1),{toasts:B,dismiss:D}=le(),i=q,C=x(()=>i.users?.data??[]),$=x(()=>i.roles??[]),m=g(i.meta?.q??""),_=g(i.meta?.role_id??"");let h;const P=x(()=>{if(!_.value)return t("users.all_roles");const l=$.value.find(c=>String(c.role_id)===String(_.value));return l?l.name:t("users.all_roles")}),S=l=>{_.value=l||"",R()},N=()=>{const l=i.meta?.per_page??10;u.get("/admin/users",{q:m.value||null,role_id:_.value||null,per_page:l},{preserveState:!0,replace:!0})},R=()=>{const l=i.meta?.per_page??10;u.get("/admin/users",{q:m.value||null,role_id:_.value||null,per_page:l},{preserveState:!0,replace:!0})};J(m,()=>{h&&clearTimeout(h),h=setTimeout(N,500)});const U=()=>{const l=i.users?.next_cursor;l&&u.get("/admin/users",{cursor:l,role_id:_.value||null,q:m.value||null},{preserveState:!0,replace:!0})},E=()=>{const l=i.users?.prev_cursor;l&&u.get("/admin/users",{cursor:l,role_id:_.value||null,q:m.value||null},{preserveState:!0,replace:!0})},j=l=>u.get(`/admin/users/${l}`),L=l=>u.get(`/admin/users/${l}/edit`),F=l=>{window.confirm(t("users.confirm_delete"))&&u.delete(`/admin/users/${l}`,{preserveState:!1})};K(()=>{u.on("start",()=>p.value=!0),u.on("finish",()=>p.value=!1)});const I=l=>l==="super"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":l==="staff"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";return(l,c)=>(n(),d(v,null,[r(e(O),{title:e(t)("users.management")},null,8,["title"]),r(oe,{toasts:e(B),onDismiss:e(D)},null,8,["toasts","onDismiss"]),r(G,{breadcrumbs:z.value},{default:f(()=>[s("div",ue,[s("div",de,[s("div",null,[s("h2",ce,[r(e(M),{class:"size-6"}),b(" "+o(e(t)("users.management")),1)]),s("p",me,o(e(t)("users.management_description")),1)]),s("button",{onClick:c[0]||(c[0]=a=>e(u).get("/admin/users/create")),class:"btn flex items-center gap-2 rounded-md shadow-sm transition-all duration-150 hover:opacity-90 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black/10 dark:focus:ring-white/20"},[r(e(ae),{class:"size-4"}),b(" "+o(e(t)("users.add_user")),1)])]),s("div",_e,[s("div",null,[s("label",pe,o(e(t)("users.role_filter")),1),r(e(X),null,{default:f(()=>[r(e(Y),{"as-child":!0},{default:f(()=>[s("button",fe,[s("span",xe,o(P.value),1),r(e(re),{class:"ml-2 size-4"})])]),_:1}),r(e(Z),{class:"min-w-[12rem]"},{default:f(()=>[r(e(V),{"as-child":!0},{default:f(()=>[s("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:c[1]||(c[1]=a=>S(""))},o(e(t)("users.all_roles")),1)]),_:1}),(n(!0),d(v,null,T($.value,a=>(n(),y(e(V),{key:a.role_id,"as-child":!0},{default:f(()=>[s("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:Qe=>S(a.role_id)},o(a.name),9,he)]),_:2},1024))),128))]),_:1})]),_:1})]),s("div",null,[s("label",ge,o(e(t)("users.search")),1),s("div",be,[r(e(se),{modelValue:m.value,"onUpdate:modelValue":c[2]||(c[2]=a=>m.value=a),disabled:p.value,type:"search",placeholder:e(t)("users.search_placeholder"),class:"w-full"},null,8,["modelValue","disabled","placeholder"]),p.value?(n(),y(e(te),{key:0,class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground"})):k("",!0)])])]),s("div",ve,[s("div",ye,[s("table",ke,[s("thead",we,[s("tr",Ce,[s("th",$e,o(e(t)("users.name")),1),s("th",Se,o(e(t)("users.email")),1),s("th",Te,o(e(t)("users.role")),1),s("th",Ve,o(e(t)("users.assigned_productions")),1),s("th",qe,o(e(t)("users.glue_spreaders")),1),s("th",ze,o(e(t)("users.created")),1),s("th",Be,o(e(t)("users.actions")),1)])]),s("tbody",null,[(n(!0),d(v,null,T(C.value,a=>(n(),d("tr",{key:a.id,class:"border-t hover:bg-muted/30 transition-colors"},[s("td",De,o(a.name),1),s("td",Pe,o(a.email),1),s("td",Ne,[s("span",{class:Q(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",I(a.role_slug)])},[a.role_slug==="super"?(n(),y(e(A),{key:0,class:"size-3"})):k("",!0),b(" "+o(a.role_name),1)],2)]),s("td",Re,[a.role_slug==="super"?(n(),d("span",Ue,o(e(t)("users.all")),1)):(n(),d("span",Ee,o(e(t)("users.production_count",{count:a.productions_count})),1))]),s("td",je,[a.role_slug==="super"?(n(),d("span",Le,o(e(t)("users.all")),1)):(n(),d("span",Fe,o(e(t)("users.all")),1))]),s("td",Ie,o(a.created_at),1),s("td",Me,[s("div",Ae,[r(w,{icon:e(ne),label:e(t)("users.view"),color:"blue",onClick:()=>j(a.id)},null,8,["icon","label","onClick"]),r(w,{icon:e(ee),label:e(t)("users.edit"),color:"amber",onClick:()=>L(a.id)},null,8,["icon","label","onClick"]),r(w,{icon:e(ie),label:e(t)("users.delete"),color:"red",onClick:()=>F(a.id)},null,8,["icon","label","onClick"])])])]))),128)),C.value.length===0?(n(),d("tr",Ge,[s("td",He,o(e(t)("users.no_users")),1)])):k("",!0)])])]),s("div",Je,[s("button",{class:"btn-secondary rounded-md px-4 py-2 text-sm transition-all duration-150 hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!i.users?.prev_cursor||p.value,onClick:E},o(e(t)("users.previous")),9,Ke),s("button",{class:"btn-secondary rounded-md px-4 py-2 text-sm transition-all duration-150 hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!i.users?.next_cursor||p.value,onClick:U},o(e(t)("users.next")),9,Oe)])])])]),_:1},8,["breadcrumbs"])],64))}});export{cs as default};
