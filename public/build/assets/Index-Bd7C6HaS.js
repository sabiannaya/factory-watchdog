import{d as he,g as c,f as S,x as O,B as m,l as xe,k as ye,O as be,c as v,m as n,u as o,p as ke,w as u,a as l,e as E,b as P,q as $,o as r,t as d,z as F,F as C,i as T,M as Se,s as $e,L as we,j as Q,n as Ce,af as De}from"./app-BRuhaguS.js";import{a as Pe,b as Te,c as ze,d as W,_ as Ie}from"./AppLayout.vue_vue_type_script_setup_true_lang-BSta2Xg1.js";import{_ as qe,a as Ee,b as Ve,c as Me,d as Ne,e as je,f as Re}from"./AlertDialogTitle.vue_vue_type_script_setup_true_lang-BijpPN58.js";import{_ as Le}from"./AlertDialogFooter.vue_vue_type_script_setup_true_lang-BXNbaV3g.js";import{_ as V,P as Ue}from"./IconActionButton.vue_vue_type_script_setup_true_lang-DuEfKw9g.js";import{_ as Be}from"./Input.vue_vue_type_script_setup_true_lang-Bolxw2JV.js";import{_ as He}from"./Spinner.vue_vue_type_script_setup_true_lang-BLCXa5KB.js";import{_ as Ae}from"./ToastNotifications.vue_vue_type_script_setup_true_lang-DCB_gM99.js";import{u as Oe}from"./useToast-Cyrz-AlH.js";import{F as Fe}from"./file-down-D61wkUlP.js";import{T as G}from"./trash-2-D_TNeSzz.js";import{c as Qe}from"./createLucideIcon-Bc86gjbu.js";import{C as We}from"./chevron-down-Bi0ueEnd.js";import{S as Ge}from"./search-DqEYQ3zn.js";import{E as Je}from"./eye-DwXBrb9R.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DrUmFdxY.js";import"./Presence-CRPloLVK.js";import"./useForwardPropsEmits-CxMGla6T.js";import"./x-Dz_x2_zF.js";import"./VisuallyHidden-gDrgz296.js";import"./index-C4J_hXM0.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=Qe("PlusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Xe={class:"p-4"},Ye={class:"flex items-center justify-between"},Ze={class:"flex gap-2"},et={class:"flex items-center"},tt=["value"],lt={class:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-4"},st={class:"truncate"},ot=["onClick"],nt={class:"relative"},at={class:"mt-4"},ut={class:"overflow-x-auto"},rt={class:"w-full table-auto border-collapse"},it={class:"text-left"},dt={class:"px-3 py-2 text-sm font-medium w-12"},pt=["checked","indeterminate"],ct={class:"px-3 py-2 text-sm"},mt=["checked","onChange"],vt={class:"px-3 py-2 text-sm font-mono"},ft={class:"px-3 py-2 text-sm"},gt={class:"px-3 py-2 text-sm"},_t={class:"px-3 py-2 text-sm font-semibold"},ht={class:"px-3 py-2 text-sm"},xt={class:"px-3 py-2 text-sm"},yt={class:"px-3 py-2 text-sm"},bt={class:"flex items-center gap-4"},kt={key:0},St={class:"mt-4 flex items-center justify-end gap-2"},$t=["disabled"],wt=["disabled","onClick"],Ct={key:1,class:"px-3 text-sm text-muted-foreground"},Dt=["disabled"],Jt=he({__name:"Index",props:{hourlyInputs:{},productions:{},meta:{}},setup(J){const K=[{title:"Input",href:"/input"},{title:"Hourly Input",href:"/input"}],y=c(!1),{toasts:X,dismiss:Y,success:M,error:N}=Oe(),g=J,b=S(()=>g.hourlyInputs?.data??[]),j=S(()=>g.productions??[]),p=c(g.meta?.q??""),f=c(g.meta?.date??new Date().toISOString().split("T")[0]),i=c(g.meta?.production_id??""),Z=[10,20,50,100],_=c(g.meta?.per_page??20),a=c(new Set),w=c(!1),h=c(null);let z;c(null);const ee=c(!1),R=c({left:0,top:0});O([f,i],([s,e])=>{m.get("/input",{date:s,production_id:e||null,q:p.value||null,per_page:_.value,page:1},{preserveState:!0,replace:!0})});const L=()=>{m.get("/input",{q:p.value||null,date:f.value,production_id:i.value||null,per_page:_.value,page:1},{preserveState:!0,replace:!0})},te=s=>{m.get("/input",{q:p.value||null,date:f.value,production_id:i.value||null,per_page:_.value,page:1},{preserveState:!0,replace:!0})},le=S(()=>{if(!i.value)return"All Productions";const s=j.value.find(e=>String(e.production_id)===String(i.value));return s?s.production_name:"All Productions"}),U=s=>{i.value=s||"",L()},I=c(null),B=c(0),q=()=>{B.value=I.value?I.value.offsetWidth:0};xe(()=>{ye(q),window.addEventListener("resize",q)}),be(()=>{window.removeEventListener("resize",q)}),O(p,()=>{z&&clearTimeout(z),z=setTimeout(L,800)});const se=()=>{const s=g.hourlyInputs?.pagination,e=s?.current_page??1,t=s?.last_page??1;e>=t||m.get("/input",{page:e+1,date:f.value,production_id:i.value||null,q:p.value||null},{preserveState:!0})},oe=()=>{const e=g.hourlyInputs?.pagination?.current_page??1;e<=1||m.get("/input",{page:e-1,date:f.value,production_id:i.value||null,q:p.value||null},{preserveState:!0})},x=S(()=>{const s=g.hourlyInputs?.pagination??null;return{current_page:s?.current_page??1,last_page:s?.last_page??1,per_page:s?.per_page??_.value}}),ne=S(()=>{const s=x.value.current_page??1,e=x.value.last_page??1,t=[];if(e<=7){for(let k=1;k<=e;k++)t.push(k);return t}t.push(1);const D=Math.max(2,s-2),A=Math.min(e-1,s+2);D>2&&t.push("...");for(let k=D;k<=A;k++)t.push(k);return A<e-1&&t.push("..."),t.push(e),t}),ae=s=>{const e=x.value.current_page??1;s!==e&&m.get("/input",{page:s,date:f.value,production_id:i.value||null,q:p.value||null,per_page:_.value},{preserveState:!0})},ue=s=>m.get(`/input/${s}`),re=s=>m.get(`/input/${s}/edit`),H=()=>{const e=g.hourlyInputs?.pagination?.current_page??1,t=new URLSearchParams;return t.append("date",f.value),i.value&&t.append("production_id",String(i.value)),p.value&&t.append("q",p.value),t.append("page",String(e)),t.append("per_page",String(_.value)),t.toString()},ie=s=>{h.value=s,w.value=!0},de=()=>{if(!h.value)return;const s=H();m.delete(`/input/${h.value}?${s}`,{preserveState:!0,onSuccess:()=>{M("Deleted","Hourly input deleted successfully.")},onError:e=>{const t=e?.response?.data?.message??"Unable to delete hourly input.";N("Delete failed",t)}}),w.value=!1,h.value=null},pe=s=>{a.value.has(s)?a.value.delete(s):a.value.add(s)},ce=()=>{a.value.size===b.value.length?a.value.clear():b.value.forEach(s=>a.value.add(s.hourly_log_id))},me=S(()=>b.value.length>0&&a.value.size===b.value.length),ve=S(()=>a.value.size>0&&a.value.size<b.value.length),fe=()=>{a.value.size!==0&&(h.value=null,w.value=!0)},ge=()=>{const s=Array.from(a.value),e=H();m.post(`/input/bulk-delete?${e}`,{ids:s},{preserveState:!0,onSuccess:()=>{a.value.clear(),w.value=!1,M("Deleted",`${s.length} hourly inputs deleted.`)},onError:t=>{const D=t?.response?.data?.message??"Unable to delete hourly inputs.";N("Delete failed",D)}})},_e=()=>{const s=new URLSearchParams;s.append("date",f.value),i.value&&s.append("production_id",String(i.value)),p.value&&s.append("q",p.value),window.location.href=`/input/export?${s.toString()}`};return m.on("start",()=>y.value=!0),m.on("finish",()=>y.value=!1),(s,e)=>(r(),v(C,null,[n(o(ke),{title:"Hourly Input"}),n(Ae,{toasts:o(X),onDismiss:o(Y)},null,8,["toasts","onDismiss"]),n(Ie,{breadcrumbs:K},{default:u(()=>[l("div",Xe,[l("div",Ye,[e[10]||(e[10]=l("div",null,[l("h2",{class:"text-2xl font-semibold"},"Hourly Input"),l("p",{class:"text-sm text-muted-foreground"},"Record and manage hourly production output")],-1)),l("div",Ze,[l("button",{onClick:_e,class:"btn-secondary flex items-center gap-2"},[n(o(Fe),{class:"size-4"}),e[7]||(e[7]=$(" Export to Excel ",-1))]),a.value.size>0?(r(),v("button",{key:0,onClick:fe,class:"btn-secondary flex items-center gap-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-950"},[n(o(G),{class:"size-4"}),$(" Delete "+d(a.value.size)+" Selected ",1)])):P("",!0),l("div",et,[e[8]||(e[8]=l("label",{class:"text-sm mr-2"},"Per page",-1)),F(l("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t),onChange:e[1]||(e[1]=t=>te(void 0)),class:"input w-24"},[(r(),v(C,null,T(Z,t=>l("option",{key:t,value:t},d(t),9,tt)),64))],544),[[Se,_.value,void 0,{number:!0}]])]),n(o($e),{href:`/input/create?date=${f.value}&production_id=${i.value||""}`,class:"btn flex items-center gap-2 rounded-md shadow-sm transition-colors transition-shadow duration-150 hover:opacity-90 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black/10 dark:focus:ring-white/20"},{default:u(()=>[n(o(Ke),{class:"size-4"}),e[9]||(e[9]=$(" Record Input ",-1))]),_:1},8,["href"])])]),l("div",lt,[l("div",null,[e[11]||(e[11]=l("label",{class:"block text-sm font-medium mb-2"},"Date",-1)),F(l("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>f.value=t),type:"date",class:"input w-full"},null,512),[[we,f.value]])]),l("div",null,[e[12]||(e[12]=l("label",{class:"block text-sm font-medium mb-2"},"Production",-1)),n(o(Pe),null,{default:u(()=>[n(o(Te),{"as-child":!0,style:Q({"--reka-dropdown-menu-trigger-width":B.value+"px"})},{default:u(()=>[l("button",{ref_key:"triggerRef",ref:I,type:"button",class:"input w-full flex items-center justify-between"},[l("span",st,d(le.value),1),n(o(We),{class:"ml-2 pr-1 size-4"})],512)]),_:1},8,["style"]),n(o(ze),{align:"start",sideOffset:4,class:"w-(--reka-dropdown-menu-trigger-width) min-w-[12rem]"},{default:u(()=>[n(o(W),{"as-child":!0},{default:u(()=>[l("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:e[3]||(e[3]=t=>U(""))},"All Productions")]),_:1}),(r(!0),v(C,null,T(j.value,t=>(r(),E(o(W),{key:t.production_id,"as-child":!0},{default:u(()=>[l("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:D=>U(t.production_id)},d(t.production_name),9,ot)]),_:2},1024))),128))]),_:1})]),_:1})]),l("div",null,[e[13]||(e[13]=l("label",{class:"block text-sm font-medium mb-2"},"Search",-1)),l("div",nt,[n(o(Ge),{class:"absolute left-2 top-1/2 size-4 -translate-y-1/2 text-muted-foreground"}),n(o(Be),{modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=t=>p.value=t),disabled:y.value,type:"search",placeholder:"Search...",class:"pl-8"},null,8,["modelValue","disabled"]),y.value?(r(),E(o(He),{key:0,class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground"})):P("",!0)])])]),l("div",at,[l("div",ut,[l("table",rt,[l("thead",null,[l("tr",it,[l("th",dt,[l("input",{type:"checkbox",checked:me.value,indeterminate:ve.value,onChange:ce},null,40,pt)]),e[14]||(e[14]=l("th",{class:"px-3 py-2 text-sm font-medium"},"Hour",-1)),e[15]||(e[15]=l("th",{class:"px-3 py-2 text-sm font-medium"},"Production",-1)),e[16]||(e[16]=l("th",{class:"px-3 py-2 text-sm font-medium"},"Machine Group",-1)),e[17]||(e[17]=l("th",{class:"px-3 py-2 text-sm font-medium"},"Total Qty",-1)),e[18]||(e[18]=l("th",{class:"px-3 py-2 text-sm font-medium"},"Qty Normal",-1)),e[19]||(e[19]=l("th",{class:"px-3 py-2 text-sm font-medium"},"Qty Reject",-1)),e[20]||(e[20]=l("th",{class:"px-3 py-2 text-sm font-medium"},"Actions",-1))])]),l("tbody",null,[(r(!0),v(C,null,T(b.value,t=>(r(),v("tr",{key:t.hourly_log_id,class:"border-t"},[l("td",ct,[l("input",{type:"checkbox",checked:a.value.has(t.hourly_log_id),onChange:()=>pe(t.hourly_log_id)},null,40,mt)]),l("td",vt,d(t.hour),1),l("td",ft,d(t.production_name),1),l("td",gt,d(t.machine_group),1),l("td",_t,d((t.output_qty_normal??0)+(t.output_qty_reject??0)),1),l("td",ht,d(t.output_qty_normal!==null?t.output_qty_normal:"-"),1),l("td",xt,d(t.output_qty_reject!==null?t.output_qty_reject:"-"),1),l("td",yt,[l("div",bt,[n(V,{icon:o(Je),label:"Detail",color:"blue",onClick:()=>ue(t.hourly_log_id)},null,8,["icon","onClick"]),n(V,{icon:o(Ue),label:"Edit",color:"amber",onClick:()=>re(t.hourly_log_id)},null,8,["icon","onClick"]),n(V,{icon:o(G),label:"Delete",color:"red",onClick:()=>ie(t.hourly_log_id)},null,8,["icon","onClick"])])])]))),128)),b.value.length===0?(r(),v("tr",kt,[...e[21]||(e[21]=[l("td",{colspan:"8",class:"px-3 py-8 text-center text-sm text-muted-foreground"},' No hourly inputs recorded for this date. Click "Record Input" to add one. ',-1)])])):P("",!0)])])]),l("div",St,[l("button",{class:"hover:cursor-pointer btn",disabled:x.value.current_page<=1||y.value,onClick:oe},"Previous",8,$t),(r(!0),v(C,null,T(ne.value,t=>(r(),v(C,{key:typeof t=="number"?`p-${t}`:`e-${Math.random()}`},[typeof t=="number"?(r(),v("button",{key:0,class:Ce(["hover:cursor-pointer btn",{"opacity-90 ring-2 ring-offset-2 ring-black/10":t===x.value.current_page}]),disabled:t===x.value.current_page||y.value,onClick:()=>ae(Number(t))},d(t),11,wt)):(r(),v("span",Ct,d(t),1))],64))),128)),l("button",{class:"hover:cursor-pointer btn",disabled:x.value.current_page>=x.value.last_page||y.value,onClick:se},"Next",8,Dt)])])]),n(o(qe),{open:w.value,"onUpdate:open":e[6]||(e[6]=t=>w.value=t)},{default:u(()=>[n(o(Ee),null,{default:u(()=>[n(o(Ve),null,{default:u(()=>[n(o(Me),null,{default:u(()=>[$(d(h.value?"Delete Hourly Input?":`Delete ${a.value.size} Selected Items?`),1)]),_:1}),n(o(Ne),null,{default:u(()=>[$(d(h.value?"This action cannot be undone. This will permanently delete this hourly input record.":`This action cannot be undone. This will permanently delete ${a.value.size} hourly input records.`),1)]),_:1})]),_:1}),n(o(Le),null,{default:u(()=>[n(o(je),null,{default:u(()=>[...e[22]||(e[22]=[$("Cancel",-1)])]),_:1}),n(o(Re),{class:"bg-red-600 hover:bg-red-700 text-white",onClick:e[5]||(e[5]=t=>h.value?de():ge())},{default:u(()=>[...e[23]||(e[23]=[$(" Delete ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),(r(),E(De,{to:"body"},[ee.value?(r(),v("div",{key:0,style:Q({left:R.value.left+"px",top:R.value.top+"px",position:"fixed",zIndex:9999})},[...e[24]||(e[24]=[l("div",{class:"rounded-md bg-white dark:bg-zinc-900 border shadow-md p-3 text-xs text-muted-foreground w-72"},[l("div",{class:"font-medium mb-1"},"How Variance is Calculated"),l("div",null,"Variance = (Normal Output - Normal Target) + (Target Reject - Reject Output)"),l("div",{class:"text-2xs text-muted-foreground mt-1"},"Positive variance means output is better than target.")],-1)])],4)):P("",!0)]))]),_:1})],64))}});export{Jt as default};
