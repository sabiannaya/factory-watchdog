import{d as I,e as P,w as d,J as V,E as A,G as H,u as s,o as m,f as v,g as k,c as y,m as n,p as O,a as t,t as e,q as f,z as U,L as W,y as L,F as S,i as T,b as G,n as w,B as $,k as J}from"./app-i1_2c9TI.js";import{T as K,b as Q,c as X,d as Y,_ as Z}from"./AppLayout.vue_vue_type_script_setup_true_lang-UWREGGXY.js";import{c as tt,u as et,_ as at,a as st,b as ot,d as B}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B0bB4Y56.js";import{F as rt}from"./file-down-bpwgZGX2.js";import"./VisuallyHidden-CgfYLdxu.js";import"./index-C4J_hXM0.js";import"./x-T-BkQ4N0.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=tt("InfoIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),nt=I({__name:"TooltipProvider",props:{delayDuration:{default:0},skipDelayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},setup(x){const o=x;return(i,j)=>(m(),P(s(K),A(H(o)),{default:d(()=>[V(i.$slots,"default")]),_:3},16))}}),dt={class:"p-4 space-y-6"},it={class:"flex items-start justify-between"},ct={class:"text-2xl font-bold"},ut={class:"text-muted-foreground"},mt={class:"rounded-lg border border-sidebar-border/70 bg-card p-4"},_t={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pt={class:"space-y-2"},yt={class:"text-sm font-medium"},gt={class:"flex items-center gap-2"},ft={class:"space-y-2"},xt={class:"text-sm font-medium"},ht={key:0},bt={key:1},vt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},kt={class:"rounded-lg border border-sidebar-border/70 bg-card p-4"},St={class:"text-sm text-muted-foreground"},jt={class:"text-2xl font-bold"},qt={class:"text-xs text-muted-foreground mt-1"},Ct={class:"rounded-lg border border-sidebar-border/70 bg-card p-4"},Dt={class:"text-sm text-muted-foreground"},Nt={class:"text-2xl font-bold"},Lt={class:"rounded-lg border border-sidebar-border/70 bg-card overflow-hidden"},Tt={class:"overflow-x-auto"},wt={class:"w-full"},$t={class:"bg-muted/50 border-b border-sidebar-border/70"},Bt={class:"px-4 py-3 text-left text-sm font-medium"},It={class:"px-4 py-3 text-left text-sm font-medium"},Pt={class:"px-4 py-3 text-right text-sm font-medium"},zt={class:"px-4 py-3 text-right text-sm font-medium"},Mt={class:"px-4 py-3 text-right text-sm font-medium"},Rt={class:"px-4 py-3 text-right text-sm font-medium"},Et={class:"px-4 py-3 text-right text-sm font-medium"},Ft={class:"inline-flex items-center gap-1 cursor-help select-none"},Vt={class:"font-semibold mb-1"},At={class:"px-4 py-3 text-center text-sm font-medium"},Ht={class:"px-4 py-3 text-sm"},Ot={class:"px-4 py-3 text-sm"},Ut={class:"px-4 py-3 text-sm text-right font-medium"},Wt={class:"px-4 py-3 text-sm text-right text-red-600"},Gt={class:"px-4 py-3 text-sm text-right font-medium"},Jt={class:"px-4 py-3 text-sm text-right text-red-600"},Kt={class:"px-4 py-3 text-sm text-right"},Qt={class:"px-4 py-3 text-center"},Xt={key:0},Yt={colspan:"8",class:"px-4 py-8 text-center text-sm text-muted-foreground"},le=I({__name:"DailySummary",props:{date:{},productions:{},selectedProductionId:{},summaryData:{}},setup(x){const{t:o}=et(),i=x,j=v(()=>[{title:o("summary.title"),href:"/summary/daily"},{title:o("summary.daily_summary"),href:window.location.pathname}]),u=k(i.date),c=k(i.selectedProductionId?i.selectedProductionId.toString():"all"),h=()=>{const r={date:u.value};c.value!=="all"&&(r.production_id=c.value),$.get("/summary/daily",r,{preserveState:!1})},q=()=>{const r={date:u.value};c.value!=="all"&&(r.production_id=c.value),$.get("/summary/daily",r,{preserveState:!1})},z=()=>{const r=new Date(u.value);r.setDate(r.getDate()-1),u.value=r.toISOString().split("T")[0],h()},M=()=>{const r=new Date(u.value);r.setDate(r.getDate()+1),u.value=r.toISOString().split("T")[0],h()},C=k(null),D=async()=>{await J(),setTimeout(()=>{const r=C.value;if(!r)return;const l=Array.from(document.querySelectorAll("body *")).filter(_=>{if(!(_ instanceof HTMLElement))return!1;const g=_.getBoundingClientRect();return g.width===0&&g.height===0?!1:(_.innerText||"").trim().includes("All Productions")});if(l.length===0)return;const a=l[l.length-1];a.style.width=`${r.offsetWidth}px`},50)};window.addEventListener("resize",()=>{D()});const R=()=>{const r=new URLSearchParams;r.append("date",u.value),c.value!=="all"&&r.append("production_id",c.value),window.location.href=`/summary/daily/export?${r.toString()}`},p=v(()=>i.summaryData.reduce((r,l)=>{const a=Number(l.target_qty_normal??0),_=Number(l.target_qty_reject??0),g=a+_,b=Number(l.actual_qty_normal??0),N=Number(l.actual_qty_reject??0),E=Number(l.actual_total??b+N),F=b-a+(_-N);return{target_total:r.target_total+g,target_normal:r.target_normal+a,target_reject:r.target_reject+_,actual_total:r.actual_total+E,variance:r.variance+F}},{target_total:0,target_normal:0,target_reject:0,actual_total:0,variance:0}));return v(()=>p.value.target_total>0?Math.round(p.value.actual_total/p.value.target_total*100*10)/10:0),(r,l)=>(m(),y(S,null,[n(s(O),{title:s(o)("summary.daily_summary")},null,8,["title"]),n(Z,{breadcrumbs:j.value},{default:d(()=>[t("div",dt,[t("div",it,[t("div",null,[t("h1",ct,e(s(o)("summary.daily_summary")),1),t("p",ut,e(s(o)("summary.daily_summary_description")),1)]),t("button",{onClick:R,class:"btn-secondary flex items-center gap-2"},[n(s(rt),{class:"size-4"}),f(" "+e(s(o)("app.export")),1)])]),t("div",mt,[t("div",_t,[t("div",pt,[t("label",yt,e(s(o)("app.date")),1),t("div",gt,[t("button",{onClick:z,class:"px-3 py-2 rounded-md border border-input hover:bg-muted transition"}," ‹ "),U(t("input",{type:"date","onUpdate:modelValue":l[0]||(l[0]=a=>u.value=a),onChange:h,class:"input flex-1 ml-2 date-input"},null,544),[[W,u.value]]),t("button",{onClick:M,class:"px-3 py-2 rounded-md border border-input hover:bg-muted transition"}," › ")])]),t("div",ft,[t("label",xt,e(s(o)("summary.production")),1),n(s(at),null,{default:d(()=>[n(s(st),{asChild:""},{default:d(()=>[t("button",{ref_key:"triggerRef",ref:C,onClick:D,class:"input w-full text-left flex items-center justify-between"},[c.value==="all"?(m(),y("span",ht,e(s(o)("summary.all_productions")),1)):(m(),y("span",bt,e(i.productions.find(a=>a.production_id.toString()===c.value)?.production_name),1)),l[2]||(l[2]=t("svg",{class:"ml-2 h-4 w-4 opacity-70",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M6 8l4 4 4-4",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1))],512)]),_:1}),n(s(ot),{class:"w-full min-w-full"},{default:d(()=>[n(s(B),{class:"block w-full text-left px-3 py-2",onClick:l[1]||(l[1]=L(a=>(c.value="all",q()),["prevent"]))},{default:d(()=>[f(e(s(o)("summary.all_productions")),1)]),_:1}),(m(!0),y(S,null,T(i.productions,a=>(m(),P(s(B),{key:a.production_id,class:"block w-full text-left px-3 py-2",onClick:L(_=>(c.value=a.production_id.toString(),q()),["prevent"])},{default:d(()=>[f(e(a.production_name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})])])]),t("div",vt,[t("div",kt,[t("p",St,e(s(o)("summary.total_target")),1),t("p",jt,e(Number(p.value.target_total).toLocaleString()),1),t("p",qt,e(s(o)("summary.target_normal").toLowerCase())+": "+e(Number(p.value.target_normal).toLocaleString())+" | "+e(s(o)("summary.target_reject").toLowerCase())+": "+e(Number(p.value.target_reject).toLocaleString()),1)]),t("div",Ct,[t("p",Dt,e(s(o)("summary.total_actual")),1),t("p",Nt,e(Number(p.value.actual_total).toLocaleString()),1)])]),t("div",Lt,[t("div",Tt,[t("table",wt,[t("thead",$t,[t("tr",null,[t("th",Bt,e(s(o)("summary.production")),1),t("th",It,e(s(o)("summary.machine_group")),1),t("th",Pt,e(s(o)("summary.target_normal")),1),t("th",zt,e(s(o)("summary.target_reject")),1),t("th",Mt,e(s(o)("summary.actual_normal")),1),t("th",Rt,e(s(o)("summary.actual_reject")),1),t("th",Et,[n(nt,null,{default:d(()=>[n(Q,null,{default:d(()=>[n(X,{asChild:""},{default:d(()=>[t("span",Ft,[f(e(s(o)("summary.variance"))+" ",1),n(s(lt),{class:"size-3.5 opacity-70"})])]),_:1}),n(Y,{side:"top",class:"text-left"},{default:d(()=>[t("div",Vt,e(s(o)("summary.variance")),1),t("div",null,e(s(o)("summary.variance_info")),1)]),_:1})]),_:1})]),_:1})]),t("th",At,e(s(o)("summary.status")),1)])]),t("tbody",null,[(m(!0),y(S,null,T(i.summaryData,a=>(m(),y("tr",{key:a.production_machine_group_id,class:"border-b border-sidebar-border/70 hover:bg-muted/20 transition"},[t("td",Ht,e(a.production_name),1),t("td",Ot,e(a.machine_group_name),1),t("td",Ut,e(Number(a.target_qty_normal??0).toLocaleString()),1),t("td",Wt,e(Number(a.target_qty_reject??0).toLocaleString()),1),t("td",Gt,e(Number(a.actual_qty_normal??0).toLocaleString()),1),t("td",Jt,e(Number(a.actual_qty_reject??0).toLocaleString()),1),t("td",Kt,[t("span",{class:w((a.actual_qty_normal??0)-(a.target_qty_normal??0)+((a.target_qty_reject??0)-(a.actual_qty_reject??0))>=0?"text-emerald-600 font-medium":"text-red-600 font-medium")},e((a.actual_qty_normal??0)-(a.target_qty_normal??0)+((a.target_qty_reject??0)-(a.actual_qty_reject??0))>=0?"+":"")+" "+e(Number((a.actual_qty_normal??0)-(a.target_qty_normal??0)+((a.target_qty_reject??0)-(a.actual_qty_reject??0))).toLocaleString()),3)]),t("td",Qt,[t("span",{class:w(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",a.status==="achieved"?"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/40 dark:text-emerald-400":"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-400"])},e(a.status==="achieved"?s(o)("summary.achieved"):s(o)("summary.below")),3)])]))),128)),i.summaryData.length===0?(m(),y("tr",Xt,[t("td",Yt,e(s(o)("summary.no_data")),1)])):G("",!0)])])])])])]),_:1},8,["breadcrumbs"])],64))}});export{le as default};
