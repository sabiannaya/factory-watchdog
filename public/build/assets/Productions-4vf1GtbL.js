import{d as V,f as v,g as b,B as p,c as m,m as f,u as a,p as $,w as x,a as o,t as l,q as h,z as k,L as S,o as _,n as z,F as q}from"./app-i1_2c9TI.js";import{_ as B}from"./AppLayout.vue_vue_type_script_setup_true_lang-UWREGGXY.js";import{_ as E}from"./DataTable.vue_vue_type_script_setup_true_lang-D5Bbd2Ot.js";import{u as U}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B0bB4Y56.js";import{F as M}from"./file-down-bpwgZGX2.js";import"./VisuallyHidden-CgfYLdxu.js";import"./index-C4J_hXM0.js";import"./x-T-BkQ4N0.js";import"./Input.vue_vue_type_script_setup_true_lang-mGQONf2a.js";import"./Spinner.vue_vue_type_script_setup_true_lang-Ca7klY01.js";import"./search-BWjjXBCD.js";const R={class:"p-4 space-y-4"},A={class:"flex items-center justify-between"},G={class:"text-2xl font-semibold"},H={class:"text-sm text-muted-foreground"},I={class:"flex items-center gap-3 mb-3"},J={class:"text-sm"},K=["disabled"],O={class:"text-sm"},Q=["disabled"],W=["disabled"],X={key:0,class:"flex flex-col items-end"},Y={class:"font-medium"},Z={class:"text-xs text-red-500"},ee={key:1,class:"flex flex-col items-end"},te={class:"font-medium"},ae={class:"text-xs text-muted-foreground"},re={class:"mt-4 flex items-center justify-end gap-2"},oe=["disabled"],se=["disabled"],ge=V({__name:"Productions",props:{aggregates:{},meta:{}},setup(j){const{t}=U(),N=v(()=>[{title:t("summary.title"),href:"/summary/productions"},{title:t("summary.productions_title"),href:"/summary/productions"}]),r=j,i=b(!1),c=b(r.meta?.date_from??""),d=b(r.meta?.date_to??""),L=v(()=>r.aggregates?.data??[]),T=e=>{const n=r.meta?.per_page??20,s=r.meta?.sort??"total_output",u=r.meta?.direction??"desc";p.get(window.location.pathname,{q:e,per_page:n,sort:s,direction:u,date_from:c.value,date_to:d.value},{preserveState:!0,replace:!0})},w=({sort:e,direction:n})=>{const s=r.meta?.per_page??20,u=r.meta?.q??"";e&&p.get(window.location.pathname,{sort:e,direction:n??"desc",per_page:s,q:u,date_from:c.value,date_to:d.value},{preserveState:!0,replace:!0})},g=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 00:00:00`:null,y=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 23:59:59`:null,C=()=>{const e=r.meta?.per_page??20,n=r.meta?.sort??"total_output",s=r.meta?.direction??"desc";p.get(window.location.pathname,{date_from:g(c.value||null),date_to:y(d.value||null),q:r.meta?.q??"",sort:n,direction:s,per_page:e},{preserveState:!0,replace:!0})},D=()=>{const e=r.aggregates?.next_page;e&&p.visit(e,{preserveState:!0,replace:!0})},F=()=>{const e=r.aggregates?.prev_page;e&&p.visit(e,{preserveState:!0,replace:!0})},P=()=>{const e=new URLSearchParams;c.value&&e.append("date_from",g(c.value)||""),d.value&&e.append("date_to",y(d.value)||""),r.meta?.q&&e.append("q",r.meta.q),window.location.href=`/summary/productions/export?${e.toString()}`};return p.on("start",()=>i.value=!0),p.on("finish",()=>i.value=!1),(e,n)=>(_(),m(q,null,[f(a($),{title:a(t)("summary.productions_title")},null,8,["title"]),f(B,{breadcrumbs:N.value},{default:x(()=>[o("div",R,[o("div",A,[o("div",null,[o("h2",G,l(a(t)("summary.productions_title")),1),o("p",H,l(a(t)("summary.productions_description")),1)]),o("button",{onClick:P,class:"btn-secondary flex items-center gap-2"},[f(a(M),{class:"size-4"}),h(" "+l(a(t)("app.export")),1)])]),o("div",I,[o("label",J,l(a(t)("app.from")),1),k(o("input",{type:"date",class:"input","onUpdate:modelValue":n[0]||(n[0]=s=>c.value=s),disabled:i.value},null,8,K),[[S,c.value]]),o("label",O,l(a(t)("app.to")),1),k(o("input",{type:"date",class:"input","onUpdate:modelValue":n[1]||(n[1]=s=>d.value=s),disabled:i.value},null,8,Q),[[S,d.value]]),o("button",{class:"hover:cursor-pointer btn",onClick:C,disabled:i.value},l(a(t)("app.apply")),9,W)]),f(E,{serverMode:"",data:L.value,columns:[{key:"production_id",label:a(t)("app.id"),type:"number",sortable:!1,findable:!1},{key:"production_name",label:a(t)("summary.production"),type:"string",sortable:!0,findable:!0},{key:"group_count",label:a(t)("summary.machine_group"),type:"number",sortable:!0,findable:!1},{key:"total_target_qty_normal",label:a(t)("summary.target_normal"),type:"number",sortable:!0,findable:!1},{key:"total_target_qty_reject",label:a(t)("summary.target_reject"),type:"number",sortable:!0,findable:!1},{key:"total_output_qty_normal",label:a(t)("summary.actual_normal"),type:"number",sortable:!0,findable:!1},{key:"total_output_qty_reject",label:a(t)("summary.actual_reject"),type:"number",sortable:!0,findable:!1},{key:"total_target",label:a(t)("summary.target_total"),type:"number",sortable:!0,findable:!1},{key:"total_output",label:a(t)("summary.actual_total"),type:"number",sortable:!0,findable:!1},{key:"variance",label:a(t)("summary.variance"),type:"number",sortable:!1,findable:!1}],"per-page":20,"initial-sort":r.meta?.sort??"total_output","initial-direction":r.meta?.direction??"desc",loading:i.value,onServerSearch:T,onServerSort:w},{cell:x(({row:s,column:u})=>[u.key==="total_output"?(_(),m("div",X,[o("span",Y,l(Number(s.total_output_qty_normal??0).toLocaleString()),1),o("span",Z,l(a(t)("logs.reject"))+": "+l(Number(s.total_output_qty_reject??0).toLocaleString()),1)])):u.key==="total_target"?(_(),m("div",ee,[o("span",te,l(Number(s.total_target_qty_normal??0).toLocaleString()),1),o("span",ae,l(a(t)("logs.reject"))+": "+l(Number(s.total_target_qty_reject??0).toLocaleString()),1)])):u.key==="variance"?(_(),m("span",{key:2,class:z((s.variance??0)>=0?"text-emerald-600 font-medium":"text-red-600 font-medium")},l((s.variance>=0?"+":"")+Number(s.variance??0).toLocaleString()),3)):(_(),m(q,{key:3},[h(l(s[u.key]),1)],64))]),_:1},8,["data","columns","initial-sort","initial-direction","loading"]),o("div",re,[o("button",{class:"hover:cursor-pointer btn",disabled:!r.aggregates?.prev_page||i.value,onClick:F},l(a(t)("app.previous")),9,oe),o("button",{class:"hover:cursor-pointer btn",disabled:!r.aggregates?.next_page||i.value,onClick:D},l(a(t)("app.next")),9,se)])])]),_:1},8,["breadcrumbs"])],64))}});export{ge as default};
