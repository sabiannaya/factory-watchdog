import{d as $,e as B,w as l,J as F,E as V,G as z,u,o as c,g as h,f as T,c as _,m as r,p as O,a as t,q as f,z as G,L as H,t as o,y as q,F as k,i as C,b as Q,n as L,B as P,k as U}from"./app-BRuhaguS.js";import{T as W,a as J,b as K,c as X,d as w,g as Y,h as Z,i as tt,_ as et}from"./AppLayout.vue_vue_type_script_setup_true_lang-BSta2Xg1.js";import{F as at}from"./file-down-D61wkUlP.js";import{c as st}from"./createLucideIcon-Bc86gjbu.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DrUmFdxY.js";import"./Presence-CRPloLVK.js";import"./useForwardPropsEmits-CxMGla6T.js";import"./x-Dz_x2_zF.js";import"./VisuallyHidden-gDrgz296.js";import"./index-C4J_hXM0.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=st("InfoIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),rt=$({__name:"TooltipProvider",props:{delayDuration:{default:0},skipDelayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},setup(x){const n=x;return(y,d)=>(c(),B(u(W),V(z(n)),{default:l(()=>[F(y.$slots,"default")]),_:3},16))}}),lt={class:"p-4 space-y-6"},nt={class:"flex items-start justify-between"},dt={class:"rounded-lg border border-sidebar-border/70 bg-card p-4"},it={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ut={class:"space-y-2"},ct={class:"flex items-center gap-2"},mt={class:"space-y-2"},pt={key:0},_t={key:1},gt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ft={class:"rounded-lg border border-sidebar-border/70 bg-card p-4"},xt={class:"text-2xl font-bold"},yt={class:"text-xs text-muted-foreground mt-1"},bt={class:"rounded-lg border border-sidebar-border/70 bg-card p-4"},vt={class:"text-2xl font-bold"},ht={class:"rounded-lg border border-sidebar-border/70 bg-card overflow-hidden"},kt={class:"overflow-x-auto"},St={class:"w-full"},Nt={class:"bg-muted/50 border-b border-sidebar-border/70"},jt={class:"px-4 py-3 text-right text-sm font-medium"},Dt={class:"inline-flex items-center gap-1 cursor-help select-none"},Tt={class:"px-4 py-3 text-sm"},qt={class:"px-4 py-3 text-sm"},Ct={class:"px-4 py-3 text-sm text-right font-medium"},Lt={class:"px-4 py-3 text-sm text-right text-red-600"},Pt={class:"px-4 py-3 text-sm text-right font-medium"},wt={class:"px-4 py-3 text-sm text-right text-red-600"},$t={class:"px-4 py-3 text-sm text-right"},Bt={class:"px-4 py-3 text-center"},Rt={key:0},Qt=$({__name:"DailySummary",props:{date:{},productions:{},selectedProductionId:{},summaryData:{}},setup(x){const n=x,y=[{title:"Summary",href:"/summary/daily"},{title:"Daily Summary",href:window.location.pathname}],d=h(n.date),i=h(n.selectedProductionId?n.selectedProductionId.toString():"all"),b=()=>{const s={date:d.value};i.value!=="all"&&(s.production_id=i.value),P.get("/summary/daily",s,{preserveState:!1})},S=()=>{const s={date:d.value};i.value!=="all"&&(s.production_id=i.value),P.get("/summary/daily",s,{preserveState:!1})},R=()=>{const s=new Date(d.value);s.setDate(s.getDate()-1),d.value=s.toISOString().split("T")[0],b()},I=()=>{const s=new Date(d.value);s.setDate(s.getDate()+1),d.value=s.toISOString().split("T")[0],b()},N=h(null),j=async()=>{await U(),setTimeout(()=>{const s=N.value;if(!s)return;const e=Array.from(document.querySelectorAll("body *")).filter(m=>{if(!(m instanceof HTMLElement))return!1;const g=m.getBoundingClientRect();return g.width===0&&g.height===0?!1:(m.innerText||"").trim().includes("All Productions")});if(e.length===0)return;const a=e[e.length-1];a.style.width=`${s.offsetWidth}px`},50)};window.addEventListener("resize",()=>{j()});const E=()=>{const s=new URLSearchParams;s.append("date",d.value),i.value!=="all"&&s.append("production_id",i.value),window.location.href=`/summary/daily/export?${s.toString()}`},p=T(()=>n.summaryData.reduce((s,e)=>{const a=Number(e.target_qty_normal??0),m=Number(e.target_qty_reject??0),g=a+m,v=Number(e.actual_qty_normal??0),D=Number(e.actual_qty_reject??0),M=Number(e.actual_total??v+D),A=v-a+(m-D);return{target_total:s.target_total+g,target_normal:s.target_normal+a,target_reject:s.target_reject+m,actual_total:s.actual_total+M,variance:s.variance+A}},{target_total:0,target_normal:0,target_reject:0,actual_total:0,variance:0}));return T(()=>p.value.target_total>0?Math.round(p.value.actual_total/p.value.target_total*100*10)/10:0),(s,e)=>(c(),_(k,null,[r(u(O),{title:"Daily Summary"}),r(et,{breadcrumbs:y},{default:l(()=>[t("div",lt,[t("div",nt,[e[3]||(e[3]=t("div",null,[t("h1",{class:"text-2xl font-bold"},"Daily Summary"),t("p",{class:"text-muted-foreground"},"Compare daily targets with actual outputs")],-1)),t("button",{onClick:E,class:"btn-secondary flex items-center gap-2"},[r(u(at),{class:"size-4"}),e[2]||(e[2]=f(" Export to Excel ",-1))])]),t("div",dt,[t("div",it,[t("div",ut,[e[4]||(e[4]=t("label",{class:"text-sm font-medium"},"Date",-1)),t("div",ct,[t("button",{onClick:R,class:"px-3 py-2 rounded-md border border-input hover:bg-muted transition"}," ‹ "),G(t("input",{type:"date","onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),onChange:b,class:"input flex-1 ml-2 date-input"},null,544),[[H,d.value]]),t("button",{onClick:I,class:"px-3 py-2 rounded-md border border-input hover:bg-muted transition"}," › ")])]),t("div",mt,[e[7]||(e[7]=t("label",{class:"text-sm font-medium"},"Production",-1)),r(u(J),null,{default:l(()=>[r(u(K),{asChild:""},{default:l(()=>[t("button",{ref_key:"triggerRef",ref:N,onClick:j,class:"input w-full text-left flex items-center justify-between"},[i.value==="all"?(c(),_("span",pt,"All Productions")):(c(),_("span",_t,o(n.productions.find(a=>a.production_id.toString()===i.value)?.production_name),1)),e[5]||(e[5]=t("svg",{class:"ml-2 h-4 w-4 opacity-70",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[t("path",{d:"M6 8l4 4 4-4",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round","stroke-linejoin":"round"})],-1))],512)]),_:1}),r(u(X),{class:"w-full min-w-full"},{default:l(()=>[r(u(w),{class:"block w-full text-left px-3 py-2",onClick:e[1]||(e[1]=q(a=>(i.value="all",S()),["prevent"]))},{default:l(()=>[...e[6]||(e[6]=[f("All Productions",-1)])]),_:1}),(c(!0),_(k,null,C(n.productions,a=>(c(),B(u(w),{key:a.production_id,class:"block w-full text-left px-3 py-2",onClick:q(m=>(i.value=a.production_id.toString(),S()),["prevent"])},{default:l(()=>[f(o(a.production_name),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})])])]),t("div",gt,[t("div",ft,[e[8]||(e[8]=t("p",{class:"text-sm text-muted-foreground"},"Total Target",-1)),t("p",xt,o(Number(p.value.target_total).toLocaleString()),1),t("p",yt,"normal: "+o(Number(p.value.target_normal).toLocaleString())+" | reject: "+o(Number(p.value.target_reject).toLocaleString()),1)]),t("div",bt,[e[9]||(e[9]=t("p",{class:"text-sm text-muted-foreground"},"Total Actual",-1)),t("p",vt,o(Number(p.value.actual_total).toLocaleString()),1)])]),t("div",ht,[t("div",kt,[t("table",St,[t("thead",Nt,[t("tr",null,[e[12]||(e[12]=t("th",{class:"px-4 py-3 text-left text-sm font-medium"},"Production",-1)),e[13]||(e[13]=t("th",{class:"px-4 py-3 text-left text-sm font-medium"},"Machine Group",-1)),e[14]||(e[14]=t("th",{class:"px-4 py-3 text-right text-sm font-medium"},"Target Normal",-1)),e[15]||(e[15]=t("th",{class:"px-4 py-3 text-right text-sm font-medium"},"Target Reject",-1)),e[16]||(e[16]=t("th",{class:"px-4 py-3 text-right text-sm font-medium"},"Output Normal",-1)),e[17]||(e[17]=t("th",{class:"px-4 py-3 text-right text-sm font-medium"},"Output Reject",-1)),t("th",jt,[r(rt,null,{default:l(()=>[r(Y,null,{default:l(()=>[r(Z,{asChild:""},{default:l(()=>[t("span",Dt,[e[10]||(e[10]=f(" Variance ",-1)),r(u(ot),{class:"size-3.5 opacity-70"})])]),_:1}),r(tt,{side:"top",class:"text-left"},{default:l(()=>[...e[11]||(e[11]=[t("div",{class:"font-semibold mb-1"},"Variance",-1),t("div",null,"Formula: (Qty Normal - Target Normal) + (Target Reject - Qty Reject)",-1),t("div",{class:"mt-1 text-muted-foreground"},"Positive = above target, Negative = below target",-1)])]),_:1})]),_:1})]),_:1})]),e[18]||(e[18]=t("th",{class:"px-4 py-3 text-center text-sm font-medium"},"Status",-1))])]),t("tbody",null,[(c(!0),_(k,null,C(n.summaryData,a=>(c(),_("tr",{key:a.production_machine_group_id,class:"border-b border-sidebar-border/70 hover:bg-muted/20 transition"},[t("td",Tt,o(a.production_name),1),t("td",qt,o(a.machine_group_name),1),t("td",Ct,o(Number(a.target_qty_normal??0).toLocaleString()),1),t("td",Lt,o(Number(a.target_qty_reject??0).toLocaleString()),1),t("td",Pt,o(Number(a.actual_qty_normal??0).toLocaleString()),1),t("td",wt,o(Number(a.actual_qty_reject??0).toLocaleString()),1),t("td",$t,[t("span",{class:L((a.actual_qty_normal??0)-(a.target_qty_normal??0)+((a.target_qty_reject??0)-(a.actual_qty_reject??0))>=0?"text-emerald-600 font-medium":"text-red-600 font-medium")},o((a.actual_qty_normal??0)-(a.target_qty_normal??0)+((a.target_qty_reject??0)-(a.actual_qty_reject??0))>=0?"+":"")+" "+o(Number((a.actual_qty_normal??0)-(a.target_qty_normal??0)+((a.target_qty_reject??0)-(a.actual_qty_reject??0))).toLocaleString()),3)]),t("td",Bt,[t("span",{class:L(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",a.status==="achieved"?"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/40 dark:text-emerald-400":"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-400"])},o(a.status==="achieved"?"Achieved":"Below Target"),3)])]))),128)),n.summaryData.length===0?(c(),_("tr",Rt,[...e[19]||(e[19]=[t("td",{colspan:"8",class:"px-4 py-8 text-center text-sm text-muted-foreground"}," No data available for this date ",-1)])])):Q("",!0)])])])])])]),_:1})],64))}});export{Qt as default};
