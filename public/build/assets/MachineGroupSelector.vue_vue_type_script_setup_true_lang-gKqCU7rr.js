import{d as G,c as u,a as t,H as D,b as m,q as v,I as A,t as i,L as V,o as n,e as k,F as C,h as $,M as B,r as _,w as I,n as b,p as S,G as M,u as T,k as N,N as P}from"./app-ue20rSb4.js";import{c as E}from"./createLucideIcon-COama0qN.js";import{C as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-C_szTgFs.js";import{S as O}from"./search-CIEtGgaw.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j=E("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),q={class:"rounded-lg border border-sidebar-border/70 bg-card dark:bg-card p-6"},F={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},z={class:"flex flex-col gap-2"},H={key:0,class:"text-xs text-destructive dark:text-destructive"},K={class:"flex flex-col gap-2"},Q={key:0,class:"text-xs text-destructive dark:text-destructive"},Rt=G({__name:"ProductionFormFields",props:{form:{}},setup(e){return(y,o)=>(n(),u("div",q,[o[5]||(o[5]=t("h2",{class:"text-lg font-semibold mb-5"},"Production Details",-1)),t("div",F,[t("div",z,[o[2]||(o[2]=t("label",{class:"text-sm font-medium"},[v("Production Name "),t("span",{class:"text-red-500"},"*")],-1)),D(t("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>e.form.production_name=c),type:"text",class:"input",required:""},null,512),[[A,e.form.production_name]]),e.form.errors.production_name?(n(),u("div",H,i(e.form.errors.production_name),1)):m("",!0)]),t("div",K,[o[4]||(o[4]=t("label",{class:"text-sm font-medium"},[v("Status "),t("span",{class:"text-red-500"},"*")],-1)),D(t("select",{"onUpdate:modelValue":o[1]||(o[1]=c=>e.form.status=c),class:"appearance-none rounded-md border bg-popover dark:bg-popover text-popover-foreground dark:text-popover-foreground px-3 py-2 pr-10 text-sm shadow-sm placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},[...o[3]||(o[3]=[t("option",{value:"active"},"Active",-1),t("option",{value:"inactive"},"Inactive",-1)])],512),[[V,e.form.status]]),e.form.errors.status?(n(),u("div",Q,i(e.form.errors.status),1)):m("",!0)])])]))}}),R={class:"space-y-4"},J={key:0,class:"mb-4 pb-4 border-b border-sidebar-border/70 dark:border-sidebar-border/70"},W=["value"],X={class:"space-y-3"},Y={class:"text-sm font-medium capitalize"},Z=["value","onInput"],tt={key:0,class:"space-y-3"},et={class:"grid grid-cols-1 sm:grid-cols-2 gap-3"},at={class:"text-sm font-medium capitalize"},rt=["value","onInput"],st={key:1,class:"flex flex-col gap-2"},ot=["value"],U=G({__name:"TargetInputs",props:{inputConfig:{},targets:{},targetDate:{},showDate:{type:Boolean,default:!1}},emits:["update:targets"],setup(e,{emit:y}){const o=e,c=y,g=k(()=>o.inputConfig?.fields?o.inputConfig.fields.filter(x=>x!=="keterangan"):["qty"]),p=k(()=>o.inputConfig?.grade_types||[]);function f(x,l){const d={...o.targets};l==null?delete d[x]:d[x]=l,c("update:targets",d)}function w(x,l){const d=`grade_${x}`,r={...o.targets};l==null?delete r[d]:r[d]=l,c("update:targets",r)}return(x,l)=>(n(),u("div",R,[e.showDate&&e.targetDate?(n(),u("div",J,[l[1]||(l[1]=t("label",{class:"text-sm font-medium block mb-2"},"Target Date",-1)),t("input",{type:"date",value:e.targetDate,class:"input max-w-xs",disabled:""},null,8,W),l[2]||(l[2]=t("p",{class:"text-xs text-muted-foreground dark:text-muted-foreground mt-2"}," Set targets for each input field for this date ",-1))])):m("",!0),t("div",X,[(n(!0),u(C,null,$(g.value,d=>D((n(),u("div",{key:d,class:"flex flex-col gap-2"},[t("label",Y,i(d.replace(/_/g," ")),1),t("input",{type:"number",min:"0",value:e.targets[d]??null,onInput:r=>f(d,r.target.value?Number(r.target.value):null),class:"input",placeholder:"Enter value"},null,40,Z)])),[[B,d!=="grades"&&d!=="grade"]])),128)),e.inputConfig?.fields?.includes("grades")&&p.value.length>0?(n(),u("div",tt,[l[3]||(l[3]=t("label",{class:"text-sm font-medium block"},"Grades",-1)),t("div",et,[(n(!0),u(C,null,$(p.value,d=>(n(),u("div",{key:d,class:"flex flex-col gap-2"},[t("label",at,i(d),1),t("input",{type:"number",min:"0",value:e.targets[`grade_${d}`]??null,onInput:r=>w(d,r.target.value?Number(r.target.value):null),class:"input",placeholder:"Enter value"},null,40,rt)]))),128))])])):m("",!0),e.inputConfig?.fields?.includes("grade")&&!e.inputConfig?.fields?.includes("grades")?(n(),u("div",st,[l[4]||(l[4]=t("label",{class:"text-sm font-medium"},"Grade",-1)),t("input",{type:"number",min:"0",value:e.targets.grade??null,onInput:l[0]||(l[0]=d=>f("grade",d.target.value?Number(d.target.value):null)),class:"input",placeholder:"Enter value"},null,40,ot)])):m("",!0)])]))}}),dt={class:"p-4"},nt={class:"flex items-start justify-between gap-4"},ut=["disabled"],lt={class:"flex-1 min-w-0"},it={class:"flex items-center gap-2 mb-1 flex-wrap"},ct={key:0,class:"flex gap-1"},gt={class:"flex items-center gap-2 cursor-pointer flex-shrink-0"},mt=["checked"],ft={key:0,class:"mt-4 pt-4 border-t border-sidebar-border/70 dark:border-sidebar-border/70"},xt={class:"space-y-4"},ht={class:"flex flex-col gap-2"},pt=["value"],bt={key:0,class:"space-y-1"},vt={class:"space-y-2 pb-4 border-b border-sidebar-border/70 dark:border-sidebar-border/70"},kt={key:0,class:"space-y-1"},yt={key:0,class:"space-y-2"},Ct={class:"flex items-center gap-2 mb-2"},$t={class:"text-xs px-2 py-0.5 rounded-full bg-emerald-600/20 text-emerald-700 dark:text-emerald-400"},wt={key:0,class:"space-y-1"},Dt={key:1,class:"mt-3 pt-3 border-t border-sidebar-border/70 dark:border-sidebar-border/70 flex gap-4 text-sm text-muted-foreground dark:text-muted-foreground"},Gt={class:"text-foreground dark:text-foreground"},_t={key:0},Tt={class:"text-foreground dark:text-foreground"},Nt=G({__name:"MachineGroupItem",props:{machineGroup:{},attached:{type:Boolean},machineCount:{},targets:{},defaultTargets:{},targetDate:{},errors:{}},emits:["update:attached","update:machineCount","update:targets","update:defaultTargets"],setup(e,{emit:y}){const o=e,c=y,g=_(!1),p={value:!1};I(()=>o.attached,(d,r)=>{if(!p.value){p.value=!0;return}d&&!g.value&&(g.value=!0)});const f=k(()=>Object.values(o.targets).some(d=>d!=null)),w=k(()=>o.targetDate&&f.value?"bg-emerald-600/20 text-emerald-700 dark:text-emerald-400":!o.targetDate&&f.value?"bg-sky-600/20 text-sky-700 dark:text-sky-400":"bg-gray-600/20 text-gray-700 dark:text-gray-400"),x=k(()=>o.targetDate&&f.value?"Per-date":!o.targetDate&&f.value?"Default":"No target");function l(){g.value=!g.value}return(d,r)=>(n(),u("div",{class:b(["rounded-lg border transition-all",e.attached?"border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/40 dark:bg-muted/40 border-ring/30 dark:border-ring/30":"border-sidebar-border/30 dark:border-sidebar-border/30 bg-muted/5 dark:bg-muted/5 opacity-60"])},[t("div",dt,[t("div",nt,[t("button",{type:"button",onClick:r[0]||(r[0]=a=>e.attached?l():null),disabled:!e.attached,class:b(["flex items-start gap-3 flex-1 text-left transition-colors",e.attached?"group cursor-pointer hover:text-foreground dark:hover:text-foreground":"cursor-not-allowed opacity-60"])},[(n(),S(M(g.value?T(j):T(L)),{class:b(["h-5 w-5 mt-0.5 transition-colors",e.attached?"text-muted-foreground dark:text-muted-foreground group-hover:text-foreground dark:group-hover:text-foreground":"text-muted-foreground/50 dark:text-muted-foreground/50"])},null,8,["class"])),t("div",lt,[t("div",it,[t("h3",{class:b(["font-semibold text-base",e.attached?"text-foreground dark:text-foreground":"text-muted-foreground dark:text-muted-foreground"])},i(e.machineGroup.name),3),e.attached?(n(),u("div",ct,[t("span",{class:b(["text-xs px-2 py-0.5 rounded-full whitespace-nowrap",w.value])},i(x.value),3)])):m("",!0)]),t("p",{class:b(["text-sm line-clamp-1",e.attached?"text-muted-foreground dark:text-muted-foreground":"text-muted-foreground/60 dark:text-muted-foreground/60"])},i(e.machineGroup.description||"No description"),3)])],10,ut),t("label",gt,[t("input",{type:"checkbox",checked:e.attached,onChange:r[1]||(r[1]=a=>c("update:attached",a.target.checked)),class:"w-4 h-4 rounded border-input dark:border-input"},null,40,mt),t("span",{class:b(["text-sm font-medium transition-colors",e.attached?"text-foreground dark:text-foreground":"text-muted-foreground dark:text-muted-foreground"])},i(e.attached?"Attached":"Attach"),3)])]),e.attached&&g.value?(n(),u("div",ft,[t("div",xt,[t("div",ht,[r[5]||(r[5]=t("label",{class:"text-sm font-medium"},[v("Machine Count "),t("span",{class:"text-red-500"},"*")],-1)),t("input",{type:"number",min:"1",value:e.machineCount,onInput:r[2]||(r[2]=a=>c("update:machineCount",Number(a.target.value))),class:"input"},null,40,pt),e.errors?.machine_count?(n(),u("div",bt,[(n(!0),u(C,null,$(e.errors.machine_count,(a,s)=>(n(),u("div",{key:s,class:"text-xs text-destructive dark:text-destructive"},i(a),1))),128))])):m("",!0)]),t("div",vt,[r[6]||(r[6]=t("div",{class:"flex items-center gap-2 mb-2"},[t("h4",{class:"text-sm font-semibold"},"Production Defaults"),t("span",{class:"text-xs px-2 py-0.5 rounded-full bg-sky-600/20 text-sky-700 dark:text-sky-400"}," Per machine group ")],-1)),r[7]||(r[7]=t("p",{class:"text-xs text-muted-foreground dark:text-muted-foreground mb-3"}," Set default target values for this machine group (used unless overridden daily) ",-1)),N(U,{"input-config":e.machineGroup.input_config,targets:e.defaultTargets,"show-date":!1,"onUpdate:targets":r[3]||(r[3]=a=>c("update:defaultTargets",a))},null,8,["input-config","targets"]),e.errors?.default_targets?(n(),u("div",kt,[(n(!0),u(C,null,$(e.errors.default_targets,(a,s)=>(n(),u("div",{key:s,class:"text-xs text-destructive dark:text-destructive"},i(a),1))),128))])):m("",!0)]),e.targetDate?(n(),u("div",yt,[t("div",Ct,[r[8]||(r[8]=t("h4",{class:"text-sm font-semibold"},"Per-Date Targets",-1)),t("span",$t," Override for "+i(e.targetDate),1)]),r[9]||(r[9]=t("p",{class:"text-xs text-muted-foreground dark:text-muted-foreground mb-3"}," Override defaults for this specific date ",-1)),N(U,{"input-config":e.machineGroup.input_config,targets:e.targets,"target-date":e.targetDate,"show-date":!1,"onUpdate:targets":r[4]||(r[4]=a=>c("update:targets",a))},null,8,["input-config","targets","target-date"]),e.errors?.targets?(n(),u("div",wt,[(n(!0),u(C,null,$(e.errors.targets,(a,s)=>(n(),u("div",{key:s,class:"text-xs text-destructive dark:text-destructive"},i(a),1))),128))])):m("",!0)])):m("",!0)])])):m("",!0),e.attached&&!g.value?(n(),u("div",Dt,[t("span",null,[t("strong",Gt,i(e.machineCount),1),r[10]||(r[10]=v(" machines",-1))]),f.value?(n(),u("span",_t,[t("strong",Tt,i(Object.values(e.targets).filter(a=>a!==null).length),1),r[11]||(r[11]=v(" targets set ",-1))])):m("",!0)])):m("",!0)])],2))}}),Ut={class:"rounded-lg border border-sidebar-border/70 bg-card p-6 dark:border-sidebar-border/70 dark:bg-card"},At={class:"mb-2 flex items-start justify-between"},St={class:"mt-1 text-sm text-muted-foreground dark:text-muted-foreground"},Vt={class:"font-medium"},Bt={key:0,class:"mb-6 border-b border-sidebar-border/70 pb-6 dark:border-sidebar-border/70"},It=["value"],Mt={class:"mb-6 space-y-3"},Pt={class:"relative"},Et={class:"flex items-center gap-4"},Lt={class:"flex cursor-pointer items-center gap-2"},Ot={class:"text-xs text-muted-foreground dark:text-muted-foreground"},jt={class:"max-h-[600px] space-y-3 overflow-y-auto pr-2"},qt={key:0,class:"py-12 text-center text-muted-foreground dark:text-muted-foreground"},Ft={class:"text-sm"},Jt=G({__name:"MachineGroupSelector",props:{machineGroups:{},attachedGroups:{},targetDate:{},errors:{}},emits:["update:attachedGroups","update:targetDate"],setup(e,{emit:y}){const o=e,c=y,g=_(""),p=_(!1),f=k(()=>{let r=o.machineGroups.map(a=>{const s=o.attachedGroups[a.machine_group_id];return{...a,attached:!!s,machineCount:s?.machine_count??1,targets:s?.targets??{},defaultTargets:s?.default_targets??{}}});if(g.value){const a=g.value.toLowerCase();r=r.filter(s=>s.name?.toLowerCase().includes(a)||s.description?.toLowerCase().includes(a))}return p.value&&(r=r.filter(a=>a.attached)),r.sort((a,s)=>a.attached&&!s.attached?-1:!a.attached&&s.attached?1:(a.name||"").localeCompare(s.name||""))}),w=k(()=>Object.keys(o.attachedGroups).length);function x(){const r={};o.machineGroups.forEach(a=>{r[a.machine_group_id]={machine_group_id:a.machine_group_id,machine_count:1,targets:{},default_targets:{}}}),c("update:attachedGroups",r)}function l(){c("update:attachedGroups",{})}function d(r,a){const s={};for(const h in o.attachedGroups)s[Number(h)]={...o.attachedGroups[Number(h)]};if("attached"in a){a.attached===!1?delete s[r]:a.attached===!0&&!s[r]&&(s[r]={machine_group_id:r,machine_count:1,targets:{},default_targets:{}}),c("update:attachedGroups",s);return}s[r]&&(a.machine_count!==void 0&&(s[r].machine_count=a.machine_count),a.targets!==void 0&&(s[r].targets={...a.targets}),a.default_targets!==void 0&&(s[r].default_targets={...a.default_targets}),c("update:attachedGroups",s))}return(r,a)=>(n(),u("div",Ut,[t("div",At,[t("div",null,[a[3]||(a[3]=t("h2",{class:"text-lg font-semibold"},"Machine Groups",-1)),t("p",St,[t("span",Vt,i(w.value),1),v(" of "+i(e.machineGroups.length)+" groups attached ",1)])]),t("div",{class:"flex items-center gap-2"},[t("button",{type:"button",class:"btn btn-sm",onClick:x,title:"Attach all machine groups"}," Attach All "),t("button",{type:"button",class:"btn btn-sm btn-ghost",onClick:l,title:"Detach all machine groups"}," Detach All ")])]),e.targetDate!==void 0?(n(),u("div",Bt,[a[4]||(a[4]=t("label",{class:"mb-3 block text-sm font-medium"},[v(" Target Date "),t("span",{class:"text-muted-foreground dark:text-muted-foreground"},"(optional)")],-1)),t("input",{type:"date",value:e.targetDate||"",onInput:a[0]||(a[0]=s=>r.$emit("update:targetDate",s.target.value||null)),class:"input max-w-xs"},null,40,It),a[5]||(a[5]=t("p",{class:"mt-2 text-xs text-muted-foreground dark:text-muted-foreground"}," Set a date to create per-date targets for attached groups ",-1))])):m("",!0),t("div",Mt,[t("div",Pt,[N(T(O),{class:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 text-muted-foreground dark:text-muted-foreground"}),D(t("input",{"onUpdate:modelValue":a[1]||(a[1]=s=>g.value=s),type:"text",placeholder:"Search machine groups...",class:"input pl-10"},null,512),[[A,g.value]])]),t("div",Et,[t("label",Lt,[D(t("input",{type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=s=>p.value=s),class:"h-4 w-4 rounded border-input dark:border-input"},null,512),[[P,p.value]]),a[6]||(a[6]=t("span",{class:"text-sm"},"Show attached only",-1))]),t("span",Ot,i(f.value.length)+" groups shown ",1)])]),t("div",jt,[f.value.length===0?(n(),u("div",qt,[t("p",Ft,i(g.value?"No groups match your search":"No machine groups available"),1)])):m("",!0),(n(!0),u(C,null,$(f.value,s=>(n(),S(Nt,{key:s.machine_group_id,"machine-group":s,attached:s.attached,"machine-count":s.machineCount,targets:s.targets,"default-targets":s.defaultTargets,"target-date":e.targetDate,errors:e.errors?.[s.machine_group_id],"onUpdate:attached":h=>d(s.machine_group_id,{attached:h}),"onUpdate:machineCount":h=>d(s.machine_group_id,{machine_count:h}),"onUpdate:targets":h=>d(s.machine_group_id,{targets:h}),"onUpdate:defaultTargets":h=>d(s.machine_group_id,{default_targets:h})},null,8,["machine-group","attached","machine-count","targets","default-targets","target-date","errors","onUpdate:attached","onUpdate:machineCount","onUpdate:targets","onUpdate:defaultTargets"]))),128))])]))}});export{Rt as _,Jt as a};
