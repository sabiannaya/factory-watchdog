import{d as E,K as x,r as l,j as k,c as y,k as c,u as i,l as C,m as j,a as o,E as w,t as S,J as m,F as $,o as D}from"./app-ue20rSb4.js";import{_ as O}from"./AppLayout.vue_vue_type_script_setup_true_lang-C_szTgFs.js";import{_ as M,a as U}from"./MachineGroupSelector.vue_vue_type_script_setup_true_lang-gKqCU7rr.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C7b_Quob.js";import"./index-Cl--hQqE.js";import"./VisuallyHidden-DjuZqZTT.js";import"./useForwardExpose-BCEiolqJ.js";import"./useForwardPropsEmits-BgPdB8_u.js";import"./index-C4J_hXM0.js";import"./createLucideIcon-COama0qN.js";import"./search-CIEtGgaw.js";const B={class:"p-4 space-y-4"},F={class:"flex items-center gap-3 pt-4"},G=["disabled"],Q=E({__name:"Edit",props:{production:{},machine_groups:{},attached_groups:{}},setup(g){const a=g,_=[{title:"Data Management",href:"/data-management/production"},{title:"Production",href:"/data-management/production"},{title:a.production?.production_name??"Edit",href:window.location.pathname}],n=x({production_name:a.production.production_name,status:a.production.status,target_date:null,machine_groups:[]}),u=l(null),r=l({}),d=l({});k(()=>{const e={};a.attached_groups&&Object.values(a.attached_groups).forEach(t=>{e[t.machine_group_id]={machine_group_id:t.machine_group_id,machine_count:t.machine_count,targets:{qty:t.default_target},default_targets:t.default_targets??{}}}),r.value=e});function h(e){r.value=e}function f(e){u.value=e}function v(){d.value={};let e=!0;return Object.values(r.value).forEach(t=>{const s={};(!t.machine_count||t.machine_count<1)&&(s.machine_count=["Machine count must be at least 1"],e=!1),u.value&&(Object.values(t.targets).some(p=>p!=null)||(s.targets=["At least one target is required when target date is set"],e=!1)),Object.keys(s).length>0&&(d.value[t.machine_group_id]=s)}),e}function b(){v()&&(n.target_date=u.value,n.machine_groups=Object.values(r.value),n.put(`/data-management/production/${a.production.production_id}`,{preserveState:!1,onSuccess:()=>{m.get("/data-management/production")}}))}return(e,t)=>(D(),y($,null,[c(i(C),{title:`Edit Production â€” ${a.production.production_name}`},null,8,["title"]),c(O,{breadcrumbs:_},{default:j(()=>[o("div",B,[t[1]||(t[1]=o("div",null,[o("h1",{class:"text-3xl font-bold"},"Edit Production"),o("p",{class:"text-muted-foreground dark:text-muted-foreground"}," Configure production details and attach machine groups with targets ")],-1)),o("form",{onSubmit:w(b,["prevent"]),class:"space-y-6"},[c(M,{form:i(n)},null,8,["form"]),c(U,{"machine-groups":a.machine_groups||[],"attached-groups":r.value,"target-date":u.value,errors:d.value,"onUpdate:attachedGroups":h,"onUpdate:targetDate":f},null,8,["machine-groups","attached-groups","target-date","errors"]),o("div",F,[o("button",{type:"submit",class:"btn cursor-pointer",disabled:i(n).processing},S(i(n).processing?"Saving...":"Save Changes"),9,G),o("button",{type:"button",class:"btn btn-ghost",onClick:t[0]||(t[0]=s=>i(m).get("/data-management/production"))}," Cancel ")])],32)])]),_:1})],64))}});export{Q as default};
