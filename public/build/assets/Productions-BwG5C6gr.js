import{d as T,r as p,e as q,J as i,c as F,k as u,u as g,l as C,m as D,a as r,q as V,H as f,I as b,F as E,o as N}from"./app-ue20rSb4.js";import{_ as $}from"./AppLayout.vue_vue_type_script_setup_true_lang-C_szTgFs.js";import{_ as A}from"./DataTable.vue_vue_type_script_setup_true_lang-UsrF_l4e.js";import{F as B}from"./file-down-B6gKHvru.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C7b_Quob.js";import"./index-Cl--hQqE.js";import"./VisuallyHidden-DjuZqZTT.js";import"./useForwardExpose-BCEiolqJ.js";import"./useForwardPropsEmits-BgPdB8_u.js";import"./index-C4J_hXM0.js";import"./createLucideIcon-COama0qN.js";import"./Input.vue_vue_type_script_setup_true_lang-DnYWP9Is.js";import"./Spinner.vue_vue_type_script_setup_true_lang-CDXeXNMx.js";import"./search-CIEtGgaw.js";const U={class:"p-4 space-y-4"},j={class:"flex items-center justify-between"},I={class:"flex items-center gap-3 mb-3"},M=["disabled"],z=["disabled"],G=["disabled"],H={class:"mt-4 flex items-center justify-end gap-2"},J=["disabled"],L=["disabled"],ne=T({__name:"Productions",props:{aggregates:{},meta:{}},setup(_){const v=[{title:"Summary",href:"/summary/productions"},{title:"Production Summary",href:"/summary/productions"}],t=_,s=p(!1),n=p(t.meta?.date_from??""),l=p(t.meta?.date_to??""),x=q(()=>t.aggregates?.data??[]),y=e=>{const a=t.meta?.per_page??20,o=t.meta?.sort??"total_output",d=t.meta?.direction??"desc";i.get(window.location.pathname,{q:e,per_page:a,sort:o,direction:d,date_from:n.value,date_to:l.value},{preserveState:!0,replace:!0})},S=({sort:e,direction:a})=>{const o=t.meta?.per_page??20,d=t.meta?.q??"";e&&i.get(window.location.pathname,{sort:e,direction:a??"desc",per_page:o,q:d,date_from:n.value,date_to:l.value},{preserveState:!0,replace:!0})},c=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 00:00:00`:null,m=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 23:59:59`:null,k=()=>{const e=t.meta?.per_page??20,a=t.meta?.sort??"total_output",o=t.meta?.direction??"desc";i.get(window.location.pathname,{date_from:c(n.value||null),date_to:m(l.value||null),q:t.meta?.q??"",sort:a,direction:o,per_page:e},{preserveState:!0,replace:!0})},w=()=>{const e=t.aggregates?.next_page;e&&i.visit(e,{preserveState:!0,replace:!0})},h=()=>{const e=t.aggregates?.prev_page;e&&i.visit(e,{preserveState:!0,replace:!0})},P=()=>{const e=new URLSearchParams;n.value&&e.append("date_from",c(n.value)||""),l.value&&e.append("date_to",m(l.value)||""),t.meta?.q&&e.append("q",t.meta.q),window.location.href=`/summary/productions/export?${e.toString()}`};return i.on("start",()=>s.value=!0),i.on("finish",()=>s.value=!1),(e,a)=>(N(),F(E,null,[u(g(C),{title:"Production Aggregates"}),u($,{breadcrumbs:v},{default:D(()=>[r("div",U,[r("div",j,[a[3]||(a[3]=r("div",null,[r("h2",{class:"text-2xl font-semibold"},"Production Aggregates"),r("p",{class:"text-sm text-muted-foreground"},"Aggregated output/target per production (sums across groups)")],-1)),r("button",{onClick:P,class:"btn-secondary flex items-center gap-2"},[u(g(B),{class:"size-4"}),a[2]||(a[2]=V(" Export to Excel ",-1))])]),r("div",I,[a[4]||(a[4]=r("label",{class:"text-sm"},"From",-1)),f(r("input",{type:"date",class:"input","onUpdate:modelValue":a[0]||(a[0]=o=>n.value=o),disabled:s.value},null,8,M),[[b,n.value]]),a[5]||(a[5]=r("label",{class:"text-sm"},"To",-1)),f(r("input",{type:"date",class:"input","onUpdate:modelValue":a[1]||(a[1]=o=>l.value=o),disabled:s.value},null,8,z),[[b,l.value]]),r("button",{class:"btn",onClick:k,disabled:s.value},"Apply",8,G)]),u(A,{serverMode:"",data:x.value,columns:[{key:"production_id",label:"ID",type:"number",sortable:!1,findable:!1},{key:"production_name",label:"Production",type:"string",sortable:!0,findable:!0},{key:"group_count",label:"Groups",type:"number",sortable:!0,findable:!1},{key:"total_target",label:"Target",type:"number",sortable:!0,findable:!1},{key:"total_output",label:"Output",type:"number",sortable:!0,findable:!1},{key:"variance",label:"Variance",type:"number",sortable:!1,findable:!1}],"per-page":20,"initial-sort":t.meta?.sort??"total_output","initial-direction":t.meta?.direction??"desc",loading:s.value,onServerSearch:y,onServerSort:S},null,8,["data","initial-sort","initial-direction","loading"]),r("div",H,[r("button",{class:"btn",disabled:!t.aggregates?.prev_page||s.value,onClick:h},"Previous",8,J),r("button",{class:"btn",disabled:!t.aggregates?.next_page||s.value,onClick:w},"Next",8,L)])])]),_:1})],64))}});export{ne as default};
