import{d as P,r as h,e as V,P as $,w as D,K as M,p as B,m as O,k as j,a as e,u as g,l as F,E as q,c as n,b as v,H as p,q as k,o as s,F as x,h as y,t as i,L,I as f,n as z,M as I,J as S}from"./app-ByVm3FOg.js";import{_ as A}from"./AppLayout.vue_vue_type_script_setup_true_lang-CA8oNPt4.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-C8rHliBE.js";import"./index-CbbRSED3.js";import"./VisuallyHidden-CuZB7xnA.js";import"./useForwardExpose-B_jyS2_j.js";import"./useForwardPropsEmits-DpcW7WWk.js";import"./index-C4J_hXM0.js";import"./createLucideIcon-B5wOFtcm.js";const H={class:"p-4 space-y-4"},J={class:"rounded-lg border border-sidebar-border/70 dark:border-sidebar-border/70 bg-card dark:bg-card p-6"},K={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Q=["value"],R={key:0,class:"text-center py-12 rounded-lg border border-dashed border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/20 dark:bg-muted/20"},W={key:1,class:"space-y-6"},X={class:"p-4 border-b border-sidebar-border/40 flex items-center justify-between"},Y={class:"text-xl font-bold"},Z={class:"text-sm text-muted-foreground dark:text-muted-foreground mt-1"},ee={key:0,class:"mx-2"},te={key:1},oe={class:"flex items-center gap-3"},re={class:"text-sm px-3 py-1 rounded-full bg-muted/60 dark:bg-muted/60"},ae=["onClick"],se={class:"p-6"},ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},de={class:"font-semibold text-base"},ue=["onUpdate:modelValue"],le={class:"text-xs text-muted-foreground dark:text-muted-foreground mt-1"},ie=["onUpdate:modelValue"],ce=["onUpdate:modelValue"],pe={key:2,class:"text-center py-12 rounded-lg border border-dashed border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/20 dark:bg-muted/20"},me={key:3,class:"flex items-center gap-3 pt-4"},be=["disabled"],Ce=P({__name:"Create",props:{productions:{}},setup(w){const T=[{title:"Data Management",href:"/data-management/production"},{title:"Targets",href:"/data-management/targets"},{title:"Create",href:window.location.pathname}],C=w,d=h(null),m=h(new Date().toISOString().split("T")[0]),U=V(()=>C.productions.find(a=>a.production_id===d.value)),_=V(()=>U.value?.machine_groups??[]),b=$({});D(_,a=>{a.forEach(t=>{b[t.production_machine_group_id]=!0})},{immediate:!0});function N(a){b[a]=!b[a]}const u=h({});D(d,a=>{if(!a){u.value={};return}const t=C.productions.find(r=>r.production_id===a);if(!t)return;const o={};t.machine_groups.forEach(r=>{o[r.production_machine_group_id]={},r.fields.forEach(l=>{o[r.production_machine_group_id][l]={field_name:l,target_value:r.default_targets[l]??null,actual_value:null,keterangan:null}})}),u.value=o});const c=M({production_id:null,date:m.value,machine_groups:[]});function E(){if(!d.value){alert("Please select a production");return}c.production_id=d.value,c.date=m.value,c.machine_groups=Object.entries(u.value).map(([a,t])=>({production_machine_group_id:Number(a),values:Object.values(t)})),c.post("/data-management/targets",{onSuccess:()=>{S.get(`/data-management/targets?production_id=${d.value}&date=${m.value}`)}})}function G(a){return a.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}return(a,t)=>(s(),B(A,{breadcrumbs:T},{default:O(()=>[j(g(F),{title:"Create Daily Targets"}),e("div",H,[t[13]||(t[13]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Create Daily Targets"),e("p",{class:"text-muted-foreground dark:text-muted-foreground"}," Set target values for all machine groups in a production for a specific date ")],-1)),e("form",{onSubmit:q(E,["prevent"]),class:"space-y-6"},[e("div",J,[t[6]||(t[6]=e("h2",{class:"text-lg font-semibold mb-4"},"Production & Date",-1)),e("div",K,[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium mb-2"},[k(" Select Production "),e("span",{class:"text-red-500"},"*")],-1)),p(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>d.value=o),required:"",class:"input w-full"},[t[3]||(t[3]=e("option",{value:null},"-- Choose Production --",-1)),(s(!0),n(x,null,y(w.productions,o=>(s(),n("option",{key:o.production_id,value:o.production_id},i(o.production_name),9,Q))),128))],512),[[L,d.value,void 0,{number:!0}]])]),e("div",null,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium mb-2"},[k(" Target Date "),e("span",{class:"text-red-500"},"*")],-1)),p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>m.value=o),type:"date",required:"",class:"input w-full"},null,512),[[f,m.value]])])])]),d.value?_.value.length>0?(s(),n("div",W,[(s(!0),n(x,null,y(_.value,o=>(s(),n("div",{key:o.production_machine_group_id,class:"rounded-lg border border-sidebar-border/70 dark:border-sidebar-border/70 bg-card dark:bg-card"},[e("div",X,[e("div",null,[e("h3",Y,i(o.name),1),e("p",Z,[k(i(o.machineGroup.name)+" ",1),o.machineGroup.description?(s(),n("span",ee,"â€¢")):v("",!0),o.machineGroup.description?(s(),n("span",te,i(o.machineGroup.description),1)):v("",!0)])]),e("div",oe,[e("span",re,i(o.machine_count)+" machines ",1),e("button",{type:"button",class:"btn btn-ghost",onClick:r=>N(o.production_machine_group_id)},[(s(),n("svg",{xmlns:"http://www.w3.org/2000/svg",class:z(["h-4 w-4 transition-transform",{"rotate-180":!b[o.production_machine_group_id]}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...t[8]||(t[8]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,ae)])]),p(e("div",se,[e("div",ne,[(s(!0),n(x,null,y(o.fields,r=>(s(),n("div",{key:`${o.production_machine_group_id}-${r}`,class:"rounded-lg bg-muted/40 dark:bg-muted/40 p-4 space-y-3"},[e("h4",de,i(G(r)),1),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium mb-1.5"}," Target Value ",-1)),p(e("input",{"onUpdate:modelValue":l=>u.value[o.production_machine_group_id][r].target_value=l,type:"number",min:"0",placeholder:"Enter target",class:"input w-full"},null,8,ue),[[f,u.value[o.production_machine_group_id][r].target_value,void 0,{number:!0}]]),e("p",le," Default: "+i(o.default_targets[r]??"None"),1)]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium mb-1.5"}," Actual Output ",-1)),p(e("input",{"onUpdate:modelValue":l=>u.value[o.production_machine_group_id][r].actual_value=l,type:"number",min:"0",placeholder:"Enter actual",class:"input w-full"},null,8,ie),[[f,u.value[o.production_machine_group_id][r].actual_value,void 0,{number:!0}]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium mb-1.5"}," Notes ",-1)),p(e("textarea",{"onUpdate:modelValue":l=>u.value[o.production_machine_group_id][r].keterangan=l,placeholder:"Optional notes",rows:"2",class:"input w-full resize-none"},null,8,ce),[[f,u.value[o.production_machine_group_id][r].keterangan]])])]))),128))])],512),[[I,b[o.production_machine_group_id]]])]))),128))])):d.value?(s(),n("div",pe,[...t[12]||(t[12]=[e("p",{class:"text-muted-foreground dark:text-muted-foreground"}," No machine groups found for this production ",-1)])])):v("",!0):(s(),n("div",R,[...t[7]||(t[7]=[e("p",{class:"text-muted-foreground dark:text-muted-foreground"}," Please select a production to configure daily targets ",-1)])])),d.value&&_.value.length>0?(s(),n("div",me,[e("button",{type:"submit",class:"btn cursor-pointer",disabled:g(c).processing},i(g(c).processing?"Saving...":"Save Daily Targets"),9,be),e("button",{type:"button",class:"btn btn-ghost",onClick:t[2]||(t[2]=o=>g(S).get("/data-management/targets"))}," Cancel ")])):v("",!0)],32)])]),_:1}))}});export{Ce as default};
