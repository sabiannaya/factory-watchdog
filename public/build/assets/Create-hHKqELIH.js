import{d as F,g as y,f as w,a5 as L,x as S,v as M,e as N,w as m,m as _,a as e,u,p as q,y as A,c as n,b as h,q as C,t as c,o as s,F as D,i as $,z as f,L as x,n as I,N as H,B as T}from"./app-BRuhaguS.js";import{a as J,b as K,c as Q,d as U,_ as R}from"./AppLayout.vue_vue_type_script_setup_true_lang-BSta2Xg1.js";import{C as W}from"./chevron-down-Bi0ueEnd.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DrUmFdxY.js";import"./Presence-CRPloLVK.js";import"./createLucideIcon-Bc86gjbu.js";import"./useForwardPropsEmits-CxMGla6T.js";import"./x-Dz_x2_zF.js";import"./VisuallyHidden-gDrgz296.js";import"./index-C4J_hXM0.js";const X={class:"p-4 space-y-4"},Y={class:"rounded-lg border border-sidebar-border/70 dark:border-sidebar-border/70 bg-card dark:bg-card p-6"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ee={type:"button",class:"input w-full flex items-center justify-between",required:""},te={class:"truncate"},oe=["onClick"],re={key:0,class:"text-center py-12 rounded-lg border border-dashed border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/20 dark:bg-muted/20"},ae={key:1,class:"space-y-6"},se={class:"p-4 border-b border-sidebar-border/40 flex items-center justify-between"},ne={class:"text-xl font-bold"},de={class:"text-sm text-muted-foreground dark:text-muted-foreground mt-1"},ue={key:0,class:"mx-2"},le={key:1},ie={class:"flex items-center gap-3"},ce={class:"text-sm px-3 py-1 rounded-full bg-muted/60 dark:bg-muted/60"},pe=["onClick"],me={class:"p-6"},_e={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},be={class:"font-semibold text-base"},ge=["onUpdate:modelValue"],fe={class:"text-xs text-muted-foreground dark:text-muted-foreground mt-1"},ve=["onUpdate:modelValue"],he=["onUpdate:modelValue"],xe={key:2,class:"text-center py-12 rounded-lg border border-dashed border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/20 dark:bg-muted/20"},ke={key:3,class:"flex items-center gap-3 pt-4"},ye=["disabled"],Ge=F({__name:"Create",props:{productions:{}},setup(V){const G=[{title:"Data Management",href:"/data-management/production"},{title:"Targets",href:"/data-management/targets"},{title:"Create",href:window.location.pathname}],k=V,d=y(null),b=y(new Date().toISOString().split("T")[0]),B=w(()=>{if(!d.value)return"-- Choose Production --";const r=k.productions.find(t=>t.production_id===d.value);return r?r.production_name:"-- Choose Production --"}),P=r=>{d.value=r},E=w(()=>k.productions.find(r=>r.production_id===d.value)),v=w(()=>E.value?.machine_groups??[]),g=L({});S(v,r=>{r.forEach(t=>{g[t.production_machine_group_id]=!0})},{immediate:!0});function j(r){g[r]=!g[r]}const l=y({});S(d,r=>{if(!r){l.value={};return}const t=k.productions.find(a=>a.production_id===r);if(!t)return;const o={};t.machine_groups.forEach(a=>{o[a.production_machine_group_id]={},a.fields.forEach(i=>{o[a.production_machine_group_id][i]={field_name:i,target_value:a.default_targets[i]??null,actual_value:null,keterangan:null}})}),l.value=o});const p=M({production_id:null,date:b.value,machine_groups:[]});function O(){if(!d.value){alert("Please select a production");return}p.production_id=d.value,p.date=b.value,p.machine_groups=Object.entries(l.value).map(([r,t])=>({production_machine_group_id:Number(r),values:Object.values(t)})),p.post("/data-management/targets",{onSuccess:()=>{T.get(`/data-management/targets?production_id=${d.value}&date=${b.value}`)}})}function z(r){return r.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())}return(r,t)=>(s(),N(R,{breadcrumbs:G},{default:m(()=>[_(u(q),{title:"Create Daily Targets"}),e("div",X,[t[12]||(t[12]=e("div",null,[e("h1",{class:"text-3xl font-bold"},"Create Daily Targets"),e("p",{class:"text-muted-foreground dark:text-muted-foreground"}," Set target values for all machine groups in a production for a specific date ")],-1)),e("form",{onSubmit:A(O,["prevent"]),class:"space-y-6"},[e("div",Y,[t[5]||(t[5]=e("h2",{class:"text-lg font-semibold mb-4"},"Production & Date",-1)),e("div",Z,[e("div",null,[t[3]||(t[3]=e("label",{class:"block text-sm font-medium mb-2"},[C(" Select Production "),e("span",{class:"text-red-500"},"*")],-1)),_(u(J),null,{default:m(()=>[_(u(K),{"as-child":!0},{default:m(()=>[e("button",ee,[e("span",te,c(B.value),1),_(u(W),{class:"ml-2 size-4"})])]),_:1}),_(u(Q),{class:"min-w-[12rem]"},{default:m(()=>[_(u(U),{"as-child":!0},{default:m(()=>[e("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:t[0]||(t[0]=o=>P(null))},"-- Choose Production --")]),_:1}),(s(!0),n(D,null,$(V.productions,o=>(s(),N(u(U),{key:o.production_id,"as-child":!0},{default:m(()=>[e("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:a=>P(o.production_id)},c(o.production_name),9,oe)]),_:2},1024))),128))]),_:1})]),_:1})]),e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium mb-2"},[C(" Target Date "),e("span",{class:"text-red-500"},"*")],-1)),f(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>b.value=o),type:"date",required:"",class:"input w-full"},null,512),[[x,b.value]])])])]),d.value?v.value.length>0?(s(),n("div",ae,[(s(!0),n(D,null,$(v.value,o=>(s(),n("div",{key:o.production_machine_group_id,class:"rounded-lg border border-sidebar-border/70 dark:border-sidebar-border/70 bg-card dark:bg-card"},[e("div",se,[e("div",null,[e("h3",ne,c(o.name),1),e("p",de,[C(c(o.machineGroup.name)+" ",1),o.machineGroup.description?(s(),n("span",ue,"â€¢")):h("",!0),o.machineGroup.description?(s(),n("span",le,c(o.machineGroup.description),1)):h("",!0)])]),e("div",ie,[e("span",ce,c(o.machine_count)+" machines ",1),e("button",{type:"button",class:"btn btn-ghost",onClick:a=>j(o.production_machine_group_id)},[(s(),n("svg",{xmlns:"http://www.w3.org/2000/svg",class:I(["h-4 w-4 transition-transform",{"rotate-180":!g[o.production_machine_group_id]}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...t[7]||(t[7]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,pe)])]),f(e("div",me,[e("div",_e,[(s(!0),n(D,null,$(o.fields,a=>(s(),n("div",{key:`${o.production_machine_group_id}-${a}`,class:"rounded-lg bg-muted/40 dark:bg-muted/40 p-4 space-y-3"},[e("h4",be,c(z(a)),1),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium mb-1.5"}," Target Value ",-1)),f(e("input",{"onUpdate:modelValue":i=>l.value[o.production_machine_group_id][a].target_value=i,type:"number",min:"0",placeholder:"Enter target",class:"input w-full"},null,8,ge),[[x,l.value[o.production_machine_group_id][a].target_value,void 0,{number:!0}]]),e("p",fe," Default: "+c(o.default_targets[a]??"None"),1)]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium mb-1.5"}," Actual Output ",-1)),f(e("input",{"onUpdate:modelValue":i=>l.value[o.production_machine_group_id][a].actual_value=i,type:"number",min:"0",placeholder:"Enter actual",class:"input w-full"},null,8,ve),[[x,l.value[o.production_machine_group_id][a].actual_value,void 0,{number:!0}]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium mb-1.5"}," Notes ",-1)),f(e("textarea",{"onUpdate:modelValue":i=>l.value[o.production_machine_group_id][a].keterangan=i,placeholder:"Optional notes",rows:"2",class:"input w-full resize-none"},null,8,he),[[x,l.value[o.production_machine_group_id][a].keterangan]])])]))),128))])],512),[[H,g[o.production_machine_group_id]]])]))),128))])):d.value?(s(),n("div",xe,[...t[11]||(t[11]=[e("p",{class:"text-muted-foreground dark:text-muted-foreground"}," No machine groups found for this production ",-1)])])):h("",!0):(s(),n("div",re,[...t[6]||(t[6]=[e("p",{class:"text-muted-foreground dark:text-muted-foreground"}," Please select a production to configure daily targets ",-1)])])),d.value&&v.value.length>0?(s(),n("div",ke,[e("button",{type:"submit",class:"hover:cursor-pointer btn",disabled:u(p).processing},c(u(p).processing?"Saving...":"Save Daily Targets"),9,ye),e("button",{type:"button",class:"btn btn-ghost",onClick:t[2]||(t[2]=o=>u(T).get("/data-management/targets"))}," Cancel ")])):h("",!0)],32)])]),_:1}))}});export{Ge as default};
