import{U as F,a as L,b as G,c as I,d as $,S as H,_ as J}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNNNqqjX.js";import{d as K,g as x,f as g,x as O,l as Q,B as i,c as d,m as a,u as l,p as W,w as f,a as e,q as b,t as m,o as r,F as v,i as A,e as y,b as h,n as X}from"./app-D4NX6RtZ.js";import{_ as k,P as Y}from"./IconActionButton.vue_vue_type_script_setup_true_lang-DJGF6nNE.js";import{_ as Z}from"./Input.vue_vue_type_script_setup_true_lang-BWEJuRad.js";import{_ as ee}from"./Spinner.vue_vue_type_script_setup_true_lang-BqsWXN44.js";import{_ as te}from"./ToastNotifications.vue_vue_type_script_setup_true_lang-BMk0SZx-.js";import{u as se}from"./useToast-aH6RW4y0.js";import{U as oe}from"./user-plus-D0fcukFE.js";import{C as le}from"./chevron-down-D-IdcPDr.js";import{E as ae}from"./eye-YncoTxWj.js";import{T as re}from"./trash-2-BIBKvKRy.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BzC2dvNG.js";import"./Presence-CsGVf8pY.js";import"./createLucideIcon-A0T1vukc.js";import"./useForwardPropsEmits-BmzqlngZ.js";import"./x-XD7JAbQb.js";import"./VisuallyHidden-BeURpiPp.js";import"./index-C4J_hXM0.js";const ne={class:"p-4"},ie={class:"flex items-center justify-between"},de={class:"text-2xl font-semibold flex items-center gap-2"},ue={class:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},ce={type:"button",class:"input w-full flex items-center justify-between"},me={class:"truncate"},pe=["onClick"],fe={class:"relative"},_e={class:"mt-4"},xe={class:"overflow-x-auto rounded-lg border"},ge={class:"w-full table-auto border-collapse"},be={class:"px-4 py-3 text-sm font-medium"},ve={class:"px-4 py-3 text-sm text-muted-foreground"},ye={class:"px-4 py-3 text-sm"},he={class:"px-4 py-3 text-sm"},ke={key:0,class:"text-muted-foreground italic"},we={key:1},Ce={class:"px-4 py-3 text-sm"},Se={key:0,class:"text-muted-foreground italic"},$e={key:1,class:"text-muted-foreground italic"},Ae={class:"px-4 py-3 text-sm text-muted-foreground"},Re={class:"px-4 py-3 text-sm"},Ue={class:"flex items-center gap-3"},Ne={key:0},Pe={class:"mt-4 flex items-center justify-end gap-2"},Te=["disabled"],Ve=["disabled"],Ze=K({__name:"Index",props:{users:{},roles:{},meta:{}},setup(R){const U=[{title:"Admin",href:"/admin/users"},{title:"Users",href:"/admin/users"}],p=x(!1),{toasts:N,dismiss:P}=se(),n=R,w=g(()=>n.users?.data??[]),C=g(()=>n.roles??[]),u=x(n.meta?.q??""),c=x(n.meta?.role_id??"");let _;const T=g(()=>{if(!c.value)return"All Roles";const t=C.value.find(s=>String(s.role_id)===String(c.value));return t?t.name:"All Roles"}),S=t=>{c.value=t||"",D()},V=()=>{const t=n.meta?.per_page??10;i.get("/admin/users",{q:u.value||null,role_id:c.value||null,per_page:t},{preserveState:!0,replace:!0})},D=()=>{const t=n.meta?.per_page??10;i.get("/admin/users",{q:u.value||null,role_id:c.value||null,per_page:t},{preserveState:!0,replace:!0})};O(u,()=>{_&&clearTimeout(_),_=setTimeout(V,500)});const q=()=>{const t=n.users?.next_cursor;t&&i.get("/admin/users",{cursor:t,role_id:c.value||null,q:u.value||null},{preserveState:!0,replace:!0})},B=()=>{const t=n.users?.prev_cursor;t&&i.get("/admin/users",{cursor:t,role_id:c.value||null,q:u.value||null},{preserveState:!0,replace:!0})},E=t=>i.get(`/admin/users/${t}`),z=t=>i.get(`/admin/users/${t}/edit`),M=t=>{window.confirm("Are you sure you want to delete this user?")&&i.delete(`/admin/users/${t}`,{preserveState:!1})};Q(()=>{i.on("start",()=>p.value=!0),i.on("finish",()=>p.value=!1)});const j=t=>t==="super"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":t==="staff"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";return(t,s)=>(r(),d(v,null,[a(l(W),{title:"User Management"}),a(te,{toasts:l(N),onDismiss:l(P)},null,8,["toasts","onDismiss"]),a(J,{breadcrumbs:U},{default:f(()=>[e("div",ne,[e("div",ie,[e("div",null,[e("h2",de,[a(l(F),{class:"size-6"}),s[3]||(s[3]=b(" User Management ",-1))]),s[4]||(s[4]=e("p",{class:"text-sm text-muted-foreground"},"Manage users, roles, and production assignments",-1))]),e("button",{onClick:s[0]||(s[0]=o=>l(i).get("/admin/users/create")),class:"btn flex items-center gap-2 rounded-md shadow-sm transition-all duration-150 hover:opacity-90 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-black/10 dark:focus:ring-white/20"},[a(l(oe),{class:"size-4"}),s[5]||(s[5]=b(" Add User ",-1))])]),e("div",ue,[e("div",null,[s[6]||(s[6]=e("label",{class:"block text-sm font-medium mb-2"},"Role Filter",-1)),a(l(L),null,{default:f(()=>[a(l(G),{"as-child":!0},{default:f(()=>[e("button",ce,[e("span",me,m(T.value),1),a(l(le),{class:"ml-2 size-4"})])]),_:1}),a(l(I),{class:"min-w-[12rem]"},{default:f(()=>[a(l($),{"as-child":!0},{default:f(()=>[e("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:s[1]||(s[1]=o=>S(""))},"All Roles")]),_:1}),(r(!0),d(v,null,A(C.value,o=>(r(),y(l($),{key:o.role_id,"as-child":!0},{default:f(()=>[e("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:De=>S(o.role_id)},m(o.name),9,pe)]),_:2},1024))),128))]),_:1})]),_:1})]),e("div",null,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium mb-2"},"Search",-1)),e("div",fe,[a(l(Z),{modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=o=>u.value=o),disabled:p.value,type:"search",placeholder:"Search by name or email...",class:"w-full"},null,8,["modelValue","disabled"]),p.value?(r(),y(l(ee),{key:0,class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground"})):h("",!0)])])]),e("div",_e,[e("div",xe,[e("table",ge,[s[9]||(s[9]=e("thead",{class:"bg-muted/50"},[e("tr",{class:"text-left"},[e("th",{class:"px-4 py-3 text-sm font-medium"},"Name"),e("th",{class:"px-4 py-3 text-sm font-medium"},"Email"),e("th",{class:"px-4 py-3 text-sm font-medium"},"Role"),e("th",{class:"px-4 py-3 text-sm font-medium"},"Assigned Productions"),e("th",{class:"px-4 py-3 text-sm font-medium"},"Glue Spreaders"),e("th",{class:"px-4 py-3 text-sm font-medium"},"Created"),e("th",{class:"px-4 py-3 text-sm font-medium"},"Actions")])],-1)),e("tbody",null,[(r(!0),d(v,null,A(w.value,o=>(r(),d("tr",{key:o.id,class:"border-t hover:bg-muted/30 transition-colors"},[e("td",be,m(o.name),1),e("td",ve,m(o.email),1),e("td",ye,[e("span",{class:X(["inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",j(o.role_slug)])},[o.role_slug==="super"?(r(),y(l(H),{key:0,class:"size-3"})):h("",!0),b(" "+m(o.role_name),1)],2)]),e("td",he,[o.role_slug==="super"?(r(),d("span",ke,"All")):(r(),d("span",we,m(o.productions_count)+" production(s)",1))]),e("td",Ce,[o.role_slug==="super"?(r(),d("span",Se,"All")):(r(),d("span",$e,"All"))]),e("td",Ae,m(o.created_at),1),e("td",Re,[e("div",Ue,[a(k,{icon:l(ae),label:"View",color:"blue",onClick:()=>E(o.id)},null,8,["icon","onClick"]),a(k,{icon:l(Y),label:"Edit",color:"amber",onClick:()=>z(o.id)},null,8,["icon","onClick"]),a(k,{icon:l(re),label:"Delete",color:"red",onClick:()=>M(o.id)},null,8,["icon","onClick"])])])]))),128)),w.value.length===0?(r(),d("tr",Ne,[...s[8]||(s[8]=[e("td",{colspan:"7",class:"px-4 py-8 text-center text-sm text-muted-foreground"},' No users found. Click "Add User" to create one. ',-1)])])):h("",!0)])])]),e("div",Pe,[e("button",{class:"btn-secondary rounded-md px-4 py-2 text-sm transition-all duration-150 hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!n.users?.prev_cursor||p.value,onClick:B}," Previous ",8,Te),e("button",{class:"btn-secondary rounded-md px-4 py-2 text-sm transition-all duration-150 hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!n.users?.next_cursor||p.value,onClick:q}," Next ",8,Ve)])])])]),_:1})],64))}});export{Ze as default};
