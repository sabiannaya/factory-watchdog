import{d as V,f as v,g as b,B as p,c as d,m as g,u as a,p as $,w as h,a as s,t as l,q as k,z as x,L as q,o as _,n as z,F as S}from"./app-i1_2c9TI.js";import{_ as B}from"./AppLayout.vue_vue_type_script_setup_true_lang-UWREGGXY.js";import{_ as E}from"./DataTable.vue_vue_type_script_setup_true_lang-D5Bbd2Ot.js";import{u as M}from"./AppLogoIcon.vue_vue_type_script_setup_true_lang-B0bB4Y56.js";import{F as U}from"./file-down-bpwgZGX2.js";import"./VisuallyHidden-CgfYLdxu.js";import"./index-C4J_hXM0.js";import"./x-T-BkQ4N0.js";import"./Input.vue_vue_type_script_setup_true_lang-mGQONf2a.js";import"./Spinner.vue_vue_type_script_setup_true_lang-Ca7klY01.js";import"./search-BWjjXBCD.js";const G={class:"p-4 space-y-4"},R={class:"flex items-center justify-between"},A={class:"text-2xl font-semibold"},H={class:"text-sm text-muted-foreground"},I={class:"flex items-center gap-3 mb-3"},J={class:"text-sm"},K=["disabled"],O={class:"text-sm"},Q=["disabled"],W=["disabled"],X={key:0,class:"font-medium"},Y={key:1,class:"text-red-500 font-medium"},Z={key:2,class:"font-medium"},ee={key:3,class:"text-muted-foreground"},te={class:"mt-4 flex items-center justify-end gap-2"},ae=["disabled"],re=["disabled"],ge=V({__name:"MachineGroups",props:{aggregates:{},meta:{}},setup(j){const{t}=M(),N=v(()=>[{title:t("summary.title"),href:"/summary/machine-groups"},{title:t("summary.machine_groups_title"),href:"/summary/machine-groups"}]),r=j,u=b(!1),c=b(r.meta?.date_from??""),m=b(r.meta?.date_to??""),L=v(()=>r.aggregates?.data??[]),T=e=>{const n=r.meta?.per_page??20,o=r.meta?.sort??"total_output",i=r.meta?.direction??"desc";p.get(window.location.pathname,{q:e,per_page:n,sort:o,direction:i,date_from:c.value,date_to:m.value},{preserveState:!0,replace:!0})},w=({sort:e,direction:n})=>{const o=r.meta?.per_page??20,i=r.meta?.q??"";e&&p.get(window.location.pathname,{sort:e,direction:n??"desc",per_page:o,q:i,date_from:c.value,date_to:m.value},{preserveState:!0,replace:!0})},f=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 00:00:00`:null,y=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 23:59:59`:null,C=()=>{const e=r.meta?.per_page??20,n=r.meta?.sort??"total_output",o=r.meta?.direction??"desc";p.get(window.location.pathname,{date_from:f(c.value||null),date_to:y(m.value||null),q:r.meta?.q??"",sort:n,direction:o,per_page:e},{preserveState:!0,replace:!0})},D=()=>{const e=r.aggregates?.next_page;e&&p.visit(e,{preserveState:!0,replace:!0})},F=()=>{const e=r.aggregates?.prev_page;e&&p.visit(e,{preserveState:!0,replace:!0})},P=()=>{const e=new URLSearchParams;c.value&&e.append("date_from",f(c.value)||""),m.value&&e.append("date_to",y(m.value)||""),r.meta?.q&&e.append("q",r.meta.q),window.location.href=`/summary/machine-groups/export?${e.toString()}`};return p.on("start",()=>u.value=!0),p.on("finish",()=>u.value=!1),(e,n)=>(_(),d(S,null,[g(a($),{title:a(t)("summary.machine_groups_title")},null,8,["title"]),g(B,{breadcrumbs:N.value},{default:h(()=>[s("div",G,[s("div",R,[s("div",null,[s("h2",A,l(a(t)("summary.machine_groups_title")),1),s("p",H,l(a(t)("summary.machine_groups_description")),1)]),s("button",{onClick:P,class:"btn-secondary flex items-center gap-2"},[g(a(U),{class:"size-4"}),k(" "+l(a(t)("app.export")),1)])]),s("div",I,[s("label",J,l(a(t)("app.from")),1),x(s("input",{type:"date",class:"input","onUpdate:modelValue":n[0]||(n[0]=o=>c.value=o),disabled:u.value},null,8,K),[[q,c.value]]),s("label",O,l(a(t)("app.to")),1),x(s("input",{type:"date",class:"input","onUpdate:modelValue":n[1]||(n[1]=o=>m.value=o),disabled:u.value},null,8,Q),[[q,m.value]]),s("button",{class:"hover:cursor-pointer btn",onClick:C,disabled:u.value},l(a(t)("app.apply")),9,W)]),g(E,{serverMode:"",data:L.value,columns:[{key:"machine_group_name",label:a(t)("summary.machine_group"),type:"string",sortable:!0,findable:!0},{key:"production_name",label:a(t)("summary.production"),type:"string",sortable:!0,findable:!0},{key:"machine_count",label:a(t)("summary.machines"),type:"number",sortable:!0,findable:!1},{key:"total_output_qty_normal",label:a(t)("summary.actual_normal"),type:"number",sortable:!0,findable:!1},{key:"total_output_qty_reject",label:a(t)("summary.actual_reject"),type:"number",sortable:!0,findable:!1},{key:"total_target_qty_normal",label:a(t)("summary.target_normal"),type:"number",sortable:!0,findable:!1},{key:"total_target_qty_reject",label:a(t)("summary.target_reject"),type:"number",sortable:!0,findable:!1},{key:"total_output",label:a(t)("summary.actual_total"),type:"number",sortable:!0,findable:!1},{key:"total_target",label:a(t)("summary.target_total"),type:"number",sortable:!0,findable:!1},{key:"variance",label:a(t)("summary.variance"),type:"number",sortable:!1,findable:!1}],"per-page":20,"initial-sort":r.meta?.sort??"total_output","initial-direction":r.meta?.direction??"desc",loading:u.value,onServerSearch:T,onServerSort:w},{cell:h(({row:o,column:i})=>[i.key==="total_output_qty_normal"?(_(),d("span",X,l(Number(o.total_output_qty_normal??0).toLocaleString()),1)):i.key==="total_output_qty_reject"?(_(),d("span",Y,l(Number(o.total_output_qty_reject??0).toLocaleString()),1)):i.key==="total_target_qty_normal"?(_(),d("span",Z,l(Number(o.total_target_qty_normal??0).toLocaleString()),1)):i.key==="total_target_qty_reject"?(_(),d("span",ee,l(Number(o.total_target_qty_reject??0).toLocaleString()),1)):i.key==="variance"?(_(),d("span",{key:4,class:z((o.variance??0)>=0?"text-emerald-600 font-medium":"text-red-600 font-medium")},l((o.variance>=0?"+":"")+Number(o.variance??0).toLocaleString()),3)):(_(),d(S,{key:5},[k(l(o[i.key]),1)],64))]),_:1},8,["data","columns","initial-sort","initial-direction","loading"]),s("div",te,[s("button",{class:"hover:cursor-pointer btn",disabled:!r.aggregates?.prev_page||u.value,onClick:F},l(a(t)("app.previous")),9,ae),s("button",{class:"hover:cursor-pointer btn",disabled:!r.aggregates?.next_page||u.value,onClick:D},l(a(t)("app.next")),9,re)])])]),_:1},8,["breadcrumbs"])],64))}});export{ge as default};
