import{d as L,g as _,f as P,B as u,c as p,m,u as b,p as D,w as y,a as o,q as v,z as h,L as x,o as d,t as c,n as V,F as k}from"./app-D4NX6RtZ.js";import{_ as E}from"./AppLayout.vue_vue_type_script_setup_true_lang-CNNNqqjX.js";import{_ as G}from"./DataTable.vue_vue_type_script_setup_true_lang-bzC7JgnF.js";import{F as $}from"./file-down-B0oRyUMZ.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BzC2dvNG.js";import"./Presence-CsGVf8pY.js";import"./createLucideIcon-A0T1vukc.js";import"./useForwardPropsEmits-BmzqlngZ.js";import"./x-XD7JAbQb.js";import"./VisuallyHidden-BeURpiPp.js";import"./index-C4J_hXM0.js";import"./Input.vue_vue_type_script_setup_true_lang-BWEJuRad.js";import"./Spinner.vue_vue_type_script_setup_true_lang-BqsWXN44.js";import"./search-DA59VARU.js";const A={class:"p-4 space-y-4"},B={class:"flex items-center justify-between"},z={class:"flex items-center gap-3 mb-3"},O=["disabled"],R=["disabled"],U=["disabled"],H={key:0,class:"font-medium"},I={key:1,class:"text-red-500 font-medium"},J={key:2,class:"font-medium"},K={key:3,class:"text-muted-foreground"},Q={class:"mt-4 flex items-center justify-end gap-2"},W=["disabled"],X=["disabled"],ce=L({__name:"MachineGroups",props:{aggregates:{},meta:{}},setup(S){const q=[{title:"Summary",href:"/summary/machine-groups"},{title:"Machine Group Summary",href:"/summary/machine-groups"}],t=S,n=_(!1),l=_(t.meta?.date_from??""),i=_(t.meta?.date_to??""),T=P(()=>t.aggregates?.data??[]),N=e=>{const a=t.meta?.per_page??20,r=t.meta?.sort??"total_output",s=t.meta?.direction??"desc";u.get(window.location.pathname,{q:e,per_page:a,sort:r,direction:s,date_from:l.value,date_to:i.value},{preserveState:!0,replace:!0})},j=({sort:e,direction:a})=>{const r=t.meta?.per_page??20,s=t.meta?.q??"";e&&u.get(window.location.pathname,{sort:e,direction:a??"desc",per_page:r,q:s,date_from:l.value,date_to:i.value},{preserveState:!0,replace:!0})},g=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 00:00:00`:null,f=e=>e?e.includes("T")?e.replace("T"," ")+":00":`${e} 23:59:59`:null,M=()=>{const e=t.meta?.per_page??20,a=t.meta?.sort??"total_output",r=t.meta?.direction??"desc";u.get(window.location.pathname,{date_from:g(l.value||null),date_to:f(i.value||null),q:t.meta?.q??"",sort:a,direction:r,per_page:e},{preserveState:!0,replace:!0})},w=()=>{const e=t.aggregates?.next_page;e&&u.visit(e,{preserveState:!0,replace:!0})},C=()=>{const e=t.aggregates?.prev_page;e&&u.visit(e,{preserveState:!0,replace:!0})},F=()=>{const e=new URLSearchParams;l.value&&e.append("date_from",g(l.value)||""),i.value&&e.append("date_to",f(i.value)||""),t.meta?.q&&e.append("q",t.meta.q),window.location.href=`/summary/machine-groups/export?${e.toString()}`};return u.on("start",()=>n.value=!0),u.on("finish",()=>n.value=!1),(e,a)=>(d(),p(k,null,[m(b(D),{title:"Machine Group Aggregates"}),m(E,{breadcrumbs:q},{default:y(()=>[o("div",A,[o("div",B,[a[3]||(a[3]=o("div",null,[o("h2",{class:"text-2xl font-semibold"},"Machine Group Aggregates"),o("p",{class:"text-sm text-muted-foreground"},"Aggregated output per machine group (sums across machines)")],-1)),o("button",{onClick:F,class:"btn-secondary flex items-center gap-2"},[m(b($),{class:"size-4"}),a[2]||(a[2]=v(" Export to Excel ",-1))])]),o("div",z,[a[4]||(a[4]=o("label",{class:"text-sm"},"From",-1)),h(o("input",{type:"date",class:"input","onUpdate:modelValue":a[0]||(a[0]=r=>l.value=r),disabled:n.value},null,8,O),[[x,l.value]]),a[5]||(a[5]=o("label",{class:"text-sm"},"To",-1)),h(o("input",{type:"date",class:"input","onUpdate:modelValue":a[1]||(a[1]=r=>i.value=r),disabled:n.value},null,8,R),[[x,i.value]]),o("button",{class:"hover:cursor-pointer btn",onClick:M,disabled:n.value},"Apply",8,U)]),m(G,{serverMode:"",data:T.value,columns:[{key:"machine_group_name",label:"Machine Group",type:"string",sortable:!0,findable:!0},{key:"production_name",label:"Production",type:"string",sortable:!0,findable:!0},{key:"machine_count",label:"Machines",type:"number",sortable:!0,findable:!1},{key:"total_output_qty_normal",label:"Normal Output",type:"number",sortable:!0,findable:!1},{key:"total_output_qty_reject",label:"Rejected Output",type:"number",sortable:!0,findable:!1},{key:"total_target_qty_normal",label:"Normal Target",type:"number",sortable:!0,findable:!1},{key:"total_target_qty_reject",label:"Rejected Target",type:"number",sortable:!0,findable:!1},{key:"total_output",label:"Total Output",type:"number",sortable:!0,findable:!1},{key:"total_target",label:"Total Target",type:"number",sortable:!0,findable:!1},{key:"variance",label:"Variance",type:"number",sortable:!1,findable:!1}],"per-page":20,"initial-sort":t.meta?.sort??"total_output","initial-direction":t.meta?.direction??"desc",loading:n.value,onServerSearch:N,onServerSort:j},{cell:y(({row:r,column:s})=>[s.key==="total_output_qty_normal"?(d(),p("span",H,c(Number(r.total_output_qty_normal??0).toLocaleString()),1)):s.key==="total_output_qty_reject"?(d(),p("span",I,c(Number(r.total_output_qty_reject??0).toLocaleString()),1)):s.key==="total_target_qty_normal"?(d(),p("span",J,c(Number(r.total_target_qty_normal??0).toLocaleString()),1)):s.key==="total_target_qty_reject"?(d(),p("span",K,c(Number(r.total_target_qty_reject??0).toLocaleString()),1)):s.key==="variance"?(d(),p("span",{key:4,class:V((r.variance??0)>=0?"text-emerald-600 font-medium":"text-red-600 font-medium")},c((r.variance>=0?"+":"")+Number(r.variance??0).toLocaleString()),3)):(d(),p(k,{key:5},[v(c(r[s.key]),1)],64))]),_:1},8,["data","initial-sort","initial-direction","loading"]),o("div",Q,[o("button",{class:"hover:cursor-pointer btn",disabled:!t.aggregates?.prev_page||n.value,onClick:C},"Previous",8,W),o("button",{class:"hover:cursor-pointer btn",disabled:!t.aggregates?.next_page||n.value,onClick:w},"Next",8,X)])])]),_:1})],64))}});export{ce as default};
