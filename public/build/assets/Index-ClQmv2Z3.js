import{d as V,g,l as I,k as L,O as M,f as S,x as j,B as P,e as D,w as c,m as d,a as e,u as o,p as E,c as i,b as B,j as F,t as l,o as n,F as w,i as y,z as O,X as W,L as q,s as U,q as H}from"./app-BRuhaguS.js";import{a as X,b as A,c as J,d as G,e as K,_ as Q}from"./AppLayout.vue_vue_type_script_setup_true_lang-BSta2Xg1.js";import{_ as Y,P as Z}from"./IconActionButton.vue_vue_type_script_setup_true_lang-DuEfKw9g.js";import{C as ee}from"./chevron-down-Bi0ueEnd.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-DrUmFdxY.js";import"./Presence-CRPloLVK.js";import"./createLucideIcon-Bc86gjbu.js";import"./useForwardPropsEmits-CxMGla6T.js";import"./x-Dz_x2_zF.js";import"./VisuallyHidden-gDrgz296.js";import"./index-C4J_hXM0.js";const te={class:"p-4 space-y-4"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},oe={class:"truncate"},se=["onClick"],ae={class:"relative"},ne={key:0,class:"text-center py-12 rounded-lg border border-dashed border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/20 dark:bg-muted/20"},de={key:1,class:"space-y-6"},ie={class:"flex justify-between items-start mb-6"},le={class:"text-xl font-bold"},ue={class:"text-sm text-muted-foreground dark:text-muted-foreground mt-1"},ce={class:"space-y-4"},me={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"},pe={class:"text-sm font-medium mb-1 capitalize"},fe={class:"text-lg font-semibold"},ge={class:"text-xs text-muted-foreground dark:text-muted-foreground mt-1"},_e={key:0,class:"text-xs text-muted-foreground dark:text-muted-foreground mt-2 italic"},be={class:"pt-3 border-t border-sidebar-border/40"},he={key:2,class:"text-center py-12 rounded-lg border border-dashed border-sidebar-border/70 dark:border-sidebar-border/70 bg-muted/20 dark:bg-muted/20"},Te=V({__name:"Index",props:{productions:{},machineGroups:{},selectedProductionId:{},selectedDate:{}},setup(m){const T=[{title:"Data Management",href:"/data-management/production"},{title:"Targets",href:"/data-management/targets"}],f=m,u=g(f.selectedProductionId),_=g(null),C=g(0),b=()=>{C.value=_.value?_.value.offsetWidth:0};I(()=>{L(b),window.addEventListener("resize",b)}),M(()=>{window.removeEventListener("resize",b)});const p=g(f.selectedDate),h=g(null),z=()=>{h.value?.focus(),h.value?.click()},N=S(()=>{if(!u.value)return"Choose Production";const a=f.productions.find(t=>t.production_id===u.value);return a?a.production_name:"Choose Production"}),$=a=>{u.value=a};j([u,p],([a,t])=>{a&&P.get("/data-management/targets",{production_id:a,date:t},{preserveState:!0,replace:!0})},{immediate:!1});const k=(a,t,r)=>{const s=f.machineGroups?.find(v=>v.production_machine_group_id===a);if(!s)return null;const x=s.daily_values.find(v=>v.field_name===t);return x?r==="target"?x.target_value:x.keterangan:r==="target"?s.default_targets[t]??null:null},R=(a,t)=>f.machineGroups?.find(s=>s.production_machine_group_id===a)?.default_targets[t]??null;return(a,t)=>(n(),D(Q,{breadcrumbs:T},{default:c(()=>[d(o(E),{title:"Targets Management"}),e("div",te,[e("div",re,[e("div",null,[t[2]||(t[2]=e("label",{class:"block text-sm font-medium mb-2"},"Select Production",-1)),d(o(X),{class:"relative w-full"},{default:c(()=>[d(o(A),{"as-child":!0,style:F({"--reka-dropdown-menu-trigger-width":o(C)+"px"})},{default:c(()=>[e("button",{ref_key:"triggerRef",ref:_,type:"button",class:"input w-full flex items-center justify-between"},[e("span",oe,l(N.value),1),d(o(ee),{class:"ml-2 size-4"})],512)]),_:1},8,["style"]),d(o(J),{align:"start",sideOffset:4,class:"w-(--reka-dropdown-menu-trigger-width) min-w-[12rem]"},{default:c(()=>[d(o(G),{"as-child":!0},{default:c(()=>[e("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:t[0]||(t[0]=r=>$(null))},"Choose Production")]),_:1}),(n(!0),i(w,null,y(m.productions,r=>(n(),D(o(G),{key:r.production_id,"as-child":!0},{default:c(()=>[e("button",{class:"block w-full text-left px-3 py-2 text-sm",onClick:s=>$(r.production_id)},l(r.production_name),9,se)]),_:2},1024))),128))]),_:1})]),_:1})]),e("div",null,[t[3]||(t[3]=e("label",{class:"block text-sm font-medium mb-2"},"Select Date",-1)),e("div",ae,[O(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>W(p)?p.value=r:null),type:"date",class:"input w-full pr-10",ref_key:"dateInputRef",ref:h},null,512),[[q,o(p)]]),e("button",{type:"button",class:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",onClick:z,"aria-label":"Open calendar"},[d(o(K),{class:"h-4 w-4"})])])])]),o(u)?m.machineGroups&&m.machineGroups.length>0?(n(),i("div",de,[(n(!0),i(w,null,y(m.machineGroups,r=>(n(),i("div",{key:r.production_machine_group_id,class:"rounded-lg border border-sidebar-border/70 dark:border-sidebar-border/70 bg-card dark:bg-card p-6"},[e("div",ie,[e("div",null,[e("h2",le,l(r.name),1),e("p",ue,l(r.machine_count)+" machines ",1)]),d(Y,{icon:o(Z),label:"Edit",color:"amber",onClick:()=>o(P).get(`/data-management/targets/${r.production_machine_group_id}/edit`,{date:o(p)})},null,8,["icon","onClick"])]),e("div",ce,[e("div",me,[(n(!0),i(w,null,y(r.fields.filter(s=>s!=="qty"),s=>(n(),i("div",{key:`${r.production_machine_group_id}-target-${s}`,class:"rounded-lg bg-muted/40 dark:bg-muted/40 p-3"},[e("p",pe,l(s.replace(/_/g," ")),1),e("p",fe,l(k(r.production_machine_group_id,s,"target")??"Not set"),1),e("p",ge," Default: "+l(R(r.production_machine_group_id,s)??"No default"),1),k(r.production_machine_group_id,s,"keterangan")?(n(),i("p",_e,l(k(r.production_machine_group_id,s,"keterangan")),1)):B("",!0)]))),128))]),e("div",be,[d(o(U),{href:`/input/create?date=${o(p)}&production_id=${o(u)}`,class:"text-sm text-primary hover:underline inline-flex items-center gap-1"},{default:c(()=>[...t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),H(" Record hourly output ",-1)])]),_:1},8,["href"])])])]))),128))])):o(u)&&m.machineGroups?(n(),i("div",he,[...t[6]||(t[6]=[e("p",{class:"text-muted-foreground dark:text-muted-foreground"},"No machine groups found for this production",-1)])])):B("",!0):(n(),i("div",ne,[...t[4]||(t[4]=[e("p",{class:"text-muted-foreground dark:text-muted-foreground"},"Please select a production to view machine groups",-1)])]))])]),_:1}))}});export{Te as default};
